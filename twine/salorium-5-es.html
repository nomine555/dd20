<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>dd20-5-es</title>
<style title="Twine CSS">@-webkit-keyframes appear{0%{opacity:0}to{opacity:1}}@keyframes appear{0%{opacity:0}to{opacity:1}}@-webkit-keyframes fade-in-out{0%,to{opacity:0}50%{opacity:1}}@keyframes fade-in-out{0%,to{opacity:0}50%{opacity:1}}@-webkit-keyframes rumble{50%{-webkit-transform:translateY(-0.2em);transform:translateY(-0.2em)}}@keyframes rumble{50%{-webkit-transform:translateY(-0.2em);transform:translateY(-0.2em)}}@-webkit-keyframes shudder{50%{-webkit-transform:translateX(0.2em);transform:translateX(0.2em)}}@keyframes shudder{50%{-webkit-transform:translateX(0.2em);transform:translateX(0.2em)}}@-webkit-keyframes box-flash{0%{background-color:white;color:white}}@keyframes box-flash{0%{background-color:white;color:white}}@-webkit-keyframes pulse{0%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}20%{-webkit-transform:scale(1.2, 1.2);transform:scale(1.2, 1.2)}40%{-webkit-transform:scale(0.9, 0.9);transform:scale(0.9, 0.9)}60%{-webkit-transform:scale(1.05, 1.05);transform:scale(1.05, 1.05)}80%{-webkit-transform:scale(0.925, 0.925);transform:scale(0.925, 0.925)}to{-webkit-transform:scale(1, 1);transform:scale(1, 1)}}@keyframes pulse{0%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}20%{-webkit-transform:scale(1.2, 1.2);transform:scale(1.2, 1.2)}40%{-webkit-transform:scale(0.9, 0.9);transform:scale(0.9, 0.9)}60%{-webkit-transform:scale(1.05, 1.05);transform:scale(1.05, 1.05)}80%{-webkit-transform:scale(0.925, 0.925);transform:scale(0.925, 0.925)}to{-webkit-transform:scale(1, 1);transform:scale(1, 1)}}@-webkit-keyframes shudder-in{0%, to{-webkit-transform:translateX(0em);transform:translateX(0em)}5%, 25%, 45%{-webkit-transform:translateX(-1em);transform:translateX(-1em)}15%, 35%, 55%{-webkit-transform:translateX(1em);transform:translateX(1em)}65%{-webkit-transform:translateX(-0.6em);transform:translateX(-0.6em)}75%{-webkit-transform:translateX(0.6em);transform:translateX(0.6em)}85%{-webkit-transform:translateX(-0.2em);transform:translateX(-0.2em)}95%{-webkit-transform:translateX(0.2em);transform:translateX(0.2em)}}@keyframes shudder-in{0%, to{-webkit-transform:translateX(0em);transform:translateX(0em)}5%, 25%, 45%{-webkit-transform:translateX(-1em);transform:translateX(-1em)}15%, 35%, 55%{-webkit-transform:translateX(1em);transform:translateX(1em)}65%{-webkit-transform:translateX(-0.6em);transform:translateX(-0.6em)}75%{-webkit-transform:translateX(0.6em);transform:translateX(0.6em)}85%{-webkit-transform:translateX(-0.2em);transform:translateX(-0.2em)}95%{-webkit-transform:translateX(0.2em);transform:translateX(0.2em)}}.debug-mode tw-expression[type=hookref]{background-color:rgba(115,123,140,0.15)}.debug-mode tw-expression[type=hookref]::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"?" attr(name)}.debug-mode tw-expression[type=variable]{background-color:rgba(140,128,115,0.15)}.debug-mode tw-expression[type=variable]::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"$" attr(name)}.debug-mode tw-expression[type=macro]:nth-of-type(4n+0){background-color:rgba(136,153,102,0.15)}.debug-mode tw-expression[type=macro]:nth-of-type(2n+1){background-color:rgba(102,153,102,0.15)}.debug-mode tw-expression[type=macro]:nth-of-type(4n+2){background-color:rgba(102,153,136,0.15)}.debug-mode tw-expression[type=macro][name="display"]{background-color:rgba(0,170,255,0.1) !important}.debug-mode tw-expression[type=macro][name="if"],.debug-mode tw-expression[type=macro][name="if"]+tw-hook:not([name]),.debug-mode tw-expression[type=macro][name="unless"],.debug-mode tw-expression[type=macro][name="unless"]+tw-hook:not([name]),.debug-mode tw-expression[type=macro][name="elseif"],.debug-mode tw-expression[type=macro][name="elseif"]+tw-hook:not([name]),.debug-mode tw-expression[type=macro][name="else"],.debug-mode tw-expression[type=macro][name="else"]+tw-hook:not([name]){background-color:rgba(0,255,0,0.1) !important}.debug-mode tw-expression[type=macro].false{background-color:rgba(255,0,0,0.2) !important}.debug-mode tw-expression[type=macro].false+tw-hook:not([name]){display:none}.debug-mode tw-expression[type=macro][name="a"],.debug-mode tw-expression[type=macro][name="array"],.debug-mode tw-expression[type=macro][name="datamap"],.debug-mode tw-expression[type=macro][name="dataset"],.debug-mode tw-expression[type=macro][name="colour"],.debug-mode tw-expression[type=macro][name="color"],.debug-mode tw-expression[type=macro][name="num"],.debug-mode tw-expression[type=macro][name="number"],.debug-mode tw-expression[type=macro][name="text"],.debug-mode tw-expression[type=macro][name="print"]{background-color:rgba(255,255,0,0.2) !important}.debug-mode tw-expression[type=macro][name="put"],.debug-mode tw-expression[type=macro][name="set"]{background-color:rgba(255,128,0,0.2) !important}.debug-mode tw-expression[type=macro][name="script"]{background-color:rgba(255,191,0,0.2) !important}.debug-mode tw-expression[type=macro][name="style"]{background-color:rgba(185,198,198,0.2) !important}.debug-mode tw-expression[type=macro][name^="link"],.debug-mode tw-expression[type=macro][name^="click"],.debug-mode tw-expression[type=macro][name^="mouseover"],.debug-mode tw-expression[type=macro][name^="mouseout"]{background-color:rgba(128,223,32,0.2) !important}.debug-mode tw-expression[type=macro][name^="replace"],.debug-mode tw-expression[type=macro][name^="prepend"],.debug-mode tw-expression[type=macro][name^="append"],.debug-mode tw-expression[type=macro][name^="remove"]{background-color:rgba(223,96,32,0.2) !important}.debug-mode tw-expression[type=macro][name="live"]{background-color:rgba(32,96,223,0.2) !important}.debug-mode tw-expression[type=macro]::before{content:"(" attr(name) ":)";padding:0 0.5rem;font-size:1rem;vertical-align:middle;line-height:normal;background-color:inherit;border:1px solid rgba(255,255,255,0.5)}.debug-mode tw-hook{background-color:rgba(0,85,255,0.1) !important}.debug-mode tw-hook::before{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"["}.debug-mode tw-hook::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"]"}.debug-mode tw-hook[name]::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"]<" attr(name) "|"}.debug-mode tw-pseudo-hook{background-color:rgba(255,170,0,0.1) !important}.debug-mode tw-collapsed::before{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"{"}.debug-mode tw-collapsed::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"}"}.debug-mode tw-verbatim::before,.debug-mode tw-verbatim::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"`"}.debug-mode tw-align[style*="text-align: center"]{background:linear-gradient(to right, rgba(255,204,189,0) 0%, rgba(255,204,189,0.25) 50%, rgba(255,204,189,0) 100%)}.debug-mode tw-align[style*="text-align: left"]{background:linear-gradient(to right, rgba(255,204,189,0.25) 0%, rgba(255,204,189,0) 100%)}.debug-mode tw-align[style*="text-align: right"]{background:linear-gradient(to right, rgba(255,204,189,0) 0%, rgba(255,204,189,0.25) 100%)}.debug-mode p{background-color:rgba(255,213,0,0.1)}.debug-mode tw-enchantment{animation:enchantment 0.5s infinite;-webkit-animation:enchantment 0.5s infinite;border:1px solid}.debug-mode tw-link::after,.debug-mode tw-broken-link::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:attr(passage-name)}.debug-mode tw-include{background-color:rgba(204,128,51,0.1)}.debug-mode tw-include::before{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:attr(type) ' "' attr(title) '"'}@keyframes enchantment{0%,to{border-color:#ffb366}50%{border-color:#6fc}}@-webkit-keyframes enchantment{0%,to{border-color:#ffb366}50%{border-color:#6fc}}tw-debugger{position:fixed;bottom:0;right:0;z-index:999999;min-width:10em;min-height:1em;padding:1em;font-size:1.5em;border-left:solid #000 2px;border-top:solid #000 2px;border-top-left-radius:0.5em;background:#fff;transition:opacity 0.2s;-webkit-transition:opacity 0.2s;opacity:0.8}@media screen and (max-width: 1280px){tw-debugger{font-size:1.25em}}@media screen and (max-width: 960px){tw-debugger{font-size:1em}}@media screen and (max-width: 640px){tw-debugger{font-size:0.8em}}tw-debugger:hover{opacity:1}.show-invisibles{border-radius:3px;border:solid #999 1px;background-color:#fff;font-size:inherit}.debug-mode .show-invisibles{background-color:#eee;box-shadow:inset #ddd 3px 5px 0.5em}tw-link,.link,tw-icon{cursor:pointer}tw-link,.enchantment-link{color:#4169E1;font-weight:bold;text-decoration:none;transition:color 0.2s ease-in-out}tw-link:hover,.enchantment-link:hover{color:DeepSkyBlue}tw-link:active,.enchantment-link:active{color:#DD4B39}.visited{color:#6941e1}.visited:hover{color:#E3E}tw-broken-link{color:#993333;border-bottom:2px solid #993333;cursor:not-allowed}.enchantment-mouseover{border-bottom:1px dashed #666}.enchantment-mouseout{border:rgba(64,149,191,0.25) 1px solid}.enchantment-mouseout:hover{background-color:rgba(64,149,191,0.25);border:transparent 1px solid;border-radius:0.2em}html{font:100% Georgia, serif;margin:0;background-color:transparent;color:#000;height:100%;overflow-x:hidden;box-sizing:border-box}*,:before,:after{position:relative;box-sizing:inherit}body{margin:0;background-color:transparent}tw-storydata{display:none}tw-story{display:-webkit-box;display:-webkit-flex;display:-moz-flex;display:-ms-flexbox;display:flex;-webkit-box-direction:normal;-webkit-box-orient:vertical;-webkit-flex-direction:column;-moz-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:60%;font-size:1.5em;line-height:1.5em;margin:5% auto}@media screen and (max-width: 1024px){tw-story{font-size:1.2em}}@media screen and (max-width: 896px){tw-story{font-size:1.05em}}@media screen and (max-width: 768px){tw-story{font-size:.9em}}tw-passage{display:block}tw-sidebar{left:-5em;width:3em;position:absolute;text-align:center;display:block}tw-icon{display:block;margin:0.5em 0;opacity:0.1;font-size:2.75em}tw-icon:hover{opacity:0.3}tw-error{display:inline-block;border-radius:0.2em;padding:0.2em;font-size:1rem;cursor:help}tw-error.error{background-color:rgba(223,58,190,0.4);color:black}tw-error.warning{background-color:rgba(223,140,58,0.4);color:black;display:none}.debug-mode tw-error.warning{display:inline}tw-error-explanation{display:block;font-size:0.8rem;line-height:1rem}tw-error-explanation-button{cursor:pointer;line-height:0em;border-radius:1px;border:1px solid black;font-size:0.8rem;margin:0 0.4rem;opacity:0.5}tw-error-explanation-button .folddown-arrowhead{display:inline-block}tw-notifier{border-radius:0.2em;padding:0.2em;font-size:1rem;background-color:rgba(223,182,58,0.4);display:none}.debug-mode tw-notifier{display:inline}tw-notifier::before{content:attr(message)}tw-colour{border:1px solid black;display:inline-block;width:1em;height:1em}h1{font-size:3em}h2{font-size:2.25em}h3{font-size:1.75em}h1,h2,h3,h4,h5,h6{line-height:1em;margin:0.6em 0}pre{font-size:1rem}small{font-size:70%}big{font-size:120%}mark{color:rgba(0,0,0,0.6);background-color:#ff9}ins{color:rgba(0,0,0,0.6);background-color:rgba(255,242,204,0.5);border-radius:0.5em;box-shadow:0em 0em 0.2em #ffe699;text-decoration:none}del{background-color:#000;text-decoration:none}center{text-align:center;margin:0 auto;width:60%}blink{text-decoration:none;animation:fade-in-out 1s steps(1, end) infinite alternate;-webkit-animation:fade-in-out 1s steps(1, end) infinite alternate}tw-align{display:block}tw-outline{color:white;text-shadow:-1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000}tw-shadow{text-shadow:0.08em 0.08em 0.08em #000}tw-emboss{text-shadow:0.08em 0.08em 0em #000;color:white}tw-condense{letter-spacing:-0.08em}tw-expand{letter-spacing:0.1em}tw-blur{color:transparent;text-shadow:0em 0em 0.08em #000}tw-blurrier{color:transparent;text-shadow:0em 0em 0.2em #000}tw-blurrier::selection{background-color:transparent;color:transparent}tw-blurrier::-moz-selection{background-color:transparent;color:transparent}tw-smear{color:transparent;text-shadow:0em 0em 0.02em rgba(0,0,0,0.75),-0.2em 0em 0.5em rgba(0,0,0,0.5),0.2em 0em 0.5em rgba(0,0,0,0.5)}tw-mirror{display:inline-block;transform:scaleX(-1);-webkit-transform:scaleX(-1)}tw-upside-down{display:inline-block;transform:scaleY(-1);-webkit-transform:scaleY(-1)}tw-fade-in-out{text-decoration:none;animation:fade-in-out 2s ease-in-out infinite alternate;-webkit-animation:fade-in-out 2s ease-in-out infinite alternate}tw-rumble{-webkit-animation:rumble linear 0.1s 0s infinite;animation:rumble linear 0.1s 0s infinite;display:inline-block}tw-shudder{-webkit-animation:shudder linear 0.1s 0s infinite;animation:shudder linear 0.1s 0s infinite;display:inline-block}tw-shudder-in{animation:shudder-in 1s ease-out;-webkit-animation:shudder-in 1s ease-out}.transition-in{-webkit-animation:appear 0ms step-start;animation:appear 0ms step-start}.transition-out{-webkit-animation:appear 0ms step-end;animation:appear 0ms step-end}[data-t8n^=fade-in].transition-in,.transition-in[data-t8n^=dissolve]{-webkit-animation:appear 0.8s;animation:appear 0.8s}[data-t8n^=dissolve].transition-out{-webkit-animation:appear 0.8s reverse;animation:appear 0.8s reverse}[data-t8n^=shudder-in].transition-in,.transition-in[data-t8n^=shudder]{display:inline-block;-webkit-animation:shudder-in 0.8s;animation:shudder-in 0.8s}[data-t8n^=shudder-out].transition-out,.transition-out[data-t8n^=shudder]{display:inline-block;-webkit-animation:shudder-out 0.8s;animation:shudder-out 0.8s}[data-t8n^=boxflash].transition-in{-webkit-animation:box-flash 0.8s;animation:box-flash 0.8s}[data-t8n^=pulse].transition-in{-webkit-animation:pulse 0.8s;animation:pulse 0.8s}[data-t8n^=pulse].transition-out{-webkit-animation:pulse 0.8s reverse;animation:pulse 0.8s reverse}[data-t8n$=fast]{animation-duration:0.4s;-webkit-animation-duration:0.4s}[data-t8n$=slow]{animation-duration:1.2s;-webkit-animation-duration:1.2s}
</style>
</head>

<body>

<tw-story></tw-story>

<tw-storydata name="dd20-5-es" startnode="3" creator="Twine" creator-version="2.3.1" ifid="09008868-4620-4A8A-9B91-E88928EF530B" zoom="1" format="Harlowe" format-version="1.2.4" options="" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">





















































































</style><script role="script" id="twine-user-script" type="text/twine-javascript">





















































































</script><tw-passagedata pid="1" name="Resumen" tags="encounter @resumen" position="350,77" size="100,100">

&lt;audio controls src=&quot;./audio/background-es.mp3&quot;&gt;&lt;/audio&gt;
	
&lt;br/&gt;
(Escucha este texto aquí)  

# RESUMEN

## Introducción

Un poderoso nigromante, Gramdum Elojia, ha intentado usar un artefacto para absorber la energía divina del cadáver de un antiguo dios muerto que flotaba en el Plano Astral. Durante el proceso, una enorme explosión mágica ha disgregado los restos del cadáver por el Plano Material Primario. Gramdum Elojia ha localizado algunos de estos restos y ha enviado expediciones para recuperar los despojos. La primera de estas expediciones se encuentra en Las Montañas del Invasor, trabajando sobre los restos de la cabeza del Dios muerto, Rakaj.

Debido al brutal impacto de la cabeza contra la cordillera, una espesa nube de cenizas y tierra en suspensión se ha extendido por toda la región arrasando las cosechas y matando el ganado de las granjas cercanas. Aunque la zona está poco habitada, los residentes se han visto obligados a abandonar sus hogares y refugiarse en la cercana ciudad de Sâlorium. El nigromante sabe que las autoridades de la ciudad no tardarán en enviar a alguien para que averigüe que ha sucedido, y no está dispuesto a que su secreto sea desvelado antes de tiempo. Por ello, decide lanzar un brutal ataque contra Sâlorium con el fin de mermar sus fuerzas y conseguir el tiempo suficiente para acabar su trabajo en las Montañas del Invasor. 

Para lograr su fin, Gramdum Elojia envía a Doris, un cambiaformas de su confianza para que reemplace a uno de los maestros de la Escuela de Magia, el profesor Glaucom, y abra una serie de portales por los que enviar una horda que arrase la Escuela, principal defensa de la ciudad. Los jugadores se encuentran así en medio de un rápido y fatal ataque contra la única esperanza que tienen los ciudadanos de Sâlorium de resistir los maquiavélicos planes de Gramdum Elojia.

## Trasfondo

Rakaj murió hace milenios. Durante una de las batallas que enfrentó a Dioses y Primordiales, esta vetusta deidad encontró su final y, como muchas otras en esos tiempos, acabo olvidada. Tras morir, su cuerpo acabo flotando en el éter del Plano Astral donde ha navegado a la deriva por eones. Existe la teoría de que estos titanes petrificados no están realmente muertos si no que se encuentran en un estado de semi-reposo. Son muchos los testimonios que afirman que los recuerdos de los dioses muertos se reflejan como extraños sueños en las mentes de aquellos que se atreven a caminar sobre la superficie de estos gigantes aletargados. Uno de los eruditos que sostiene esta teoría es Gramdum Elojia, un poderoso nigromante perteneciente a un pequeño culto dedicado a la Madre de los Demonios.

&gt; El nombre del culto sólo se escucha en voz baja a lo largo del Multiverso. Voces quedas, que susurran como los textos antiguos, afirman que la madre de los demonios dio a luz a los Señores que gobiernan el Abismo. Otras fuentes incluso van más allá, y se atreven a afirmar que toda la raza demoniaca desciende de ella. Pero no son más que murmullos que, oportunamente, son silenciados cuando algún descerebrado comete la insensatez de intentar aclarar el misterio que rodea a la llamada Madre de los Demonios. 

Durante siglos, Gramdum Elojia ha dedicado todo su tiempo y recursos a investigar si quedan rastros de alguna clase de poder latiendo en el interior de estos formidables despojos divinos, conocidos entre los habitantes del Plano Astral como Islas-Dios. 

&gt; Una Isla-Dios es el cadáver de una deidad petrificada, cuya superficie ha sido alterada por desagradables razas astrales que han convertido el lugar en su hogar, construyendo verdaderas ciudades flotantes.

Gramdum Elojia ha buscado incesantemente un cadáver no colonizado, y no fue hasta hace unos pocos meses que halló el inerte cuerpo de Rakaj flotando en el Mar Astral. Gracias a un artefacto, conocido como El Asimilador, logro extraer parte del poder divino que aún se alojaba en el dios muerto. Pero antes de poder absorber toda esta energía el artefacto colapso, creando un vórtice que atomizó los restos del cuerpo dispersándolos por el Plano Material Primario. Las partes de Rakaj se disgregaron en diferentes tamaños, desde pequeñas esquirlas de palpitante poder, hasta monumentales restos del tamaño de montañas. Tras sobreponerse al fracaso y lamer sus heridas, Gramdum Elojia localizó algunos de estos fragmentos y organizó una expedición para terminar el trabajo. Su primer destino, Las Montañas del Invasor, una zona poco habitada, a unos cientos de leguas de la Ciudad de Sâlorium, hogar de los Personajes Jugadores.


## Sinopsis de la Aventura

En esta aventura, los jugadores verán su hogar asaltado por las hordas de Gramdum Elojia y averiguarán los misterios que han traído a estos seres hasta las puertas de su casa.

* ACTO I - **Asalto a la Escuela de Magia**: Mientras la expedición de Gramdum Elojia trabaja en Las Montañas del Invasor sobre la cabeza del dios muerto Rakaj, el nigromante ordena un ataque contra la ciudad cercana de Sâlorium. Los jugadores se ven inmersos en una ofensiva brutal llevada a cabo por una horda demoniaca que, a través de portales, asalta la Escuela de Magia de la ciudad. Deberán proteger su vida y la de sus conciudadanos.

* ACTO II - **Buscando a los culpables**: Tras el ataque, los supervivientes se han refugiado en la cripta del Templo y temen un segundo asalto. Los jugadores deberán averiguar quién es el traidor que abrió los portales permitiendo a los demonios asolar la Escuela de Magia.

* ACTO III - **Buscando a Doris**: Los personajes salen al exterior en busca de Doris, el cambiaformas enviado por Gramdum Elojia para sustituir al Maestro Glaucom. 

* ACTO IV - **Buscando huesos**: Para poder interrogar a Doris los jugadores se ven obligados a ayudar a la señorita Bilwa que los obliga a viajar al cementerio de Sâlorium en busca de unos extraños ingredientes para crear una poción.  

* CONCLUSION - Con ayuda de una Poción de Verdad, los jugadores averiguan finalmente el origen del ataque a la Escuela. 

Los jugadores deberían, al menos, completar las siguientes siete tareas para completar la Aventura.

1. Tras investigar en el Escuela de Magia, a los jugadores les queda claro que alguien abrió los portales dentro de la Academia. Los jugadores terminan **buscando al maestro en portales, Glaucom**, para descubrir que se ha suicidado. Una investigación más detallada revela que en realidad ha sido asesinado hace días, pero hay testigos que afirman haberlo visto hace escasos minutos. Los jugadores averiguarán también que el Maestro Glaucom llevaba semanas visitando una taberna conocida como **La Ballena Blanca**

2. Los Jugadores llegan a **La Ballena Blanca** esquivando a los demonios que aún se encuentran por los callejones de la ciudad. En el establecimiento encuentran al maestro Glaucom, quien revela su verdadero aspecto: se trata de un cambiaformas llamado Doris. Se produce un combate tras el que los jugadores apresan al impostor.

3. Doris se niega a dar ningún tipo de información y la única manera es que injiera un **Elixir de Verdad**. Para ello, los jugadores deberán pedir a la señorita Bilwa que prepare la pócima.

4. Los jugadores **localizan a la señorita Bilwa destrozando el laboratorio del maestro Nizgul**. La señorita Bilwa confiesa que en realidad tiene casi 100 años, que se ha mantenido joven gracias a pócimas de vida eterna y que era el maestro Nizgul quien la facilitaba los extraños materiales necesarios para la creación de las pociones. Bilwa también confiesa que el viejo nigromante la chantajeaba a cambio de los ingredientes y que desde hace un año que no la proporciona lo necesario, por lo que los efectos mágicos de la poción se han disipado. Con la muerte de Nizgul, la señorita Bilwa no tiene mucho tiempo antes de que los efectos desaparezcan del todo y se convierta en polvo, así que necesita que los jugadores encuentren los materiales antes de que sea demasiado tarde y muera.

5. Los jugadores se trasladan **al Cementerio de la Ciudad**, donde tendrán que desenterrar un cadáver para conseguir uno de los elementos esenciales que Bilwa necesita para crear la poción de juventud que la mantenga con vida. Allí se enfrentarán al guardián de los muertos, un espíritu que vigila que los fallecidos no sean molestados.

6. Tras lograr el **ingrediente para la Poción de Juventud**, la señorita Bilwa entrega el Elixir de Verdad que suministrar a Doris. Esta revela finalmente que su amo la envió para abrir los portales y así mantener en secreto su trabajo a unas leguas de la ciudad. Doris nos sabe exactamente qué es lo que su amo está haciendo y solo puede indicar el lugar donde se encuentra.

7. Los jugadores se dirigen a **Las Montañas del Invasor**, donde hallan la cabeza del Dios Muerto, Rakaj.

Si quieres ya puedes ir a [[Comienza la Aventura]] 
</tw-passagedata><tw-passagedata pid="2" name="Comienza la Aventura" tags="encounter @comienza-aventura" position="272,344" size="100,100">
# SITUACIÓN

La aventura se desarrolla en Sâlorium, la principal ciudad en esta parte del continente. Su privilegiada bahía y su ubicación como última frontera de la civilización frente al salvaje norte la convierte en el epicentro financiero y político de la región. 

Durante la última semana, la ciudad se ha visto conmocionada por la llegada de cientos de refugiados de las comarcas más cercanas. Abandonaron sus hogares ante la llegada de una gigantesca nube de ceniza y tierra en suspensión que ha acabado con sus cosechas y su ganado. Las autoridades de la ciudad han ubicado a los refugiados en un campamento provisional en los terrenos de la Escuela de Magia mientras determinan como afrontar la situación. La realidad es que nadie en la ciudad sabe porque se ha formado la nube y la paranoia entre los habitantes comienza a crecer con el paso de los días.

Lee lo siguiente a los jugadores para que se sitúen en el momento actual que atraviesa Sâlorium:

&gt; La placida vida en Sâlorium se ha visto alterada en los últimos días cuando cientos de refugiados han buscado la seguridad de sus muros y la protección de los afamados y poderosos residentes de su Escuela de Magia. Los recién llegados son granjeros de las comarcas cercanas que vienen huyendo de una gigantesca nube de cenizas y polvo en suspensión que ha arruinado las cosechas y matado al ganado. Las autoridades han ubicado a los refugiados en los terrenos de la Escuela de Magia mientras determinan como afrontar la situación. 
El nerviosismo y el miedo recorren de la mano las calles de una ciudad que no entiende lo que está pasando. Los rumores se agolpan en las tabernas y los mercados. Allí, unos hablan de un enorme dragón que no tardará en llegar a Sâlorium y dar buena cuenta de ella y de sus habitantes. Otros afirman que, sin duda, se trata de algún tipo de encantamiento lanzado por un chamán de las tribus del norte como advertencia de una inminente invasión de los salvajes. Los hay que incluso ven en la nube una de las señales del fin del mundo y que el castigo de los dioses no se hará esperar. Así, los peores temores sobrevuelan los pensamientos de las buenas gentes de Sâlorium que ya no salen a las calles al caer la noche, se han vuelto un poco más reservados y miran al cielo esperando que en cualquier momento un terrible mal termine con sus vidas

Ahora es el momento de leer a cada jugador donde se encuentra en el momento de comenzar la aventura.

Cada uno de los personajes pre-generados de la aventura tiene un gancho personalizado que le sitúa en un momento y una situación muy concreta antes de que comienza la acción. 

Lee a cada jugador el texto de su gancho y después pasa a [[Ataque a la Escuela]], o pasa directamente si no vas a utilizar los ganchos.

# Yonse (Mago)
&gt; Eres el último alumno de la Escuela de Magia de Sâlorium en acostarse esta noche. Has pasado las últimas 12 horas revisando los viejos tomos que el maestro Roniam te recomendó y te diriges somnoliento y hambriento a tu habitación, donde calculas que aún puedas dormir un par de horas antes de que amanezca. Con un bostezo abres la puerta de tu cuarto, apagas el candil que ha iluminado tu camino desde la biblioteca y dejas caer tu cuerpo sobre el catre. No tardas en dormirte. A penas unos minutos después, un estruendo te despierta. Dirías que proviene de la biblioteca, como si varias de las enormes librerías se hubieran desplomado y hecho añicos. 

# Erundur (Sacerdote)
&gt; Ha sido un día largo pero tranquilo. Apenas has tenido que atender a ninguno de los refugiados que se cobijan en la Escuela de Magia. Tan sólo un par de torceduras de tobillo y remendar la cabeza de un halfling lastimoso que trabaja como prisionero en las labores de levantar el campamento. Tras cenar con otros de los clérigos que se han acercado a la Escuela de Magia para socorrer a los necesitados, te recuestas y sacas de tu mochila un viejo libro: &#39; Poemas del Mar de Espejo&#39;.
Tras un par de horas leyendo, todo el campamento está en silencio. De repente, un fogonazo de luz comienza a dibujar sobre el suelo un círculo de luz incandescente rodeado de símbolos arcanos. Al tiempo, un torbellino se forma sobre él. El aire comienza a girar frenéticamente arrastrando tiendas, barriles y todo tipo de herramientas que se encuentran cerca.

# Raghar
&gt; Anochece y el jefe de la Guardia, un viejo ex militar llamado Menzal, ordena a los guardias de la Escuela que aten a los prisioneros para que durmáis antes de volver al trabajo mañana por la mañana. A empellones, os sujetan al poste clavado en el patio. Después de serviros una ponzoñosa sopa, a la que se atreven a llamar comida, te recuestas en tu montón de pajas e intentas conciliar el sueño. Tras unas pocas horas de descanso, un grito te despierta. Enseguida, se le unen más alaridos y sonido de pisadas a la carrera. 

# El Señor Pirs
&gt; Tras un nuevo día triunfante en la vida del Señor Pirs, se dirige junto a sus camaradas a descansar y celebrar una buena jornada de trabajo. Bien es cierto que el Señor Pirs tuvo algunas tiranteces con el jefe de la Guardia, el sargento Menzal, cuando el señor Pirs decidió escabullirse del patio de la escuela oculto en unos toneles de pescado en salmuera. Pero la diferencia de opiniones entre los dos caballeros se resolvió de manera honorable y una brecha de tres centímetros en la cocorota del Señor Pirs que, por fortuna, un buen sacerdote elfo se apresuró a curar.
Tras degustar la frugal cena que le traen los sirvientes, el Señor Pirs se retira a su dormitorio y se tumba en el suelo duro, frío y arenoso, tal y como a él le gusta: siempre ha sostenido que no era nada bueno dormir sobre colchones o superficies cómodas y confortables, ya que atontan el cuerpo y la rápida mente con la que los dioses le han dotado. Tras unas horas de estiramientos y vueltas en el suelo tratando de encontrar una postura aceptable para descansar, el Señor Pirs escucha un grito. Parece ser que está noche también alguien necesitará de las asombrosas habilidades del Señor Pirs.

# Wilbur (Ladrón)
&gt; La noche helada te obliga a frotarte las manos para hacerlas entrar en calor a pesar de llevarlas enguantadas. El viento es aún más frío en lo alto del tejado donde te encuentras vigilando tu objetivo, en cuclillas contra una chimenea cuya sombra oculta tu presencia. Terminas de revisar tu equipo, ajustas los correajes y mides la tensión de la cuerda que has lanzado al otro lado de la calle, hasta una de las torres de la Escuela de Magia. Sientes como tu arnés se tensa y tu cuerpo bambolea cuando te descuelgas sobre el vacío. Lentamente y en silencio dejas que las poleas y la gravedad hagan su trabajo, deslizándote el trecho que separa ambos edificios.

Permite al jugador realizar algún tipo de tirada relativa a sus habilidades de clase, por ejemplo, Equilibrio o Acrobacias en el momento en el que se desliza por la cuerda y Abrir Cerraduras cuando quiera forzar la claraboya para entrar en la Escuela de Magia. También puede intentar Moverse en Silencio y/o Ocultarse en la Sombras. Ten en cuenta que estas tiradas son para que el jugador sienta que está participando en la historia, pero no deberían ser imposibles de superar ya que daría al traste con el objetivo de situarle en la siguiente escena y que conozca a algunos de sus potenciales compañeros. 

&gt; Con sigilo logras abrir la claraboya del Observatorio de la Escuela de Magia y, con la agilidad que proporcionan años de entrenamiento, desciendes al interior del edificio deslizándote por una larga cuerda. Tocas el suelo y con un grácil movimiento te ocultas tras una mesa. Todo está oscuro y tranquilo. Tal y como habías calculado, te encuentras en la Biblioteca de la Escuela. Te paras un momento a tomar resuello, mientras piensas en el botín de la cámara que pronto estará en tus manos, cuando oyes abrirse la puerta de la habitación. Al asomarte desde tu escondite ves a uno de los guardias haciendo su ronda nocturna.

# Monak (guerrero)

&gt; Agradeces que esta noche te toque hacer tu turno de guardia en el interior de la Escuela de Magia. El frío en el exterior convierte las horas de vigilia en una auténtica penitencia, y aunque recorrer de arriba abajo los oscuros pasillo del complejo no sea una labor placentera, es mucho más agradable que pasar horas en una garita de piedra temblando y rezando porque no se te congele ninguno de los dedos del píe. 
Tras cruzarte por los pasillos con el maestro Glaucom, uno de los profesores de la escuela, con desgana abres la puerta de la biblioteca para continuar con tu ronda. Entras y extiendes tu brazo sujetando un candil que a duras penas ilumina la enorme estancia. Pesadamente serpenteas entre las enormes librerías copadas de libros y pergaminos.

Tanto Monak como Wilbur se encuentran ahora en la misma sala, pregunta a ambos jugadores si hacen algo en especial. Si no es así, lee el siguiente texto para ambos:

&gt; Tras un fogonazo de luz, en el centro de la Biblioteca, comienza a dibujarse sobre el suelo un círculo de luz incandescente rodeado de símbolos arcanos y un torbellino se forma sobre él. El aire comienza a girar frenéticamente, arrastrando pergaminos, libros pequeños y el polvo acumulado en el lugar. La fuerza del viento va en aumento y tumba dos enormes librerías que, con gran estruendo, se hacen añicos al caer al suelo. 


AT A GLANCE
---
* Los jugadores que tengan al menos 1 punto en *Historia* o que vivan en la Escuela tendrán acceso a la siguiente información:
  * Nombres y atribuciones de los maestros en la Escuela. 
  * Conocen la existencia de los subterráneos. 
  * Acceso al mapa de la Escuela y de la ciudad. 
* Los jugadores que tengan al menos 1 punto en *Conocimiento Arcano* sabrán que la nube de cenizas es de origen natural, no mágico. 


* Además, ten en cuenta las [Características Generales](../lugares.html?param=@caracteristicas&amp;room=0) de la Escuela. 

CONCLUSION
---
Después de leer la introducción pasaremos a [[Ataque a la Escuela]].

images {./images/act-1/salorium.jpg, ./maps/msalorium-es.html,   ./maps/mschool-es.html }
music {just-adventuring.mp3}
</tw-passagedata><tw-passagedata pid="3" name="Índice" tags="index @bienvenido" position="91,338" size="100,100">
# Bienvenido aventurero,
tienes entre tus manos la primera Aventura de **Rol de Mesa** diseñada para ser dirigida desde una tableta.  
*El asedio de Sâlorium* es una aventura de ambientación medieval-fantástica para personajes de nivel 1, con la que arranca la primera campaña de DigitalD20. La aventura usa el sistema *D20* (compatible con *DRAGONES &amp; MAZMORRAS®* y *Pathfinder®*) y puede ambientarse en cualquier mundo de juego (*Reinos Olvidados®*, *Dragonlance®*, *Golarion*...) 

## ¿Qué es un Juego de Rol?
Los Juegos de Rol consisten en interpretar papeles, generalmente en mundos de fantasía. Se trata de imaginar cómo tu aventurero se enfrenta a los desafíos presentados por el director de juego. Se juega sentado en una mesa con tus amigos, acompañados de una buena cantidad de dados y ganas de pasarlo bien. 

## ¿Qué necesito para jugar *El asedio de Sâlorium*?
Para jugar esta aventura es necesario estar familiarizado con él sistema de juego *D20* y tener dados, lápiz y papel. **La propia aventura te proporciona las reglas necesarias para resolver cada encuentro**. También necesitarás hojas de personaje. Podéis utilizar las vuestras o descargar las hojas pre-generadas de la web www.digitald20.com. 

## Como usar esta Aventura

Para jugar *El asedio de Sâlorium* puedes utilizar los [personajes pregenerados](./index.html?param=@personajes) o  puedes crear tus propios personajes.
La historia funciona mejor utilizando los ganchos de los personajes pre-generados que son fácilmente adaptables si decides usar tus propios personajes.

Ten en cuenta que los ganchos que se ofrecen sitúan a cada Personaje en una situación diferente antes del comienzo de la Aventura y empujan a los jugadores a trabajar juntos para enfrentarse a los desafíos que se les plantean. 

Puedes leer una [sinopsis de la aventura](./index.html?param=@resumen) o directamente [[Comienza la Aventura]].

## ¿Cómo funciona GameThrough?
*GameThrough* divide el contenido de la aventura en encuentros y escenas. La diferencia entre encuentros y escenas es exclusivamente desde el punto de vista de la historia. En los encuentros se resuelve una situación concreta, por ejemplo, un combate o una investigación, las escenas, describen situaciones más abiertas como por ejemplo la exploración de una ciudad.  Los encuentros y las escenas se enlazan dependiendo de las decisiones de los jugadores. En la parte baja de la izquierda se mantendrá siempre el menú de *gamethrough*. &lt;br&gt;
&lt;img src=&quot;../core/images/summary/gamethrough.jpg&quot; class=&quot;icons-center&quot;&gt;

### Encuentros y Escenas
A la izquierda tendrás tres pestañas (A la vista, Cuerpo, Conclusión) y los iconos con las ilustraciones, los mapas, los enemigos y la música. 
&lt;br&gt;
&lt;img src=&quot;../core/images/summary/gamethrough-2.jpg&quot; class=&quot;icons-center&quot;&gt;&lt;br&gt;
* **A la vista**, describe lo que los personajes pueden percibir en el encuentro utilizando sus habilidades. 

* **Cuerpo**, es la pestaña por defecto con los enlaces a las ilustraciones, enemigos, mapas y música. 

* **Conclusión**, describe las consecuencias de las acciones de los personajes.

* A la derecha tendrás el texto del encuentro o escena. 

### Barra GameThrough
La barra de *GameThrough* proporciona cuatro índices para que puedas moverte a través de la aventura. Cada índice se corresponde uno a los siguientes iconos: 
&lt;div style=&quot;overflow:hidden&quot;&gt;&lt;img src=&quot;../core/images/icons/icon-index-1.png&quot; class=&quot;icons-left-small&quot;&gt; Este icono te llevará al índice clásico de la aventura.&lt;/div&gt;

&lt;div style=&quot;overflow:hidden&quot;&gt;&lt;img src=&quot;../core/images/icons/icon-index-2.png&quot; class=&quot;icons-left-small&quot;&gt; Este icono te llevará a un mapa con todas las localizaciones de la aventura.&lt;/div&gt;

&lt;div style=&quot;overflow:hidden&quot;&gt;&lt;img src=&quot;../core/images/icons/icon-index-3.png&quot; class=&quot;icons-left-small&quot;&gt; Este icono te llevará a un listado de todos los personajes no jugadores relevantes de la aventura. &lt;/div&gt;

&lt;div style=&quot;overflow:hidden&quot;&gt;&lt;img src=&quot;../core/images/icons/icon-index-4.png&quot; class=&quot;icons-left-small&quot;&gt; Este icono te llevará al diagrama temporal de la aventura. &lt;/div&gt;

&lt;div style=&quot;overflow:hidden&quot;&gt;&lt;img src=&quot;../core/images/icons/icon-index-izquierda.png&quot; class=&quot;icons-left-small&quot;&gt; &lt;img src=&quot;../core/images/icons/icon-index-derecha.png&quot; class=&quot;icons-left-small&quot;&gt; Con estos iconos podrás navegar por los encuentros que ya hayas visitado. &lt;/div&gt;


### Reglas indexadas
Todas las reglas que necesitas para resolver las situaciones de la aventura te aparecerán en la parte izquierda de la pantalla cuando hagas clic sobre uno de los [enlaces rojos](#) o en *cursiva*. 

## SOBRE NOSOTROS

DigitalD20 es una App que surge de la idea de un grupo de jugadores de rol. Utilizábamos tabletas durante las partidas nos preguntamos si no podíamos sacarle más partido al hecho de tener los libros en formato digital. Nos ha llevado más de dos años, pero al fin este es el resultado. 

## Créditos
&lt;br&gt;
&lt;center&gt;
**DESARROLLO TÉCNICO y DISEÑO**  
Fernando Setién Dodero  
&lt;br&gt;
**GUIÓN y DISEÑO**  
Fernando García Piqueres  
&lt;/center&gt;
&lt;br&gt;
* Revisión *David Monedero*
* Personajes pregenerados *Francisco de Borja Pérez de Miguel*

## Playtesters

* Miriam Pérez (Mimi Sweetpaws)
* Haydee Mariñoso (MongolCat)
* José Manuel Alonso (Un chico muy majo)
* Luis Cantero (El Cantero)
* Álvaro Zalduondo (Ki el Mago de Fuego)
* Borja Pérez (Eldrid)
* Eduardo Marcos (Almanzor)
* Ignacio Pulgar (Black Skull)
* Javier Gutiérrez (Gallusman el Psicópata)
* Juan Jordá (Thunder el Alto)
* Pablo Castro (POTUS)

## Artistas gráficos

* **Fantasy scene knight fighting dragon**
 * *Fotokostic (Dusan Kostic)*

* **The fabulous town**
 * *Firstear*

* **Armoured knight keeping watch (...)**
* **Illustration fo an Alchemist&#39;s study (...)**
  * *Algol*

* **Village Castle In Medieval Times**
 * *Larry Jacobsen*

* **(...) Passage with torches and clock on the wall**
 * *Atelier Sommerland*

* **Dark cellar in a medieval castle**
* **Medieval street in an old town**
* **Foggy street with medieval buildings in the mountains**
* **Dark medieval corridor with columns and torches**
* **Spooky cave entrance in the shape of a skull**
 * *Unholy Vault Designs*

* **Fantasy Landscape**
 * *James Cohen*

* **Halloween design background with spooky graveyard, naked tree and graves**
 * *demythja*

## Cartógrafos
* **City Blocks**
* **Town Inn**
 * *Gabriel Pickard*

* **Resto de Mapas**
 * *Fernando &amp; Fernando*

## Musica y efectos sonoros

* **Epic Pirates Story**
* **Spirit Of Victory**
 * *HyenaJohn*

* **Powerful Gothic Choir**
 * *StephanLindsjo*

* **Battle Scene**
  * *Driving*

* **Epic Seven**
 * *mr_B_Music_Studio*

* **Lord of Storm and War**
 * *binti*

* **Medieval Battle Theme 02**
 * *matt_film_composer*


## OPEN GAMING LICENSE
This material is written under the [Open Game License](./index.html?param=@open-game-license).

</tw-passagedata><tw-passagedata pid="4" name="Buscando culpables" tags="encounter @buscando-culpables" position="602,94" size="100,100">
# SITUACIÓN

Para cuando las cosas se han calmado tras el primer ataque a a Escuela, si los jugadores están refugiados en el Templo (2), lee lo siguiente:

&gt; Escucháis el último embate contra las barricadas colocadas en la puerta del Templo y un silencio plomizo, sólo roto por el quejido de algún herido y el llanto de un bebé, inunda la estancia. Parece que los demonios se han retirado. Rápidamente, el Maestro Lormam comienza a dar órdenes señalando con su enorme bastón donde y como quiere las cosas

Las Bestias Fundidoras, ante la imposibilidad de entrar en el Templo debido a los conjuros de protección lanzados por el Director de la Escuela, cejarán en su empeño de derribar las puertas. Entonces, los jugadores serán libres de caminar por la Escuela (utiliza el mapa para ver las descripciones de las habitaciones). La frecuencia de encuentros con Bestias Fundidoras merodeando irá disminuyendo de probabilidad a medida que pase el tiempo, excepto en los encuentros específicos descritos en cada habitación. Si los jugadores no están en el Templo, utiliza también está tabla si quieren desplazarse por el interior de la Academia:

 nºturnos | % Encuentro
 ---      | ---
 1-3      | 90% por habitación, 1d3 bestias fundidoras
 4-10     | 50% por habitación, 1d2 bestias fundidoras
 11-15    | 25% por habitación, 1d2 bestias fundidoras
 16+      | 5% por habitación, 1 bestia fundidora

El director de la Escuela, el Maestro Lormam, ha lanzado un conjuro de protección en todo el Templo y la Cripta, previniendo de tele-portaciones, apertura de portales, paso en muro, puerta dimensional y todo tipo de transporte al interior del área protegida. Además, propone crear turnos para vigilar las barricadas en las puertas del Templo en grupos de tres hombres cada cuatro horas. Por último, ordena situar a los heridos en la Cripta.  

Tanto los sacerdotes mediante conjuros o la señorita Bilwa con su arsenal de pociones pueden curar a los jugadores si lo necesitan. Si los personajes lo piden, la señorita Bilwa puede proporcionarles dos pociones de curar heridas medias a cada personaje si estos abandonan el Templo o la Escuela en alguna misión.

Muestra a los jugadores el mapa de la Escuela con la situación actual. Ahora, son libres de interactuar con los supervivientes y los maestros para recabar la siguiente información:

* Hay aprendices [encerrados](#encerrados) en la habitación del Sargento Menzal (32).
* Hay un traidor en la escuela que ha abierto los portales. Esto debe llevarles a registrar los [[Aposentos de Glaucom]] (10).
* En [[La Biblioteca]] (4) hay un tomo que puede tener información sobre qué clase de monstruos ha atacado la Escuela. 
* Los jugadores también podrían enterarse de los problemas de la Señorita Bilwa con su acelerado envejecimiento. Si por alguna razón los jugadores se dedican a espiarla, al cabo de un tiempo la Señorita Bilwa utilizará la puerta secreta de la Cripta del Templo para dirigirse a la habitación del Maestro Nizgul a través de los [[Subterráneos]].
* Los jugadores podrían intentar robar las riquezas de la Escuela dirigiéndose a la [Cámara del Tesoro](#c-mara-del-tesoro)&lt;/a&gt;
* Si los personajes quieren abandonar el recinto, ve a [[Buscando a Doris]]
* Pueden encontrar por sus propios medios la puerta secreta que utiliza la señorita Bilwa que lleva a los [[Subterráneos]]. Está muy bien escondida y requiere una tirada de *Percepción* (DC 25) o *Investigación* (DC 15). 

## HABLANDO CON LOS MAESTROS
Si los jugadores hablan con los maestros de la Escuela recibirán la siguiente información. En caso de que se encuentren perdidos proporcionales las piezas de información de la señorita Bilwa y el maestro Roniam. Ni el Maestro Glaucom ni el Maestro Nizgul se encuentran en la cripta.

* **Maestro Lormam**: El director de la Escuela no acierta a adivinar el motivo del ataque ni la naturaleza de los monstruos implicados. Si es consciente, sin embargo, de que el asalto ha venido precedido de un poderoso conjuro de Disipar Magia que ha arrasado las defensas arcanas de la Academia. Su posición es la de esperar la ayuda del exterior e intentar resistir en la cripta. Ha enviado un mensaje mágico a las autoridades de la ciudad para alertarles del peligro.

* **Sargento Menzal**: Como buen hombre de acción, al sargento no le importan ni qué clase de monstruos ha atacado la Escuela ni sus motivaciones, y es partidario de formar un grupo de hombres con agallas e ir a por las bestias fundidoras limpiando habitación por habitación. Cree que ya habrá tiempo más adelante para investigar.
Si es interrogado por los títulos de propiedad y el dinero escondidos en su habitación, el sargento se mostrará muy enfadado por haber violado su intimidad y explicará que con los ahorros de su vida ha adquirido recientemente una granja donde retirarse. Si es preguntado por la llave maestra que también oculta en su cuarto terminará confesado que ha estado robando dinero de la Cámara del Tesoro para asegurarse una buena jubilación. Si esta información es revelada, el Maestro Lormam recrimina sus actos a Menzal y le informa de que cuando el asedio a la Escuela finalice le llevará ante la justicia.

* **La Señorita Bilwa**:  Ha recibido un mensaje telepático de uno de los alumnos que se encuentran refugiados en la Habitación del sargento Menzal y advierte de que no podrán resistir mucho más el ataque de los demonios. Alguno de los aprendices está gravemente herido. 
Por otra parte, los jugadores también podrían enterarse de los problemas de la Señorita Bilwa con su acelerado envejecimiento. Una tirada de *Intuición* (DC 14) indicará que la Señorita Bilwa está especialmente nerviosa, y no necesariamente por el ataque a la Escuela. Si los jugadores se dedican a espiarla, al cabo de un tiempo, la Señorita Bilwa saldrá a hurtadillas de la Cripta a través de la puerta secreta en dirección al laboratorio del [[Maestro Nizgul]].

* **El maestro Roniam**: El bibliotecario permanece callado hasta que, si alguien no lo dice antes, alerta sobre la naturaleza del ataque. Para él, está claro que hay un traidor en la Escuela ya que alguien tuvo que abrir los portales por los que entraron las Bestias Fundidoras. También, puede recomendar que se busque un tomo llamado ‘Criaturas innombrables de los Abismo del Multiverso’ que puede arrojar alguna luz sobre la naturaleza de los asaltantes.

* **El maestro Glaucom**: El experto en portales es el sospechoso más obvio. Cuando los personajes se decidan a interrogar a Glaucom se darán cuenta de que no se encuentra ni en el Templo ni la Cripta, aunque mucha gente afirma haberlo visto vivo tras el ataque por los pasillos de la Escuela.

* **El maestro Nizgul**: El nigromante fue visto por última vez enfrentándose a las Bestias Fundidoras en la Biblioteca durante el ataque. Si los jugadores van allí, en esta sala pueden encontrar el cadáver del maestro. 

## HABLANDO CON LOS SUPERVIVIENTES
Los supervivientes especulan toda clase de teorías sobre el origen del ataque, pero poseen muy poca información relevante. Pueden obtener las siguientes pistas de los alumnos y los guardias.
 
* Escuchan a uno de los alumnos proponer a otro	estudiante escapar de la Escuela subiendo al tejado por una	de las chimeneas del comedor o la claraboya del Observatorio.
* Un guardia comenta que el asalto seguramente se ha debido al enorme tesoro que guarda la Escuela en una cámara subterránea.

## RECUENTO DE BAJAS
Por si los jugadores se interesan, han muerto o desaparecido:
* El Maestro Nizgul y el Maestro Glaucom: Desaparecidos 
* Aprendices de primer curso: Han desaparecido 4 de 6 
* Aprendices de curso intermedio: Han desaparecido 8 de 14
* Aprendices de último curso: Han desaparecido 4 de 10
* Guardias de la Escuela: Han desaparecido 11 de 19 
* Matrimonio de cocineros: Desaparecidos
* Refugiados: Han desaparecido 300 de 400 
* Sacerdotes: Han desaparecido 3 de 7 
* Prisioneros: Han desaparecido 4 de 8 

## ENCERRADOS
Algunos de los aprendices de la Escuela han quedado atrapados en la habitación del Sargento Menzal. Un grupo de Bestias Fundidoras custodia la puerta del cuarto impidiendo que lo abandonen. Si los jugadores quieren salvarlos deberán llegar al lugar y después trasladarlos a un lugar seguro. Los jugadores pueden elegir cualquier ruta que les parezca más rápida y segura para realizar la misión. Tanto el Maestro Lormam como el Sargento Menzal estarán de acuerdo en que los personajes intenten el rescate. Los personajes que fueran residentes de la Escuela conocen las rutas posibles para llegar a la Habitación del Maestro Menzal. 

Si deciden ir por el Interior de la Escuela, se enfrentarán a un grupo de demonios que asedia la puerta en el encuentro [[Encerrados]].

Si deciden atravesar el [[Patio de Armas]], encontrarán otro grupo de demonios. Si los jugadores eligen esta ruta podrían pedir al Maestro Lormam ayuda mágica para atravesar el muro que separa el Patio de la habitación de Menzal y así evitar a las Bestias Fundidoras que custodian la puerta en el pasillo. Este hará llamar a un aprendiz, llamado [Natso](./lugares.html?param=@npcs&amp;room=4), que tiene memorizado un conjuro de *Desintegrar* con el que podría abrir un boquete en el muro para que los aprendices encerrados puedan salir al Patio.  
 
## CÁMARA DEL TESORO
Alguno de los personajes jugadores puede saber la localización de la [[Cámara del Tesoro]]. Si has utilizado los ganchos pre-generados, Wilbur conoce la entrada desde el Despacho del director que le llevará al subterráneo de la Escuela.  

AT A GLANCE
---
* *Detectar magia*: solo detectan los objetos mágicos de los maestros y las protecciones que ha lanzado el director de la Escuela.

* *Detectar mal/caos*: La mayoría de las personas son buenas, aunque hay alguna excepción entre los refugiados.

* *Percepción*: Una tirada (DC 8) advertirá de la ausencia de los maestros Glaucom y Nizgul. Esta tirada sólo podrán realizarla personajes que residan en la Escuela y conozcan a los dos hechiceros de antemano. 

* *Investigación*: Los jugadores pueden realizar tiradas (DC 7) por cada pieza de información que pueden facilitar los maestros y los supervivientes. 

* Además, ten en cuenta las [características generales](../lugares.html?param=@caracteristicas&amp;room=0) de la Escuela.   

CONCLUSION
---
Desde aquí, los jugadores pueden partir a otros encuentros relevantes

* [[Aposentos de Glaucom]]
* [[La Biblioteca]] 
* [[Maestro Nizgul]]
* [[Cámara del Tesoro]]
* [[Buscando a Doris]]


images {./images/act-2/magisters.jpg,./maps/mschool-es.html,./images/act-2/crypt.jpg}
music {just-adventuring-2.mp3}


</tw-passagedata><tw-passagedata pid="5" name="La Biblioteca" tags="encounter @biblioteca" position="1066,651" size="100,100">
# ([100 XP](SRD_XP-5.html)) DESPLIEGUE

* 4 *Bestias Fundidoras*

Cuatro de los invasores de la Escuela deambulan por la Biblioteca (4) tras el primer asalto. Permanecen agazapados bajo las pilas de madera que antes fueron librerías esperando a sus víctimas. 
Lee esto a los jugadores cuando entren: 
&gt; Un silencio sepulcral y la más negra de las oscuridades reinan en la gran biblioteca de la Escuela

Si los jugadores usan alguna fuente de luz: 
&gt; Los demonios que por aquí han pasado han arrasado el lugar a su paso destrozando la mayor parte de las librerías y mesas hasta hacerlas añicos en montones de madera y papel. El portal que se abrió aquí, y por el que llegaron los invasores, ha desaparecido. En su lugar un enorme cráter ha sido escavado en el suelo.

Permite a los jugadores tiradas de *Percepción* para percatarse de que los monstruos se ocultan bajo los montones de madera. 
También pueden tirar *Inteligencia* para percatarse de que los montones de madera han sido convenientemente apilados.

Buscar el tomo que les pidió el Bibliotecario advertirá a las Bestias de la presencia de los jugadores. Debido a las condiciones de iluminación y el estado de la librería donde se encontraba el libro, los jugadores deberán superar una tirada de *Investigación* (DC 12).

Si los jugadores investigan el cráter, verán que las Bestias Fundidoras han escavado la tierra y creado un túnel que va hacia la ciudad. Si descienden y continúan andando por el túnel verán como este se bifurca rápidamente y así sucesivamente, creando un verdadero laberinto subterráneo. Si los jugadores persisten en investigar bajo tierra deberán enfrentarse a continuas oleadas de Bestias Fundidoras. Cada 20 metros, aproximadamente, hay una salida al exterior que ha sido usada por las bestias para sorprender a los habitantes de la ciudad. La salida puede encontrarse en una calle o dentro de un edificio, aleatoriamente.

# TACTICAS

Las Bestias Fundidoras se encuentran ocultas bajo los montones de madera y saltarán sobre cualquiera que pase cerca de ellos. Tienen una tirada de *Sigilo* +1 e intentarán *sorprender* a los jugadores.
En caso de que los personajes intenten pasar sin ser advertidos las Bestias harán tiradas de *Percepción* (+1).

# TERRENO

Se considera que la Biblioteca está en *oscuridad total* y todos los personajes, incluidas las Bestias Fundidoras, no ven nada. Los monstruos se guiarán por su sentido de percibir las vibraciones.
Las casillas con escombros de las librerías se consideran como *escombros menores*.


## LIBROS DE INTERES
Buscar sin un índice es complicado pero los jugadores pueden localizar cualquier libro que les pueda interesar superando una tirada de *Investigación* (DC 12). Si van a la habitación del Archivo la tirada será mucho más fácil (DC 6). Además, estas referencias proporcionan un bono de +6 a cualquier tirada de Inteligencia o Sabiduría en busca de conocimiento que pueda estar escrito.

También, pueden encontrar *libros de conjuros*, con los hechizos más comunes de nivel 1 a 3. 


AT A GLANCE
---
* *Detectar el bien y el mal*
 * Percibes un brillo entre los huecos de los escombros. Se trata del lugar donde se encuentran escondidas las Bestias Fundidoras.
* *Detectar magia*
  * Encuentras un [Pedestal de Lectura](SRD_Pedestal_of_Reading-5.html).
  * Los objetos del fallecido Maestro Nizgul desprenden una débil aura bajo una mesa hecha añicos.
* *Investigación*:
 * (DC 12) Encuentras el tomo *Criaturas innombrables de los abismos del multiverso*.
* *Percepción*
 * (DC 11) Debajo de una mesa hecha añicos encuentras el cadáver del Maestro Nizgul y los objetos que portaba en el combate:  
  * [Brazales de Armadura +2](../core/SRD5e/gamemastering/magic-items/wondrous-items.html#TOC-Bracers-of-Defense)
  * un [Cráneo Oscuro](SRD_Darkskull-5.html#boydContent)
  * una [Vara +1](../core/SRD5e/gamemastering/magic-items/magic-armor-and-weapons.html#TOC-Weapon-1-2-or-3)
* Además, ten en cuenta las [características generales](../lugares.html?param=@caracteristicas&amp;room=0) de la Escuela.  

CONCLUSION
---
Dependiendo de qué motivo los ha traído a la Biblioteca, los jugadores pueden continuar [[Buscando culpables]] 
                                                   
Si los jugadores encuentran *Criaturas inombrables de los abismos del multiverso* lee lo siguiente:

&gt;Extracto rescatado del Diario de Gulimrrar sobre sus Viajes por el Abismo
  
&gt;… la gruta estaba escavada longitudinalmente y rápidamente se bifurcaba en innumerables pasillos de oscuridad total. La luz de mi antorcha iluminaba las paredes y rebotaba entre las estrías que conformaban los muros dibujando un tapiz que parecía compuesto por anchas raíces de árbol. Pasé la mano sobre la superficie y la encontré suave y pulida, como si la roca hubiera sido fundida al ser expuesta a una temperatura desmedida...
  
&gt;… al girar una esquina me detuve en seco. De espaldas frente a mí, un ser de cuatro patas se abría paso creando un pasillo en la roca viva. A su paso la tierra se desmaterializaba permitiéndolo avanzar sin oposición. La criatura tenía el tamaño de un perro grande. Su piel era metálica y sus pezuñas, como las de un caballo, hacían saltar pequeñas chispas cuando chocaban contra la piedra. Dos cuernos curvos como los de un carnero flanqueaban su cabeza y unas largas y afiladas púas coronaban su lomo...
  
&gt;...el animal se giró y pude ver sus ojos rojos como el fuego mirando en mi dirección. Me pegué contra la pared y mantuve la respiración. Estaba seguro de que no podía haberme visto pero aún así supo que me encontraba espiándole y salió a la carrera en mi dirección. Desenvainé a Tzoral, recé a Salandir y me dispuse a pelear por mi vida...
&lt;br&gt;&lt;br&gt;
&gt;… seguía buscando una salida de aquellos malditos túneles del Abismo cuando volví a encontrarme con aquellas extrañas bestias que &#39;fundían&#39; la roca a su paso. Está vez se encontraban en una enorme cueva en la que decenas de estas criaturas descansaban medio adormecidas. Después de unos minutos valorando si dar media vuelta y buscar otra ruta o intentar pasar desapercibido entre ellas, una especie de demonio enano y regordete, con un cuerpo amorfo y pequeñas extremidades, apareció por otro de los pasillos que desembocaban en la gruta. No sé si se dirigió a las bestias verbal o mágicamente pero cuando levantó su pequeño brazo todas se pusieron en movimiento y comenzaron a escavar más túneles allí donde el gelatinoso ser lo indicaba...
  
  
Tras la lectura del texto, los jugadores pueden sacar sus propias conclusiones y además hacer una tirada de *conocimiento* para saber, a discrección del Master, las habilidades básicas de las Bestias Fundidoras.

images {./images/act-1/library.jpg, ./images/maps/library-map-2.jpg, ./images/monsters/hellhound.jpg}
music {outside-school.mp3}


</tw-passagedata><tw-passagedata pid="6" name="Maestro Nizgul" tags="encounter @nizgul" position="1507,420" size="100,100">
# ([50 XP](SRD_XP-5.html)) SITUACIÓN

Los jugadores pueden llegar a la habitación de Nizgul a través de la trampilla situada en el Archivo de la Biblioteca (9) o por el río subterráneo. También pueden descubrir la puerta secreta en el pasillo que da a la Cámara del Tesoro, en los [[Subterráneos]] de la Escuela.

&gt; La sala en la que entráis tiene la atmosfera cargada y la humedad hace difícil respirar. Os encontráis en el laboratorio del Maestro Nizgul. Todo está patas arriba, como si alguien en un ataque de rabiosa locura hubiera arrasado la estancia. En el centro, una mesa de mármol con restos de sangre seca domina la sala. A un lado, un largo escritorio de piedra sirve para albergar toda clase de alambiques, ingredientes para conjuros y libros de tiempo inmemorial, mientras que en el muro contrario, una serie de estanterías acogen una nutrida biblioteca. Pero todos estos detalles pasan casi inadvertidos comparados con la bizarra imagen en el muro frente a vosotros. Cinco enormes contenedores albergan a otros tantos seres, medio putrefactos, sumergidos en una solución verde que burbujea formando espuma en la superficie de los tanques. Junto a ellos una escala de mano da acceso a una de las aulas del piso superior. El silencio se rompe cuando escucháis el ruido de una redoma de cristal estrellándose contra el suelo. El sonido proviene de detrás de la puerta del muro sur. Con cuidado, atravesando un suelo lleno de botes rotos, os acercáis a la puerta mientras al otro lado continuáis oyendo el ruido de más cristales rotos.

Los seres de los tanques son experimentos nigrománticos fallidos de Nizgul, por lo que son inofensivos. Al otro lado de la puerta se encuentra la señorita Bilwa registrando la otra sala. 

Lee lo siguiente cuando abran la puerta:

&gt; Esta puerta da acceso a un pequeño almacén, forrado por estanterías que contienen una innumerable cantidad de frascos y botes. En la habitación, un ser embozado en una oscura capa marrón verdosa registra nerviosamente cada una de las redomas. Abre una, mira su interior y la lanza contra el suelo. Así, una detrás de otra

Cuando los jugadores vean el rostro de este ser, lee lo siguiente y muéstrales la imagen de la anciana:

&gt; Se trata de una mujer muy anciana, cuyos surcos en su ajada piel relatan las vivencias de una larga existencia más allá de lo natural. Pero sus ojos os resultan familiares ¡Se trata de la Señorita Bilwa!

Este encuentro se puede jugar de dos formas diferentes. 

### Los jugadores vienen a buscar el Elixir de Verdad
La alquimista confiesa que en realidad tiene más de 200 años y ha logrado mantenerse joven gracias a pócimas de Vida Eterna, que fabricaba gracias a los ingredientes que le facilitaba el Maestro Nizgul. Bilwa también confiesa que el viejo nigromante jugaba con ella y que hace un año ya que no la proporciona lo necesario. Por eso, los efectos mágicos de la poción se han disipado. Con la muerte de Nizgul la señorita Bilwa no tiene mucho tiempo antes de que los encantamientos desaparezcan del todo y se convierta en polvo, así que necesita que los jugadores encuentren los materiales antes de que sea demasiado tarde y muera. Dice a los jugadores que les proporcionará el Elixir de Verdad para administrar a Doris si ellos consiguen el ingrediente que la falta para crear su Poción de Juventud: Los dientes de un finado que lleve tanto tiempo muerto como ella evitando la muerte, 214 años exactamente. Para ello, los jugadores deberán ir al Cementerio de la ciudad y buscar un cadáver que lleve ese tiempo fallecido. La señorita Bilwa está muy alterada y teme por su vida, así que no entregará ningún Elixir de Verdad hasta que los jugadores la consigan su ingrediente. 

### En caso de que no vayan a por el Elixir de Verdad
La Señorita Bilwa contará la misma historia que en el anterior supuesto e intentará influenciar (incluso *hechizar*) a los jugadores para que la consigan el ingrediente que falta para su poción de juventud.

En cualquier caso, y si los jugadores aceptan ayudarla, la señorita Bilwa les ofrece robar armas mágicas de la Cámara del Tesoro, ya que considera que sin ellas los personajes no podrán hacer frente a los espíritus que protegen el cementerio. No mencionará a los espíritus si no es preguntada directamente y les propondrá robar las armas con la excusa de que tal vez las necesiten, sin especificar porqué. La hechicera acompañará a los jugadores a la Cámara del Tesoro para evitar que roben más de lo necesario.

Para localizar el cadáver que necesita la señorita Bilwa, el sitio más adecuado es el Cementerio de la ciudad. Picos y palas pueden ser encontrados fácilmente dentro de la Escuela. 

AT A GLANCE
---
* *Detectar magia*:
 * El líquido verde de los tanques irradia un aura de Necromancia.
* *Conocimiento Arcano* / *Religión*:
  * (DC 10) El maestro Nizgul dedicaba sus investigaciones a intentar traer de la muerte a los ya fallecidos, pero parece ser que hasta el momento había fracasado.
* *Detectar el bien y el mal*: 
 * No hay ningún aura malvada. 
* *Investigación*: 
 * (DC 5) Encuentras el libro de conjuros del maestro Nizgul, con los conjuros más comunes de Nigromancia hasta nivel 6. 
* Además, ten en cuenta las [características generales](../lugares.html?param=@caracteristicas&amp;room=0) de la Escuela.  
 
 
CONCLUSION
---
Los jugadores podrán ir, por recomendación de la señorita Bilwa, a buscar armas mágicas a la [[Cámara del Tesoro]] o directamente se pueden poner manos a la obra [[Buscando Huesos]].

También, pueden seguir con los asuntos pendientes [[Buscando culpables]] 

images {./images/act-2/nizgul-room-portrait.jpg, ./maps/mschool_dungeon-es.html, ./images/act-2/old-woman.jpg  }
music {nizgul-room.mp3}
</tw-passagedata><tw-passagedata pid="7" name="Cámara del Tesoro" tags="encounter @tesoro" position="1359,516" size="100,100">
# ([100 XP](SRD_XP-5.html)) DESPLIEGUE
La Escuela de Magia tiene una Cámara del Tesoro donde el director guarda los recursos financieros y otros objetos de valor. Los jugadores podrían llegar a esta localización o bien por azar, porque uno de los personajes sabe de su existencia o gracias a la información que les proporciona la señorita Bilwa. 

&gt; Una enorme plancha de metal pulido os cierra el paso mientras la luz de las antorchas rebota contra los remaches dorados que sujetan la tabla metálica a las paredes. En su centro, veis una cerradura y un círculo con números. Parece ser que algún tipo de mecanismo puede manipularse a modo de rueda giratoria. 

Los números y la rueda no son más que decoraciones para despistar a los ladrones. No hace falta más que la llave correcta para abrir esta puerta.


## Accediendo

Los jugadores deberán abrir la cerradura y desactivar la trampa de la puerta de la Cámara del Tesoro para poder acceder a su interior. Si se activa la trampa, un rayo surgirá de la puerta golpeando a quien se encuentre frente a ella.

Los jugadores pueden desactivar la trampa si llevan herramienta y superan una tirada de *Investigación* y posteriormente *Destreza* (DC 13). Si no se desmonta, se activará un conjuro de *Scorching Ray*, un sólo rayo que producirá daño (2d6) a quien esté manipulando la puerta en la casilla frente a ella.
Después, la puerta exige superar una tirada de *Destreza* (DC 15) con herramientas para poder entrar en la Cámara del Tesoro.

También, pueden emplear la llave maestra que tenía el Sargento Menzal en sus aposentos para abrir la puerta. Existe otra llave, en poder del Director Lormam, pero es difícil que pudieran hacerse con ella. Si se utiliza una de estas dos llaves, la trampa no se activará.

Si intentan romper la puerta, lo tendrán bastante complicado ya que tiene 60 puntos de golpe y una resistencia de 12. 

## El tesoro

&gt; Las antorchas de la sala arden nada más abrirse la puerta e iluminan una pequeña estancia. Un par de cofres de nogal descansan contra la pared de enfrente y un armero cubre la pared de vuestra izquierda mostrando una variada colección de armas conservadas en un excelente estado.

**Tesoro**: Cuatro lingotes de oro por valor de 300mo cada uno. 200 monedas de cobre, 100 monedas de plata, 68 monedas de oro, tres gemas de 50 monedas de plata cada, cinco [pociones de curar heridas ligeras](../core/SRD5e/gamemastering/magic-items/potions-oils.html#TOC-Potion-of-Healing), una [poción escalada](../core/SRD5e/gamemastering/magic-items/potions-oils.html#TOC-Potion-of-Climbing), una [varita de bolas de fuego](../core/SRD5e/gamemastering/magic-items/rods-staves-wands.html#TOC-Wand-of-Fireballs) (con 4 cargas) y un [saco contenedor menor](../core/SRD5e/gamemastering/magic-items/wondrous-items.html#TOC-Bag-of-Holding). Además, hay una [arma mágica](../core/SRD5e/gamemastering/magic-items/magic-armor-and-weapons.html#TOC-Weapon-1-2-or-3) (+1) adecuada para cada uno de los personajes.

## Con la señorita Bilwa

Si los personajes van acompañados de la señorita Bilwa solo les permitirá llevarse las armas que necesitan. Puede ser chantajeada con contar su secreto si se opone, y aceptará, pues no está dispuesta a que nadie sepa que realmente es una mujer anciana y no la bella dama que todos creen. Su vanidad la vencerá.

AT A GLANCE
---
* *Detectar Magia* revelará que objetos están encantados. 
* *Identificar* indicará el poder de los objetos mágicos.
* *Sabiduría* o *Inteligencia*
 * (DC 8) revelará que el mecanismo de la puerta no es más que una treta para despistar a los ladrones. 
* *Investigación*
 * (DC 13) para encontrar la trampa en el mecanismo de la puerta. 
* Además, ten en cuenta las [características generales](../lugares.html?param=@caracteristicas&amp;room=0) de la Escuela. 



CONCLUSION
---
Si han venido por recomendación de la señorita Bilwa, ya tendrán las armas para enfrentarse a los espíritus del Cementerio y seguramente continúen dirigiéndose al camposanto [[Buscando Huesos]].

Si los jugadores han robado el tesoro por avaricia, pueden continuar resolviendo los asuntos pendientes y [[Buscando culpables]]. 

images {./images/act-2/treasure-room-portrait.jpg, ./maps/mschool_dungeon-es.html, ./maps/mschool-es.html }
music {just-adventuring.mp3}


</tw-passagedata><tw-passagedata pid="8" name="Buscando a Doris" tags="encounter @saliendo-exterior" position="1142,24" size="100,100">
# ([XP 50](SRD_XP-5.html)) SITUACIÓN

Si es la segunda vez que salen de la ciudad, vete a [Saliendo por segunda vez](#saliendo-por-segunda-vez). 

Si es la primera, continúa aquí: 
Los personajes deberían salir en algún momento de la Escuela, ya sea para visitar la ciudad, dirigirse al Cementerio o a la Ballena Blanca. La única puerta de salida se encuentra en el patio. Otras posibles salidas son: 

* La claraboya en el [Observatorio de la Biblioteca](./lugares.html?param=@escuela-map&amp;room=5): pueden utilizar las cuerdas que utilizó Wilbur para entrar en la Escuela.

* Alguna de las chimeneas de la Escuela: Es necesario superar una tirada de *Destreza* (DC 10) para subir por el interior de una chimenea. 

* El pasadizo hasta la [[Torre de Vigilancia]] 

* Navegando por los [[Subterráneos]]

* Si ya han limpiado de monstruos el Patio, esta será la ruta más sencilla. Si no es así, deberán enfrentarse a los monstruos en el [[Patio de Armas]]. 

Si esta es la primera vez que los jugadores salen a la calle lee lo siguiente:

&gt; Aún no ha amanecido y las calles de Sâlorium a estas horas suelen ser tranquilas. Pero no hoy. Decenas de gritos provenientes de todas las zonas de la ciudad desgarran el ambiente advirtiendo del peligro que supone la horda de demonios vomitada por los portales de la Escuela de Magia

Los jugadores deberán ser cautelosos a la hora de moverse por las calles. Grupos de *Bestias Fundidoras* recorren la ciudad en busca de víctimas y otros cientos aguardan bajo los adoquines en los túneles que están construyendo bajo la urbe.
Los jugadores deben sentir que en cada momento una bestia fundidora puede salir al girar una esquina o que el suelo puede abrirse y enviarlos a una muerte segura. Dedicarse al saqueo o cualquier otro menester que no sea desplazarse por los tejados es una actividad de alto riesgo. 

Los jugadores tendrán que idear una forma segura de desplazarse por la ciudad. La forma más sencilla de evitar los encuentros es ir por los tejados de Sâlorium. Si no se les ocurre permite una tirada de *Percepción* (DC 8) para darse cuenta de que las bestias no suben a los tejados. 
Si viajan por el suelo, la probabilidad de encuentro dependerá de su habilidad de *Sigilo*. Permite bonificadores positivos si son creativos.

 Esconderse | % Encuentro
 ---        | ---
 1-3        | 90% 1d2 bestias fundidoras
 4-10       | 50% 1d2 bestias fundidoras
 11-15      | 25% 1d2 bestias fundidoras
 16+        | 5%  1d2 bestia fundidora

Los jugadores deben pasar por [[Rufianes del Mercado]] antes de llegar a [[La Ballena Blanca]], a no ser que sean capaces de cruzar el rio a nado *Fuerza* (DC 12) o que el Master quiera evitar el encuentro. 

Además, se pueden encontrar con alguna de las siguientes situaciones:

1d4 | Situación
--- | ---
1   | Encuentras un saco con 10 monedas de oro pobremente escondido en uno de los tejados. Uno de los ladrones de la cofradía de la ciudad ha ocultado aquí su botín.
2   | Un [Guardia de la ciudad](./lugares.html?param=@npcs&amp;room=6) se enfrenta a dos Bestias fundidoras en un callejón justo debajo de por donde pasan los jugadores. Está tratando de defender la vida de un par de jóvenes y una mujer adulta. Si los jugadores los ignoran y siguen su camino, la mujer los maldecirá con el puño en alto por su cobardía. |
3   | Un grupo de tejas se rompen al pasar sobre ellas. Uno o varios de los jugadores (a discreción del Master) deben superar una tirada de *Destreza* (DC 6) para no resbalar por el tejado, caer a la calle y sufrir 1d6 puntos de daño.
4   | Un grupo de vecinos se ha refugiado en la azotea de su edificio. Si los jugadores entablan algún contacto con ellos, uno de los hombres les pedirá que entren en la casa y rescaten a su nieto menor, que se ha quedado aterrado en su cuarto. El hombre es muy anciano para hacerlo por sí mismo y el resto de vecinos no quiere arriesgar la vida. Si los jugadores se deciden por ayudar al hombre, este le indicará donde encontrar a su familiar. No hay ningún monstruo en el edificio por lo que los jugadores podrán quedar como unos héroes sin tener que poner su vida en peligro. Este evento proporciona inspiración a los jugadores. 

## Saliendo por segunda vez

Los jugadores deben abandonar la Escuela. Ya ha amanecido y las fuerzas de la ciudad se han reorganizado para hacer frente a las *Bestias Fundidoras*. Una gran batalla se está librando en la zona norte de la ciudad, donde los demonios han acudido en masa para hacer frente a los hombres, por lo que los jugadores no deberían encontrar a ningún enemigo en su trayecto hasta La Ballena Blanca. 

Lee lo siguiente al poco de que salgan de la Escuela: 

&gt; Observáis como un grupo de unos 20 demonios corren calle arriba en tropel, empujándose unos a otros ansiosos por llegar a su destino. Os percatáis de que algunos de los monstruos son conscientes de vuestra presencia, pero os ignoran y continúan su desbocada carrera.

Las Bestias Fundidoras se dirigen a unirse a la batalla. Si los personajes no las siguen, en algún momento escucharán el ruido de la pelea, pero si no se acercan no verán el combate (en ese caso lee solo la primera parte de la siguiente descripción). Si, por el contrario, los jugadores siguen a los demonios, o más tarde se acercan a la batalla, lee la descripción completa:

&gt; El sonido de la lucha se hace cada vez más evidente a cada paso que dais. Una enorme batalla se está produciendo unas calles más arriba, cada vez más cerca de vuestra posición.

### Si llegan a la batalla:

&gt; Un cuadro dantesco se dibuja ante vosotros. La Guardia de la Ciudad, junto con aquellos ciudadanos lo suficientemente gallardos, hace frente a la horda de demonios que se lanza de manera kamikaze contra las líneas de alabarderos ignorando el daño que reciben y con el único objetivo de provocar el mayor número posible de bajas entre los defensores de la ciudad. Aquí y allá enormes cráteres se abren en el suelo engullendo a grupos completos de hombres, que desaparecen en las oscuras entrañas de la tierra. Los gritos de los soldados y los bufidos de los monstruos se mezclan con el sonido de las chispas que surgen al chocar el acero de las armas contra la piel metálica de las bestias. Sangre y tierra se entremezclan en un lodazal sobre él que hombres contra aberraciones deciden el destino de Sâlorium

Los jugadores podrían querer participar en la batalla. Si esto sucede, asume que cada jugador se enfrenta cada vez a entre una y dos Bestias Fundidoras. Cada vez que el jugador acabe con sus adversarios, otras tantas aberraciones tomarán su lugar. Si los jugadores persisten en mantenerse en la batalla y se las ingenian para sobrevivir, verán como tras una hora de lucha intensa, los monstruos son derrotados. Aun así, el precio para salvar Sâlorium ha sido demasiado grande, ya que las fuerzas de la ciudad han sido mermadas para que ya no supongan una amenaza a los planes de Gramdum Elojia.


AT A GLANCE
---
* *Investigación* 
 * (DC 15) en los Subterráneos encuentras un pasadizo hasta la Torre de Vigilancia. 
* *Percepción* 
 * (DC 8) una vez en la calle, te percatas de que los demonios no suben a los tejados. 
* *Investigación*
 * Hablando con miembros de la guardia o alguno de los maestros averiguas que existe un pasadizo que comunica con la Torre de Vigilancia. 

* Además, ten en cuenta las [características generales](../lugares.html?param=@caracteristicas&amp;room=0) de la Escuela.  

CONCLUSION
---
De camino a la Ballena Blanca pasarán por un Mercado donde un grupo de maleantes intenta robar a unos ciudadanos. [[Rufianes del Mercado]].

Si prefieres ahorrarte el encuentro en el Mercado, puedes saltar directamente a [[La Ballena Blanca]] 


images {./images/act-1/salorium.jpg, ./maps/msalorium-es.html, ./maps/mschool-es.html}
music {outside-school.mp3}


</tw-passagedata><tw-passagedata pid="9" name="Patio de Armas" tags="encounter @patio-armas" position="882,701" size="100,100">
# ([125 XP](SRD_XP-5.html)) DESPLIEGUE

* 4 *Bestias Fundidoras*  

Los jugadores pueden optar por intentar llegar a la habitación de Menzal (32) atravesando el Patio de Armas (1). También pueden atravesarlo para intentar salir al exterior. Lee lo siguiente cuando vayan a entrar: 
&gt; Os encontráis en el desolado Patio de la Escuela. El campamento ha sido arrasado por la horda de bestias y decenas de cuerpos siembran la explanada. Además, los atacantes han hecho polvo las puertas de acceso al recinto y por las huellas parece que cientos de ellos se han adentrado en la ciudad. Pero lo que más os llama la atención es un enorme cráter que ha aparecido en mitad de la explanada

# TÁCTICAS
Los demonios permanecen ocultos (*Sigilo* +1): uno de ellos, entre los restos de las tiendas, saltará si alguno de los jugadores intenta atravesar la puerta de salida a la ciudad. Otro de ellos, oculto en el cráter, atacará si algún insensato se asoma a mirar. Los otros dos están bajo tierra y a la espera de que alguien pase sobre ellos o por las casillas adyacentes. Intentarán atacar al unísono y atrapar al mayor número posible de enemigos.

# TERRENO
Si los jugadores investigan el cráter, verán que las Bestias Fundidoras han escavado la tierra y creado dos túneles. Uno va hacia la ciudad y otro hacia donde se encuentran los dos monstruos escondidos bajo el suelo del patio. Si descienden e investigan el camino que va hacía la ciudad, verán como este se bifurca rápidamente y así sucesivamente, creando un verdadero laberinto subterráneo. Si los Jugadores persisten en moverse bajo tierra, deberán enfrentarse a continuas oleadas de Bestias Fundidoras. Cada 20 metros, aproximadamente, hay una salida al exterior que ha sido usada por los demonios para sorprender a los habitantes de la ciudad. La salida puede encontrarse en una calle o dentro de un edificio, aleatoriamente.

AT A GLANCE
---
* Utilizando la habilidad de *Investigacion* por todo el patio pueden encontrar lo siguiente:
 * (DC 10) Corre un rio subterráneo bajo el pozo. 
 * (DC 10) Rapiñando entre los cadáveres encuentras 150mc y 10mp. 
 * (DC 15) Un anillo de uno de los muertos parece de una calidad excepcional. Se trata de un [anillo de protección +1](../core/SRD5e/gamemastering/magic-items/magic-rings.html#TOC-Ring-of-Protection).
* *Detectar magia*:
 * En el dedo de uno de los muertos encuentras un anillo que desprende magia. Se trata de un [anillo de protección +1](../core/SRD5e/gamemastering/magic-items/magic-rings.html#TOC-Ring-of-Protection).
* *Detectar el bien y el mal*: 
 * Los demonios son caóticos malvados. 

CONCLUSION
---
Los jugadores probablemente continúen ha rescatar a los alumnos [[Encerrados]].
También, podrían dedicarse a otros asuntos y seguir [[Buscando culpables]], [[Buscando a Doris]] o [[Buscando Huesos]].

images {./images/act-1/playground-2.jpg,./maps/mschool-es.html,  ./images/maps/southplayground-map-2.jpg }
music {playground.mp3}
</tw-passagedata><tw-passagedata pid="10" name="Aposentos de Glaucom" tags="encounter @glaucom" position="893,25" size="100,100">
# ([100XP](SRD_XP-5.html)) INVESTIGANDO LA ESCENA
Tras averiguar que el maestro Glaucom está desaparecido los jugadores se dirigen a los aposentos este (10).
La puerta está cerrada, abrirla exige una tirada de *Destreza* (DC 21) con herramientas o *Fuerza* (DC 18) romperla a base de golpes sabiendo que tiene resistencia 5 y 30 puntos de golpe. 

Cuando entren en la habitación, lee lo siguiente (el texto es una adaptación de una descripción aparecida en la novela &#39;El amor en los tiempos del cólera&#39;, de Gabriel García Márquez: 

&gt; Es inevitable: el olor de las almendras amargas recuerda siempre el destino de una vida contrariada. Lo percibís desde que entráis en la habitación en penumbras. El Maestro Glaucom, inválido de guerra, erudito y compasivo adversario de ajedrez, se ha puesto a salvo de los tormentos de la memoria con un sahumerio de cianuro. Encontráis el cadáver cubierto con una manta en el catre de campaña donde había dormido siempre, cerca de un taburete con la cubeta que había servido para vaporizar el veneno. En el suelo junto al catre, está el cuerpo tendido de un gran danés negro de pecho nevado, y junto a él están las muletas. Cualquier resquicio de la habitación está amordazado con trapos o sellado con cartones negros, y eso aumentaba su densidad opresiva. Hay un mesón atiborrado de frascos y pomos sin rótulos, y dos cubetas de peltre descascarado. Hay pergaminos y libros viejos por todas partes, pilas de cajas donde anidaban decenas de redomas que conservan líquidos imposibles de catalogar, pero todo preservado del polvo por una mano diligente

Los jugadores tienen ahora la opción de investigar diferentes aspectos de la habitación.

* Si los personajes investigan el cuerpo del finado, lee lo siguiente:  
&gt; El Maestro Glaucom está desnudo por completo, tieso y torcido, con los ojos abiertos y el cuerpo azul, y como cincuenta años más viejo que la noche anterior. Tiene las pupilas diáfanas, la barba y los cabellos amarillentos, y el vientre atravesado por una cicatriz antigua cosida con nudos de enfardelar. Su torso y sus brazos tenían una envergadura de galeote por el trabajo de las muletas, pero sus piernas inermes parecían de huérfano.

Después de que los personajes investiguen la habitación y el cadáver, un joven aprendiz, Illius de Torak, compañero de Yonse, entra corriendo en la habitación y se lanza llorando sobre el cadáver de su maestro. Illius era el favorito de Glaucom, y este lo había tomado bajo su ala como su asistente personal. Los jugadores pueden hablar con Illius cuando se calme. Una conversación con él revelará lo siguiente:

* El maestro llevaba una semana o dos comportándose de manera errática. Ya no tenía ninguna relación con Illius, al que había apartado totalmente de su lado en los últimos tiempos.

* Illius sabe, por lo que le comentaron otros aprendices, que el Maestro Glaucom era visto por las noches deambulando por la Escuela sin aparente razón.

* Illius, preocupado por su maestro, pasó un par de noches espiando a Glaucom y llegó a seguirle hasta una maloliente posada del muelle donde el maestro pasó toda la noche. Illius sospecha que hacía uso de los servicios de alguna mujer de vida distraída. 

La verdad es que Illius no siguió a Glaucom, si no a Doris, el cambiaformas que lo sustituyo. Doris visitó esa noche la posada de ‘La Ballena Blanca’ para recibir instrucciones de un enviado de su amo. 

## Examinando el Cadáver
* Una tirada de *Curar* revelará el siguiente conocimiento sobre el cianuro: 
  * **DC 10**: El cianuro de hidrógeno líquido o gaseoso y las sales alcalinas del cianuro pueden ingresar al cuerpo por inhalación, ingestión o absorción a través de los ojos y la piel. El nivel de absorción de la piel aumenta cuando ésta se encuentra cortada, deteriorada o húmeda. Las sales de cianuro se disuelven con facilidad y se absorben al entrar en contacto con las membranas mucosas. 

* Una tirada de *Investigación* o *Medicina* sobre el cadáver revelará lo siguiente: 
  * **DC 5**: Glaucom no debía de tener más de 50 años en el momento de su muerte, pero una antigua herida de guerra mal tratada, que le atraviesa el vientre y lo dejo sin movilidad en las piernas, junto a la exposición prolongada a los gases del cianuro ha provocado que su estado sea similar al de un anciano de 90 años.
  * **DC 10**: Sus ojos y membranas mucosas presentan signos de haber sido expuestas a los fatales gases del cianuro. Su antigua herida mal curada ha sido también un importante factor en la rápida absorción del veneno.
  * **DC 11**: Las sábanas del catre están mojadas, como si Glaucom se hubiera bañado antes de acostarse.
  * **DC 12**: El cadáver presenta una descomposición muy avanzada para haber muerto hace poco. Podrías datar la muerte hace al menos dos semanas.
  * **DC 15**: Ambas palmas de las dos manos del muerto presentan unas laceraciones casi microscópicas. 

* Una tirada de *Percepción* sobre la zona de la cama revelará lo siguiente:
  * **DC 15**: La cubeta en el que se ha vaporizado el veneno está forjada en bronce y debe pesar al menos 10 kilos, demasiado para que alguien impedido pudiera moverlo hasta la cama sin arrástralo. Si se buscan específicamente arañazos en el suelo (DC 5) no hay rastro de que la cubeta fuera arrastrada por el suelo, sus patas puntiagudas hubieran dejado evidentes arañazos en el suelo de la habitación. 

* Una tirada de *Percepción* o *Investigación* sobre las muletas revelará lo siguiente:
  * **DC 12**: Ambas empuñaduras presentan unos pequeños 	agujeros donde podrían haberse alojado sendas agujas. 

* Una tirada de *Medicina* o *Conocimiento de la Naturaleza* sobre el cuerpo del gran danés muerto revelará lo siguiente:
  * **DC 15**: El animal presenta signos de haber absorbido también gases venenosos, pero el hecho de que no intentara huir indica que debió de fallecer antes de inhalar el cianuro. Si se abre al animal en canal (DC 10) se pueden observar, aún sin digerir totalmente, restos de un potente veneno en el estómago e intestinos del animal. Fue envenenado. 
  
AT A GLANCE
---
* Se pueden hacer tiradas para investigar la escena del crimen, las dificultades y los resultados están en la sección *Examinando el Cadáver* del texto principal. 


* *Detectar Magia*:
 * Llamativamente no hay ningún objeto mágico en la habitación de un mago. 
* *Detectar el bien y el mal*, no detecta nada relevante
* *Detectar Veneno*:
 * Detecta los restos de veneno en el caldero dispuesto a los pies de la cama de Glaucom.
* *Investigación*:
 * (DC 10) Sorprendentemente, no hay ningún objeto arcano en la habitación de un mago. 
* Además, ten en cuenta las [características generales](../lugares.html?param=@caracteristicas&amp;room=0) de la Escuela. 


CONCLUSION
---
En este punto los personajes deberían haber averiguado lo siguiente:

* Que Glaucom no se suicidó si no que fue asesinado.
* La muerte se produjo hace al menos dos semanas: alguien se ha estado haciendo pasar por el Maestro todo ese tiempo. 
* El maestro Glaucom se comportaba de manera extraña desde hace varios días y pasaba las noches en la posada de la Ballena Blanca.

Si deciden seguir la pista de la Ballena Blanca, saldrán al exterior [[Buscando a Doris]]. 

Los jugadores pueden continuar investigando la Escuela y [[Buscando culpables]]. 

images {./images/act-2/glaucom-room.jpg , ./maps/mschool-es.html,./images/maps/glaucom-map.jpg }
music {glaucom-room.mp3}


</tw-passagedata><tw-passagedata pid="11" name="Rufianes del Mercado" tags="encounter @plaza-pueblo" position="1326,26" size="100,100">
# ([100 XP](SRD_XP-5.html)) DESPLIEGUE

* 3 *Rufianes*  

Bien se desplacen a ras de tierra o por los tejados, los jugadores llegarán a una plaza de mercado. En ese momento, lee lo siguiente: 

&gt; Llegáis a una plaza. Para seguir vuestro camino debéis cruzarla y exponeros en campo abierto, o bien dar un rodeo buscando una ruta más protegida pero más larga. Las dudas os corroen cuando escucháis un grito. Unos hombres entran en la plaza empujando y arrastrando a varias personas. Los hombres son cuatro y tienen el aspecto peligroso de la típica mala hierba que arraiga en el barrio del puerto. Las víctimas, tres mujeres con dos niños y dos hombres, a los que han molido a palos previamente, suplican por su vida. Parece que un grupo de bastardos quiere sacar provecho del caos en la ciudad masacrando a los más débiles

Los jugadores deben elegir si socorren a las víctimas o los ignoran. 
Si Wilbur está en el grupo, reconoce a los ladrones como miembros de la banda de ‘El Tuerto’. Si los personajes deciden intervenir para salvar a las víctimas, los maleantes se dirigirán a Wilbur dejando en evidencia su relación con el personaje diciendo cosas del tipo:

&gt; ¡Eh! Wilbur, ¿Qué haces por aquí, también has salido de caza?” o “Estas son nuestras presas, búscate las tuyas, payaso”

Wilbur podría intentar negociar con ellos para que dejen en paz a sus víctimas, pero se negarán en redondo. Cuando vean que el enfrentamiento es irreversible uno de ellos, el líder dirá: 
&gt; Esto que haces no le va a gustar al Tuerto, lo pagarás

Si los jugadores no intervienen, los maleantes asesinarán a sus víctimas, las robarán y se irán por donde han venido. 

Si los jugadores luchan contra los malhechores, uno de los asaltantes que se encuentre en meleé con algún jugador, al sentirse acorralado tomará a uno de los niños como escudo humano y amenazará con asesinarle si no le dejan huir. En ese momento, el suelo se abrirá en una casilla adyacente al villano y de la tierra surgirá una Bestia Fundidora que absorberá al cobarde al fondo del pozo. Un jugador cercano puede tirar Reflejos (DC 8) para recoger al niño y que no sea engullido al agujero. Después, los jugadores tendrán dos turnos para abandonar la zona y ponerse a salvo de los monstruos comenzarán a surgir del nuevo cráter. 

# TÁCTICAS
Los maleantes no emplean ninguna táctica sofisticada, no son más que navajeros de medio pelo. Eso sí, aprecian su vida por encima de todo y no dudarán en usar a sus víctimas como escudos humanos si la situación lo requiere. No son suicidas y prefieren huir o rendirse antes que morir.

AT A GLANCE
---
* *Percepción* 
 * (DC 5) El suelo parece inestable probablemente debido a los túneles que están cavando las Bestias Fundidoras. 
* *Detectar magia*, los asaltantes no llevan ninguna clase de magia. 
* *Detectar el bien y el mal*, los asaltantes son neutrales malvados. 
* *Intuición*
 * (DC 6) los asaltantes parecen bravucones, pero se van a achantar a la mínima. 


CONCLUSION
---
Los maleantes acabarán muertos o huyendo. Tras el combate, las víctimas agradecerán su valor a los jugadores y saldrán corriendo a refugiarse antes de que aparezcan más Bestias Fundidoras.


Pasado este encuentro, los jugadores pueden ir a cualquier lugar del pueblo, probablemente a [[La Ballena Blanca]] 

images {./images/act-3/square.jpg, ./images/maps/square-map.jpg, ./maps/msalorium-es.html}
music {school-under-attack.mp3}
</tw-passagedata><tw-passagedata pid="12" name="La Ballena Blanca" tags="encounter @ballena-blanca" position="1505,91" size="100,100">
# ([150 XP](SRD_XP-5.html)) DESPLIEGUE

* *Doris, cambiaformas*  

Los jugadores llegarán finalmente a la Ballena Blanca para encontrar que la puerta de posada está trancada por dentro. Si quieren enterar, los personajes deberán forzar la puerta (Resistencia 5 y 20 puntos de golpe) o trepar hasta alguna ventana *Destreza* (DC 11). También pueden llamar a la puerta y esperar a que Zorx, el dueño de la posada, decida dejarlos pasar dentro. Para convencerlo, los personajes deberán ser muy persuasivos pues el posadero está muy asustado por lo que ocurre fuera.

Una vez en el interior, los personajes deberían buscar a Doris, que se encuentra en una habitación en el piso superior. Si los jugadores han entrado por las buenas y preguntan al posadero este admitirá que un anciano con la descripción del Maestro Glaucom se encuentra en el piso superior.

Si han entrado por las malas, [Zorx](./lugares.html?param=@npcs&amp;room=5) se enfrentará a ellos, pero al verse superado se rendirá. No quiere morir. Los demás clientes pueden intervenir o no, dependiendo del grado de agresividad de los jugadores y del estado físico en el que se encuentren. Si ya han perdido mucha vida en su camino hasta la posada tal vez no sea recomendable que tengan otro combate antes de enfrentarse a Doris. Además, un combate en el piso inferior alertaría al cambiaformas y este trataría de escapar por los tejados. 

Doris se encuentra descansando en el piso superior. Acaba de enviar un mensaje a su amo a través de un mensajero que le esperaba en la Ballena Blanca y ha cobrado por su trabajo. Espera que las cosas se calmen un poco en la ciudad y abandonarla lo más rápido posible.
Lee lo siguiente a los jugadores cuando entren en la habitación:
&gt; El cuarto es la vulgar habitación que esperarías encontrar en cualquier vulgar posada. En la cama un, aparentemente, cansado Maestro Glaucom dormita hasta que irrumpís en el lugar. Con una agilidad inusitada para alguien inválido, el mago salta y se coloca junto al catre mientras os mira desafiante: &quot;Vaya, parece que ya no son necesarios más engaños, je je. Lo habéis hecho bien, pero por desgracia, no saldréis con vida de este lugar&quot;, dice mientras sus rasgos y cuerpo cambian hasta mostrar su verdadera forma

Muestra a los jugadores la imagen del cambiaformas.

# TÁCTICAS
Doris es un hábil combatiente e intentará eliminar a los personajes. Si se ve superado, intentará salir al tejado por la ventana y emprender la huida. Si no pude huir, se rendirá ya que aprecia demasiado su vida.


## INTERROGANDO A DORIS

Doris será apresado por los jugadores, pero no revelará nada sobre sus planes o quien lo envió para abrir los portales. Si es registrado, los jugadores encontrarán una bolsa con gemas por valor de 500mo. El desgastado saco tiene grabado el símbolo de la Madre de los Demonios (mostrar ilustración). 

Si los personajes desean sacar información a Doris deberán hacerlo por medios mágicos. La señorita Bilwa puede preparar un elixir de verdad. Pero para ello deberán regresar a la Escuela.

## EL TESORO DE DORIS

Debajo de la cama Doris guarda un saco donde esconde los objetos que robó al maestro Glaucom. En su interior se encuentra lo siguiente:
* [Capa de protección +1](../core/SRD5e/gamemastering/magic-items/wondrous-items.html#TOC-Cloak-of-Protection)
* 1 pergamino de [Armadura de Mago](../core/SRD5e/spellcasting/all-spells/m/mage-armor.html)
* 1 pergamino de [Invisibilidad mayor](../core/SRD5e/spellcasting/all-spells/g/greater-invisibility.html)
* Unas [Botas de Levitación](../core/SRD5e/gamemastering/magic-items/wondrous-items.html#TOC-Boots-of-Levitation)
* Una [Vara de encantamientos](../core/SRD5e/gamemastering/magic-items/rods-staves-wands.html#TOC-Staff-of-Charming) a la que sólo le quedan 2 cargas

Los jugadores pueden optar por quedarse los objetos o devolvérselos a la Escuela. Si los devuelven, el director de la Escuela solo querrá recuperar la Vara de Paso y a cambio entregará 10.000 mo. 

AT A GLANCE
---
* *Intuición*
 * (DC 5) El posadero está asustado, algo de *Persuasión* (DC 10) podría ayudar para que abra la puerta.
* *Detectar Magia*:
 * Algo mágico se encuentra en una habitación del piso superior. Es el saco con el tesoro de Doris. 
* *Detectar el bien y el mal*: 
 * El posadero y las personas refugiadas en la posada no son malvadas. Hay alguien malvado en el piso superior, Doris. 
 
CONCLUSION
---  
Una vez que los personajes tengan a Doris a su cargo, comienza el siguiente acto: [[El Prisionero]]. 
    
    
images {./images/act-3/tavern-portrait.jpg, ./images/maps/N1-2-tavern-map.jpg, ./maps/msalorium-es.html }
music {just-adventuring-2.mp3}
    

</tw-passagedata><tw-passagedata pid="13" name="El Prisionero" tags="encounter @prisionero" position="1511,259" size="100,100">
# SITUACIÓN
Los jugadores vuelven a la Escuela con Doris como prisionera. Una vez más, los combates en la ciudad dependen del estado de salud de los personajes. Si no están muy malheridos pueden tener un encuentro con un par de Bestias Fundidoras. De todas formas, el regreso debería volver a ser un viaje agónico, con el miedo de morir a la vuelta de la esquina. Si los personajes se despistan Doris podría intentar escapar. 

Si no has utilizado la tabla de encuentros en [[Buscando a Doris]] puedes emplearla ahora.

1d4 | Situación
--- | ---
1   | Encuentras un saco con 10 monedas de oro pobremente escondido en uno de los tejados. Uno de los ladrones de la cofradía de la ciudad ha ocultado aquí su botín. |
2   | Un [Guardia de la ciudad](./lugares.html?param=@npcs&amp;room=5) se enfrenta a dos *Bestias Fundidoras* en un callejón justo debajo de por donde pasan los jugadores. Está tratando de defender la vida de un par de jóvenes y una mujer adulta. Si los jugadores los ignoran y siguen su camino, la mujer los maldecirá con el puño en alto por su cobardía. |
3   | Un grupo de tejas se rompen al pasar sobre ellas. Uno o varios de los jugadores (a discreción del Master) deben superar una tirada de *Destreza* (DC 6) para no resbalar por el tejado, caer a la calle y sufrir 1d6 puntos de daño. |
4   | Un grupo de vecinos se ha refugiado en la azotea de su edificio. Si los jugadores entablan algún contacto con ellos, uno de los hombres les pedirá que entren en la casa y rescaten a su nieto menor, que se ha quedado aterrado en su cuarto. El hombre es muy anciano para hacerlo por sí mismo y el resto de vecinos no quiere arriesgar la vida. Si los jugadores se deciden por ayudar al hombre, este le indicará donde encontrar a su familiar. No hay ningún monstruo en el edificio por lo que los jugadores podrán quedar como unos héroes sin tener que poner su vida en peligro. |


## El problemilla de la señorita Bilwa
Una vez dentro de la Escuela, los jugadores deberían intentar sonsacar información a Doris. Si no se les ocurre a ellos, algún maestro puede sugerir usar medios mágicos. Para ello necesitan un [Elixir de Verdad](SRD_Elixir_of_Truth-5.html#bodyContent) que sólo sabe fabricar la señorita Bilwa.

Si ya han conseguido los ingredientes necesarios para la Poción de Juventud de la señorita Bilwa, está les entregará el Elixir de Verdad sin problema. 

En otro caso, los personajes deberán buscar a la señorita Bilwa que se encuentra en la habitación del Maestro Nizgul.

La señorita Bilwa ha usado la puerta secreta de la Cripta, *Investigación* (DC 15), para acceder a la habitación de Nizgul a través de los subterráneos.  

Si los jugadores se empeñan en interrogar a Doris por medios mundanos, incluso si lo torturan, el cambiaformas no soltará prenda.


AT A GLANCE
---
**Tanto si lo jugadores conocen el secreto de la señorita Bilwa como si no, esta se encuentra en la habitación del maestro Nizgul**

* *Investigación*:
 * (DC 10) Alguno de los refugiados vio *desaparecer* a la señorita Bilwa en el fondo de la Cripta. 
* *Intuición*
 * (DC 5) Comprendes que Doris tiene una voluntad de hierro y no confesará si no es forzado por medios mágicos. 


CONCLUSION
---
Los personajes deberán buscar a la señorita Bilwa bien por la puerta secreta en los [[Subterráneos]] o peinando la Escuela, hasta llegar a la habitación del [[Maestro Nizgul]].

Los jugadores también pueden dedicarse a otros asuntos pendientes del anterior acto [[Buscando culpables]]


images {./images/monsters/doris-portrait.jpg , ./maps/msalorium-es.html, ./maps/mschool-es.html}
music {just-adventuring.mp3}

</tw-passagedata><tw-passagedata pid="14" name="Buscando Huesos" tags="encounter @buscando-huesos" position="1202,544" size="100,100">
# ([50 XP](SRD_XP-5.html)) SITUACIÓN

Si es la segunda vez que salen de la ciudad, vete a [Saliendo por segunda vez](#saliendo-por-segunda-vez). 

Los personajes deberían salir en algún momento de la Escuela, ya sea para visitar la ciudad, dirigirse al Cementerio o a la Ballena Blanca. La única puerta de salida se encuentra en el patio. Otras posibles salidas son: 

* La claraboya en el [Observatorio de la Biblioteca](./lugares.html?param=@escuela-map&amp;room=5): pueden utilizar las cuerdas que utilizó Wilbur para entrar en la Escuela.

* Alguna de las chimeneas de la Escuela: Es necesario superar una tirada de *Destreza* (DC 10) para subir por el interior de una chimenea. 

* El pasadizo hasta la [[Torre de Vigilancia]] 

* Navegando por los [[Subterráneos]]

* Si ya han limpiado de monstruos el Patio, esta será la ruta más sencilla. Si no es así, deberán enfrentarse a los monstruos en el [[Patio de Armas]]. 

Si esta es la primera vez que los jugadores salen a la calle lee lo siguiente:

&gt; Aún no ha amanecido y las calles de Sâlorium a estas horas suelen ser tranquilas. Pero no hoy. Decenas de gritos provenientes de todas las zonas de la ciudad desgarran el ambiente advirtiendo del peligro que supone la horda de demonios vomitada por los portales de la Escuela de Magia

Los jugadores deberán ser cautelosos a la hora de moverse por las calles. Grupos de *Bestias Fundidoras* recorren la ciudad en busca de víctimas y otros cientos aguardan bajo los adoquines en los túneles que están construyendo bajo la urbe.
Los jugadores deben sentir que en cada momento una bestia fundidora puede salir al girar una esquina o que el suelo puede abrirse y enviarlos a una muerte segura. Dedicarse al saqueo o cualquier otro menester que no sea desplazarse por los tejados es una actividad de alto riesgo. 

Los jugadores tendrán que idear una forma segura de desplazarse por la ciudad. La forma más sencilla de evitar los encuentros es ir por los tejados de Sâlorium. Si no se les ocurre permite una tirada de *Percepción* (DC 8) para darse cuenta de que las bestias no suben a los tejados. 
Si viajan por el suelo, la probabilidad de encuentro dependerá de su habilidad para *Sigilo*. Permite bonificadores positivos si son creativos.

 Esconderse | % Encuentro
 ---        | ---
 1-3        | 90% 1d2 bestias fundidoras
 4-10       | 50% 1d2 bestias fundidoras
 11-15      | 25% 1d2 bestias fundidoras
 16+        | 5%  1d2 bestia fundidora


Además, se pueden encontrar con alguna de las siguientes situaciones:

1d4 | Situación
--- | ---
1   | Encuentras un saco con 10 monedas de oro pobremente escondido en uno de los tejados. Uno de los ladrones de la cofradía de la ciudad ha ocultado aquí su botín. |
2   | Un [Guardia de la ciudad](./lugares.html?param=@npcs&amp;room=6) se enfrenta a dos Bestias fundidoras en un callejón justo debajo de por donde pasan los jugadores. Está tratando de defender la vida de un par de jóvenes y una mujer adulta. Si los jugadores los ignoran y siguen su camino, la mujer los maldecirá con el puño en alto por su cobardía. |
3   | Un grupo de tejas se rompen al pasar sobre ellas. Uno o varios de los jugadores (a discreción del Master) deben superar una tirada de *Destreza* (DC 6) para no resbalar por el tejado, caer a la calle y sufrir 1d6 puntos de daño. |
4   | Un grupo de vecinos se ha refugiado en la azotea de su edificio. Si los jugadores entablan algún contacto con ellos, uno de los hombres les pedirá que entren en la casa y rescaten a su nieto menor, que se ha quedado aterrado en su cuarto. El hombre es muy anciano para hacerlo por sí mismo y el resto de vecinos no quiere arriesgar la vida. Si los jugadores se deciden por ayudar al hombre, este le indicará donde encontrar a su familiar. No hay ningún monstruo en el edificio por lo que los jugadores podrán quedar como unos héroes sin tener que poner su vida en peligro. Proporciona inspiración a los jugadores que realicen esta tarea.|


## Saliendo por segunda vez

Los jugadores deben abandonar la Escuela. Ya ha amanecido y las fuerzas de la ciudad se han reorganizado para hacer frente a las Bestias Fundidoras. Una gran batalla se está librando en la zona norte de la ciudad, donde los demonios han acudido en masa para hacer frente a los hombres, por lo que los jugadores no deberían encontrar a ningún enemigo en su trayecto hasta el Cementerio. 

Lee lo siguiente al poco de que salgan de la Escuela: 

&gt; Observáis como un grupo de unos 20 demonios corren calle arriba en tropel, empujándose unos a otros ansiosos por llegar a su destino. Os percatáis de que algunos de los monstruos son conscientes de vuestra presencia, pero os ignoran y continúan su desbocada carrera.

Las Bestias Fundidoras se dirigen a unirse a la batalla. Si los personajes no las siguen, en algún momento escucharán el ruido de la pelea, pero si no se acercan no verán el combate (en ese caso lee solo la primera parte de la siguiente descripción) Si, por el contrario, los jugadores siguen a las Bestias Fundidoras, o más tarde se acercan a la batalla, lee la descripción completa:

&gt; El sonido de la lucha se hace cada vez más evidente a cada paso que dais. Una enorme batalla se está produciendo unas calles más arriba, cada vez más cerca de vuestra posición.

### Si llegan a la batalla:

&gt; Un cuadro dantesco se dibuja ante vosotros. La Guardia de la Ciudad, junto con aquellos ciudadanos lo suficientemente gallardos, hace frente a la horda de demonios que se lanza de manera kamikaze contra las líneas de alabarderos ignorando el daño que reciben y con el único objetivo de provocar el mayor número posible de bajas entre los defensores de la ciudad. Aquí y allá enormes cráteres se abren en el suelo engullendo a grupos completos de hombres, que desaparecen en las oscuras entrañas de la tierra. Los gritos de los soldados y los bufidos de los monstruos se mezclan con el sonido de las chispas que surgen al chocar el acero de las armas contra la piel metálica de las bestias. Sangre y tierra se entremezclan en un lodazal sobre él que hombres contra aberraciones deciden el destino de Sâlorium

Los jugadores podrían querer participar en la batalla, si esto sucede, asume que cada jugador se enfrenta cada vez a entre uno y dos Bestias Fundidoras. Cada vez que el jugador acabe con sus adversarios, otras tantas aberraciones tomarán su lugar. Si los jugadores persisten en mantenerse en la batalla y se las ingenian para sobrevivir, verán como tras una hora de lucha intensa, los monstruos son derrotados. Aun así, el precio para salvar Sâlorium ha sido demasiado grande, ya que las fuerzas de la ciudad han sido mermadas para que ya no supongan una amenaza a los planes de Gramdum Elojia.

Intervengan o no en la batalla, los jugadores deberían dirigir sus pasos hacia [[El cementerio]].

AT A GLANCE
---
* *Investigación* 
 * (DC 15) en los Subterráneos, encuentras un pasadizo hasta la Torre de Vigilancia. 
* *Percepción* 
 * (DC 8) una vez en la calle, te percatas de que las bestias no suben a los tejados. 
* *Intuición*
 * Hablando con miembros de la guardia o alguno de los maestros averiguas que existe un pasadizo que comunica con la Torre de Vigilancia. 
* Además, ten en cuenta las [características generales](../lugares.html?param=@caracteristicas&amp;room=0) de la Escuela. 
 

CONCLUSION
---
Una vez recorrida la ciudad, los jugadores podrán llegar hasta [[El cementerio]]

images {./images/act-1/salorium.jpg, ./images/monsters/hellhound.jpg, ./maps/msalorium-es.html }
music {outside-school.mp3}

</tw-passagedata><tw-passagedata pid="15" name="El cementerio" tags="encounter @cementerio" position="1362,659" size="100,100">
# ([250 XP](SRD_XP-5.html)) DESPLIEGUE

* *Lord Gimion, Fantasma Protector*  

Cuando los personajes lleguen a su destino, muéstrales la ilustración del Cementerio y lee lo siguiente:

&gt; Este lugar parece estar al margen de todo lo que está sucediendo en el resto de la ciudad. La tranquilidad y el silencio más absoluto reina en todo el cementerio, como si los avatares del exterior no hicieran mella en este lugar de reposo. Una densa niebla cubre el lugar hasta la altura de vuestras rodillas. Hasta la cintura si eres un halfling. El cielo encapotado permite pasar los primeros rayos de luz de la mañana, aunque gran parte del camposanto aún permanece en la oscuridad.

Los jugadores deberán localizar la zona más antigua del cementerio si quieren encontrar muertos que lleven fallecidos tanto tiempo como es necesario para que sirvan de ingrediente a la poción de la señorita Bilwa.
Cuando los jugadores lleguen a esa zona y localicen la lápida adecuada para saquear (marcada con una X), lee lo siguiente:

&gt; Una forma humanoide comienza a formarse de la niebla que cubre vuestros pies. Un hombre translucido, vestido con elegantes ropajes y porte señorial os observa con actitud severa. Con un alarido fantasmagórico, su rostro dibuja un horrible gesto de ira que os hiela la sangre.

Se trata de *Lord Gimion*, un antiguo caballero cuya vida después de la muerte fue consagrada por sacerdotes a la protección de los finados. No permite que nadie irrumpa el sueño de los muertos y atacará a aquellos que con sus actos mancillen el suelo sagrado.

# TÁCTICAS
*Lord Gimion* atacará preferiblemente al personaje o personajes más involucrados en el proceso de abrir tumbas y remover tierra. 
Lord Gimion no puede estar a la luz del día por lo que deberá ir refugiándose en las zonas no iluminadas. Cada turno, las nubes se mueven cambiando que lugares están a la sombra y cuales iluminados. Ve pasando el mapa cada turno y mueve a Lord Gimion a una localización segura para él, aunque esto suponga que no realiza ninguna otra acción. Si debido a esta circunstancia puede terminar su movimiento junto a un enemigo y atacar, se moverá preferiblemente a esta localización. 
Un jugador que dedique el turno completo a mirar el cielo puede calcular que zonas estarán iluminadas el siguiente turno si supera una tirada de *Sabiduría* (DC 10)
Un personaje con el equipo adecuado (palas y picos) tardará 14 turnos en abrir la fosa, sacar el ataúd y encontrar los dientes del muerto. Si un segundo personaje le ayuda tardará 6. Un tercer personaje no haría más que estorbar en el proceso.

## EL MISTERIO DE LA FAMILIA SAWUERNIZER

Si Monak (o su historia) ha sido uno de los personajes pre-generados usados por los jugadores y se encuentra en el Cementerio enfrentándose a Lord Gimion, permítele una tirada de *Percepción* (DC 6) cuando se enfrente al espectro. Si la supera, infórmale (sin que se entere el resto de jugadores) de lo siguiente,

&gt; Cuando miras al fantasma no puedes evitar fijarte en su casco. Su ostentoso yelmo está coronado por un llamativo símbolo que conoces muy bien. Se trata del mismo escudo de armas grabado en tu espada

*Lord Gimion* es un antepasado de Monak. Si este decide investigar el Cementerio, descubrirá un panteón cercano con el mismo símbolo labrado sobre la entrada. Si se adentra en el mausoleo, lee lo siguiente:

&gt; A duras penas consigues desatrancar la verja que sirve de puerta en este mausoleo. El interior está descuidado y polvoriento, con decenas de enredaderas que cubren suelo y paredes abrazando un sepulcro de mármol rojo situado en el centro de panteón

Si se investiga el lugar, una tirada de *Investigacion* (DC 6) revelará que las paredes sostuvieron en su día planchas de mármol rojo que han sido retiradas con posterioridad. Algún resto aún pegado a los muros indica que estas planchas debían de componer un impresionante bajorrelieve. Por desgracia, los pocos vestigios impiden averiguar que representaba.

Si se abre la tumba, en su interior puede encontrarse el cadáver de Lord Gimion: un montón de huesos y una calavera en el interior de una rica armadura de placas. Hay también un yelmo y una espada bastarda. Todo se encuentra en muy mal estado por el paso del tiempo y es inservible. Una tirada de *Percepción* o *Investigación* (DC 10) revelará un texto cincelado en el interior de la tapa del sarcófago.

El texto está escrito en una versión arcaica del idioma común, pero puede ser, más o menos, traducido de la siguiente manera:

&gt; Honor y sangre de los Sawuernizers,  
reposa y acepta la paz.  
Deja lo que de la tierra tomaste,  
carne y alma.  
Arrastra tu ruina abisal,  
y consuma lo que en vida no supiste enfrentar.  
Honor y sangre de los Sawuernizers.

Una tirada de *Historia* (DC 12) revelará que los Sawuernizers eran una antigua familia que poseía una hacienda al Sur de la ciudad. Hace décadas, era una las más prominentes de la zona, pero, según la tradición local, cayó en desgracia y desapareció. El misterio que envuelve a esta familia continúa en el Modulo: **La Ruina de los Sawuernizers**.


AT A GLANCE
---
* *Conocimiento Arcano*
 * (DC 11) revelará que Lord Gimion no puede actuar a la luz del Sol y que sólo puede ser dañado por armas mágicas.
* *Sabiduría*
 * (DC 6) permitirá calcular el tiempo que se tarda en abrir la tumba.
  * (DC 10) permitirá calcular el movimiento de las nubes y predecir qué zonas estarán iluminadas y cuales no en el siguiente turno.
* *Percepción*
 * (DC 22) revelará a cualquier jugador el hecho de que el símbolo de la Espada de Monak coincide con el del casco de Lord Gimion. 


CONCLUSION
---
Cuando los jugadores hayan logrado los dientes o eliminar a Lord Gimion pueden regresar a la Escuela.

Si los jugadores han ayudado a Bilwa cambio del Elixir de Verdad, pueden regresar a la Escuela para obtener el brebaje e interrogar a Doris y llegar a la [[Conclusión]]. 

Si los jugadores todavía no han conocido a Doris, pueden seguir con sus asuntos pendientes y [[Buscando culpables]]. 

images {./images/act-4/graveyard-portrait.jpg, ./images/maps/N1-8-graveyard-map.jpg, ./images/monsters/spectre-portrait.jpg}
music {nizgul-room.mp3}




</tw-passagedata><tw-passagedata pid="16" name="Conclusión" tags="encounter @conclusion" position="1499,785" size="100,100">
## INTERROGANDO A DORIS

Los jugadores regresan a la Escuela y la señorita Bilwa les hace entrega de un Elixir de Verdad a cambio de los dientes extraídos del Cementerio. Ahora, pueden interrogar a Doris. [El Elixir](SRD_Elixir_of_Truth-5.html) evita que el cambiaformas pueda mentir en sus respuestas. 

Doris sabe que su amo le contrató para abrir los portales. Le entregó unos pequeños discos dorados que debía colocar en lugares de la Escuela.
Doris es servidor del nigromante, pero no de la Madre de los Demonios, y no sabe nada respecto a los restos de Rajak. Sólo puede decir que su amo no quería que su trabajo en las Montañas del Invasor fuera interrumpido por las fuerzas de la ciudad.
Doris estaba en la posada esperando a que las cosas se tranquilizaran para abandonar la ciudad.


## LAS MONTAÑAS DEL INVASOR

&gt; El lugar que os ha indicado Doris se encuentra a un día de camino. El trayecto hasta el emplazamiento en Las Montañas del Invasor es desolador. La enorme nube de polvo que obligó a los aldeanos a abandonar sus hogares ha arrasado la zona. La vegetación ha muerto en su totalidad y es raro encontrarse con algún animal o escuchar el canto de los pájaros. Cada cierto tiempo encontráis un grupo de vacas o cabras muertas, asfixiadas hace días por el polvo y las cenizas en suspensión. Con el espíritu bajo os acercáis a vuestro destino.


La marcha continúa hasta que (muestra la ilustración):

&gt; Remontáis una colina sabiendo que desde la cima ya tendréis a la vista Las Montañas del Invasor. Esta anocheciendo y la cumbre de este monte sería un buen lugar para descansar, pero será difícil que ninguno de vosotros pegue ojo después de descubrir el escenario que observáis desde el alto: Una cabeza, del tamaño que tendría la de un titán, ha mellado brutalmente las montañas. La testa de un ser gigantesco, con los ojos ciegos y el rostro sereno, reposa sobre un inmenso cráter. A su vera, un campamento iluminado por antorchas reposa a la sombra del gigante.


AT A GLANCE
---
* Los jugadores que se hayan gastado al menos 1 punto en *Historia* tendrán acceso a la siguiente información:
  * Las Montañas del Invasor son una cordillera que separa la zona más civilizada del continente con el salvaje norte. 
* *Supervivencia* o *Conocimiento de la Naturaleza*
 * (DC 5) El polvo en suspensión que ha matado a los animales de la zona y dado al traste con las cosechas está compuesto del mismo tipo de rocas que las Montañas del Invasor. 

CONCLUSION
---
El próximo capítulo de DigitalD20 continuará en las Montañas del Invasor. [www.digitald20.com](https://digitald20.com/el-asedio-de-salorium/)


images {./images/monsters/doris-portrait.jpg ,./images/act-4/mountains.jpg, ./images/act-4/skull.jpg }
music {heroicdemise.mp3}
</tw-passagedata><tw-passagedata pid="17" name="Personajes" tags="index @personajes" position="379,726" size="100,100">
# PERSONAJES JUGADORES PREGENERADOS

## PÍCARO (Wilbur)

&lt;img src=&quot;./images/players/thief.jpg&quot; class=&quot;icons-left-medium&quot;&gt;Estas decidido. Este es tu último trabajo para Tommy ‘El tuerto’. Ya estas harto de jugarte el pellejo y no llevarte más que las migajas. Te has ganado con creces un mayor reconocimiento en la organización. Llevas desde los seis años trabajando para ‘El Tuerto’; primero como raterillo en las calles del mercado, cortando las bolsas a las despistadas amas de llaves que acudían a hacer la compra, luego como saqueador de barcos hundidos, buceando hasta las bodegas antes de que sus legítimos dueños pudieran reclamar la mercancía. Ahora eres un allanador y no estás dispuesto a que otro se lleve todo el beneficio de tus robos. Este es tu último trabajo para ‘El Tuerto’ y vas a despedirte por todo lo alto: Robando las cámaras de la Escuela de Magia de la Ciudad de Sâlorium.

**SECRETO**: Conoces todos los secretos de la Escuela ya que tienes un aliado infiltrado dentro. Tu amante Turanea, una aprendiz de mago a la que has embelesado y de la que te aprovechas para sonsacarla información sobre la Escuela. Además, te puede servir de cuartada en caso de que te atrapen robando la escuela. Siempre puedes alegar que eres un enamorado cegado por la pasión que ha entrado para verse con su amada y no un miserable ladrón que se ha aprovechado de una ingenua jovencita para dar el mayor golpe de su carrera.

Puedes descargar una versión imprimible de la ficha de personaje en www.digitald20.com o consultar la *Hoja de personaje de Wilbur*.

## MAGO (Yonsee)
&lt;img src=&quot;./images/players/mage.jpg&quot; class=&quot;icons-left-medium&quot;&gt;La Magia es maravillosa. Gracias a la Magia puedes volar, cambiar tu aspecto o lanzar una llameante bola de fuego que acabe con tus enemigos. La Magia es como tener todo el mazo de cartas y poder repartirte cinco ases en cada mano. Y tú quieres ser el mejor crupier. Por eso entraste en la escuela de Magia de Sâlorium, la mejor oportunidad a tu alcance para desentrañar los misterios de la hechicería. Llevas varios meses de arduo trabajo: diseccionando animales, experimentando con la alquimia y devorando tratados y pergaminos sobre todo tipo de disciplinas arcanas. Un mundo de infinitas posibilidades se abre ante ti, y no piensas desaprovecharlo.

**La realidad**: Procedes de un linaje corrupto, una maldición en tu sangre que te permite transformarte en un horrible ser parecido a una rata humanoide. Tus familiares lo ven como un don, pero tú nunca lo pediste. En cuanto fuiste capaz de valerte por ti mismo abandonaste el opresivo y endogámico clan en el que vivía tu familia y no volviste a mirar atrás. Tras dar tumbos por el mundo descubriste la magia y tal vez la forma de limpiar tu cuerpo del horrible secreto que ocultas. Mientras los demás estudiantes de la Escuela duermen, tú dedicas tus noches a investigar sobre los misterios de la licantropía y sus posibles curas con la esperanza de poder ser una persona normal.

Puedes descargar una versión imprimible de la ficha de personaje en www.digitald20.com o consultar la *Hoja de personaje de Yonsee*.


## GUERRERO (Monak)
&lt;img src=&quot;./images/players/fighter.jpg&quot; class=&quot;icons-left-medium&quot;&gt;Tu destino parecía estar escrito: Seguir los pasos de tu padre, y antes los del suyo, y convertirte en un granjero más de los que entierran su vida labrando las llanuras de Turil. Pero tú preferiste labrar tu propio camino. Hace menos de un año abandonaste tu pequeña aldea y, con un caballo de pelaje amarillo y la vieja espada de tu padre, llegaste a la ciudad de Sâlorium persiguiendo tu sueño: convertirte en uno de esos aventureros que recorren el mundo enfrentándose a los más increíbles desafíos en busca de fama y fortuna. Pero no todo es como lo cantan los bardos en los salones de las tabernas. Por el momento, tu buena forma física forjada en los campos de maíz de tu familia ha valido para encontrar un trabajo en la Guardia de la Escuela de Magia de Sâlorium. Es un trabajo razonablemente tranquilo y descansado, con una buena paga y una cama caliente, pero muy lejos de las antiguas tumbas repletas de tesoros con las que soñabas al abandonar tu pueblo.

**La realidad**: Repites tantas veces tu historia que has terminado por creértela. Tuviste que inventarla para responder a los curiosos que preguntaban por tu pasado. Así nació Monak y su común biografía: la de un joven que abandona su aldea para buscar fortuna por el ancho mundo. Tan vulgar que acaba con el interés de tu interlocutor y hace que no vuelva a interesarse por tu bagaje. Porque la realidad es mucho más inquietante.
La verdad es que no recuerdas nada de tu pasado. Solo sabes que despertaste hace unos meses en el claro de un bosque tumbado, en el centro de un cráter, con una espada de acero frío clavada en la tierra cerca de ti. Desnudo, desubicado y hambriento localizaste una granja de la que robaste algo de ropa y comida junto a un caballo y vagaste por las llanuras hasta llegar a la Ciudad de Sâlorium. Después de pasar un tiempo mendigando y robando por las calles aceptaste el empleo en la Escuela de Magia. Mientras intentas desentrañar el misterio que es tu vida. La única pista sobre tu pasado reside en el peculiar escudo de armas que decora la cruceta de tu espada. 

Puedes descargar una versión imprimible de la ficha de personaje en www.digitald20.com o consultar la *Hoja de personaje de Monak*.

## EXPLORADORA SEMI ELFA (Raghar)
&lt;img src=&quot;./images/players/explorer.jpg&quot; class=&quot;icons-left-medium&quot;&gt;Las tribus del Norte son un lugar salvaje para criarse, y más aún cuando eres mujer y tu madre una débil elfa tomada como botín de guerra por tu padre, un viejo caudillo que te trataba como una maldición de los dioses. Tu infancia como bastarda, a la sombra de tus hermanos humanos, sólo sirvió para aprender la mejor manera seguir rastros y cazar alimañas para llenar los pucheros de los repugnantes cocineros de tu tribu. Terminado tu entrenamiento, llegó el momento de enrolarte en las filas del ascendente caudillo de turno, en este caso uno de tus medio hermanos, que creía posible conquistar las tierras de las ciudades más civilizadas del Sur. Fue la primera y última campaña en la que participaste: una larga marcha de varios meses arrasando pequeñas poblaciones, llevando la muerte y la destrucción a los inocentes. Parecía que esta vez tu tribu podría reclamar un lugar más importante en el mundo hasta que la dura realidad os golpeó como el puño del dios Groak. La Horda recibió el fatal golpe a pocas leguas de la ciudad de Sâlorium. Una invencible fuerza compuesta por los ejércitos de todas las ciudades y reinos de la zona borró de un plumazo las aspiraciones de los tuyos que, a duras penas, pudieron escapar de la que ya se conoce como &#39;Sangría de los Salvajes&#39;. Tú no tuviste tanta suerte y acabaste como uno de los cientos de prisioneros condenados a trabajar como esclavo en las ciudades de los vencedores. Desde hace unos años sirves a la ciudad de Sâlorium como mula de carga en los pesados trabajos que nadie está dispuesto a realizar. Con la llegada de cientos de refugiados a la ciudad, has sido enviada a la Escuela de Magia para ayudar a levantar un campamento que cobije a los recién llegados. Tu trabajo consiste en cumplir las órdenes de tu capataz, ya sea colocando tiendas de campaña o limpiando las letrinas. Las noches las pasas junto a tus compañeros: ladrones, violadores y gente de la peor ralea que cumplen condena por sus delitos.

Puedes descargar una versión imprimible de la ficha de personaje en www.digitald20.com o consultar la *Hoja de personaje de Raghar*.

## SORCERER MEDIANO (Señor Pirs)
&lt;img src=&quot;./images/players/sorcerer.jpg&quot; class=&quot;icons-left-medium&quot;&gt;El señor Pirs es un visionario. El señor Pirs es un halfling sin igual. El señor Pirs destacó desde niño por encima de lo vulgar. El Señor Pirs posee dotes para la magia que asombrarán al mundo. El señor Pirs siempre se refiere a sí mismo en tercera persona. El Señor Pirs no ha nacido para mezclarse con el común de los mortales, ni las medianías que asolan con su estupidez, y su falta de buen gusto, este tosco mundo que, ciertamente, necesita ser metido en vereda. Allá donde el señor Pirs mira no observa más que incultura, malos modales, estupidez y chabacanería y cree, firmemente, que sólo su intervención podrá salvar a todos esos pobres desgraciados que se arrastran por el lodo de su desidiosa necedad durante lo que sus limitadas mentes consideran ‘la vida’. El señor Pirs salvará el mundo de sí mismo, pero ¡ay! por desgracia, en estos momentos se encuentra ocupado en asuntos más triviales. Parece ser que el señor Pirs olvidó pagar la factura de la pensión donde se alojaba. Por lo que dijeron los magistrados, el señor Pirs también había postergado ciertos pagos referentes a una bodega de vinos que había comprado y esquilmado. Por lo visto durante los juicios, el señor Pirs tampoco había encontrado tiempo para atender a cierta dama con la que se había comprometido y a la que no había vuelto a ver desde el día en que el padre de la doncella le entrego la dote por el futuro matrimonio. A pesar de las protestas, pataletas y amenazas del señor Pirs, que sólo le valieron para aumentar en un par de años su pena, los magistrados pensaron que al señor Pirs le vendría bien pasar los próximos cinco años reflexionando sobre sus actos mientras se empleaba para la ciudad en el programa de trabajos forzados. Así, el señor Pirs se encuentra actualmente junto a lo más granado de la sociedad de Sâlorium en el patio de la Escuela de Magia, donde por las mañanas ayuda a levantar un campamento para los refugiados que desde hace días llegan a la ciudad.

Puedes descargar una versión imprimible de la ficha de personaje en www.digitald20.com o consultar la *Hoja de personaje del Sr. Pirs*.

## SACERDOTE ELFO (Erendur)
&lt;img src=&quot;./images/players/cleric.jpg&quot; class=&quot;icons-left-medium&quot;&gt;Los de tu raza dejaron tiempo atrás este continente, demasiado peligroso  e incivilizado para los hijos de los Seldarine. Pero tú te quedaste. En tu interior sabías que abandonar estas tierras sólo serviría para que los enemigos de tu pueblo se hicieran más fuertes y en algún momento encontraran el valor suficiente para atacar vuestro refugio más allá de los mares. 
Has encomendado tu vida a la voluntad de los dioses y sabes que ofrecer paz y generosidad es la única forma de arrancar el odio del corazón de los mortales. Pero también sabes que hay veces en las que la única solución es la que viene dada por el duro y resistente acero élfico. Y no temes usarlo.
Tras varios meses recorriendo las tierras del Norte auxiliando a los necesitados, te has desplazado hasta la ciudad de Sâlorium donde participas en la atención a los cientos de refugiados que han llegado a la ciudad durante los últimos días. 

**LA REALIDAD**: Hace años formabas parte de un grupo secreto elfico dedicado a la investigación del culto que rinde culto a la Madre de los Demonios, una secta pequeña y esquiva que odia a los elfos. Tu equipo localizó uno de estos grupos de culto en un complejo de cuevas bajo una lejana cordillera. Recuerdas que entrasteis y os enfrentasteis a los cultistas allí escondidos, pero, en el fragor del combate, perdiste el conocimiento. Cuando despertaste, viste con horror como todos tus compañeros habían muerto y no había ni rastro de los cultistas. Desde entonces has dedicado tus esfuerzos a localizar y destruir a los seguidores de la Madre de los Demonios. 

¿Qué sabes del culto a la Madre de los demonios?
El nombre del culto sólo se escucha en voz baja a lo largo del Multiverso. Voces quedas, que susurran como los textos antiguos, afirman que la madre de los demonios dio a luz a los Señores que gobiernan el Abismo. Otras fuentes incluso van más allá, y se atreven a afirmar que toda la raza demoniaca desciende de ella. Pero no son más que murmullos que, oportunamente, son silenciados cuando algún descerebrado comete la insensatez de intentar aclarar el misterio que rodea a la llamada Madre de los Demonios. 
Hace mucho tiempo, gracias a la astucia y el engaño, la Madre de los Demonios manipuló al príncipe de los dioses elfos para que aceptara un terrible pacto. Como resultado del acuerdo, toda una generación de niños elfos quedó atrapada en la capa del abismo que gobierna la Madre de los Demonios. Esto permite a los sus siervos darles caza uno a uno en su tiempo libre por pura diversión. Desde entonces, la capa se ha convertido en un campo de batalla entre las fuerzas demoniacas y los celestiales que han venido a proteger a los jóvenes elfos, una batalla que ya dura milenios.

Puedes descargar una versión imprimible de la ficha de personaje en www.digitald20.com o consultar la *Hoja de personaje de Erendur*.


</tw-passagedata><tw-passagedata pid="18" name="Ataque a la Escuela" tags="encounter @ataque-escuela" position="423,345" size="100,100">
# ([75XP](SRD_XP-5.html)) SITUACIÓN

* Horda de *Bestias Fundidoras*  

Si utilizas los [ganchos](./encounter.html?param=2) para los personajes pre-generados, el ataque se produce con tres de los personajes dentro de la escuela (Yonse, Wilbur y Monak) y otros tres en el patio (Erundur, Raghar y el Señor Pirs). Es recomendable que ningún jugador comience en una habitación más al oeste de la sala 16, de esta forma se verá implicado en el ataque a la biblioteca. 

Si no utilizas los ganchos, lee los siguientes textos dependiendo de donde se encuentren los jugadores al inicio.

A los que empiecen como **prisioneros, refugiados o guardias en el Patio (1)**:

&gt; Anochece y tras unas pocas horas de descanso, un grito te despierta. De repente, un fogonazo de luz comienza a dibujar sobre el suelo un círculo de luz incandescente rodeado de símbolos arcanos. Al tiempo, un torbellino se forma sobre él. El aire comienza a girar frenéticamente arrastrando tiendas, barriles y todo tipo de herramientas que se encuentran cerca.

A los que comiencen en **la Biblioteca (4)**:

&gt; Tras un fogonazo de luz, en el centro de la biblioteca, comienza a dibujarse sobre el suelo un círculo de luz incandescente rodeado de símbolos arcanos, mientras un torbellino se forma sobre él. El aire comienza a girar frenéticamente, arrastrando pergaminos, libros pequeños y el polvo acumulado en el lugar. La fuerza del viento va en aumento y tumba dos enormes librerías que, con gran estruendo, se hacen añicos al caer al suelo.

A los que comiencen en cualquier **otro lugar de la Escuela**:

&gt; Escucháis gritos que parecen provenir del (Patio o Biblioteca, lo que esté más cerca de su localización). ¡Se está librando un temible combate! 

Las *Bestias Fundidoras* enviadas contra la Escuela de Magia salen de los portales que aparecen en la biblioteca y en el patio y tienen la misión de arrasar el recinto y todo lo que encuentren a su paso. Una vez hecho esto continuarán por la ciudad desatando el caos. La horda que surge de los portales es virtualmente infinita, el objetivo de los jugadores debe ser proteger y salvar la vida del mayor número posible de personas y llevarlas a un lugar seguro. Debe quedar claro para los jugadores que **no es posible que detengan el ataque**, ya que si se enfrentan a las hordas de demonios acabarán muriendo. Su prioridad es encontrar un refugio seguro.

Antes de que los portales se abran, Gramdum Elojia ha enviado a uno de sus hechiceros más competentes para lanzar un poderoso conjuro de *Disipar Magia* sobre la Escuela y desactivar así las protecciones que pudieran defender la Academia. Como resultado de este conjuro de carácter Épico, todas las antorchas de la Escuela quedarán desactivadas sumiendo al edificio en la más negra de las *oscuridades*. Los conjuros individuales que pudieran tener activos los jugadores se disiparán, a no ser que fueran lanzados por un personaje de nivel superior a 21. El mago responsable del conjuro se encuentra a las afueras de la ciudad y una vez cumplido su encargo regresa a las Montañas del Invasor. 

## Ataque en el patio

&gt; Cuando el torbellino desaparece, se revela ante vosotros una puerta de energía roja y crepitante de la que surgen, a gran velocidad, decenas de seres cuadrúpedos. Estos seres están cubiertos de punta a punta por una dura piel metalizada. El final de sus extremidades acaba en duras pezuñas que provocan chispas al chocar contra el suelo. Un par de cuernos retorcidos asoma desde su cráneo hasta la altura de la boca. Además, púas afiladas sobresalen de su espalda. Los monstruos se mueven a una velocidad increíble y arrasan todo a su paso, atacando y devastando aquello que tienen cerca. Su número es tan grande que muchos de ellos pasan por encima de sus compañeros, que mueren aplastados bajo el peso de sus aliados. Otros salen despedidos llevándose por delante cualquier cosa que encuentren en su caída. Si tuvieran un rostro humano diríais que están sonriendo.

Los prisioneros están atados a unos postes en mitad del patio y pueden aprovechar la confusión para soltar las cuerdas. Se pueden liberar trepando y deslizando el nudo fuera del poste (*Atletismo* DC 5) pueden trabajar en equipo y derribar el poste (*Fuerza* DC 10) o sencillamente soltarse de sus ataduras (*Destreza* DC 10). También pueden utilizar sus habilidades sociales para que algún refugiado les proporcione algún arma cortante para liberarse (*Persuasión* o *Intimidación* DC 7).  
Si ninguna de estas acciones tiene éxito, es posible que una Bestia Fundidora derribe el poste facilitándoles la escapada. 

Los miembros de la Escuela serán empujados por los invasores hacia la zona Este del patio, donde alumnos y maestros colocarán una serie de barricadas para evitar que las Bestias Fundidoras entren en el Templo. La misión de los demonios es aislar a la Escuela del pueblo por lo que atacarán sin piedad a aquellos que intenten huir de la Academia pero no a aquellos que se refugien en su interior. 

De camino a su refugio se pueden encontrar una o varias de estas situaciones a discreción del DM.

1d8 | Resultado 
--- | ---
1   | La Horda pasa por encima de un PJ y le derriba causándole 1d8 (salvación de destreza para mitad de daño).
2   | Unas Bestias Fundidoras están a punto de arrollar a dos niños refugiados. Empujarles fuera de peligro no requiere ninguna tirada, pero si una salvación de destreza (DC 6) para evitar que la horda arroye al personaje y reciba 1d8 puntos de daño. Además, quedará *derribado* y *aturdido* durante 1 round. 
3   | Ves a uno de los prisioneros que se han soltado robando a los muertos. El jugador puede intentar *intimidarle* para que respete a los muertos (DC 7) También puede [enfrentarse físicamente](./lugares.html?param=@npcs&amp;room=1) 
4   | El fuego de las hogueras se ha descontrolado y amenaza con propagarse. Los jugadores pueden intentar sofocarlo. 
5   | Los jugadores pueden ayudar a los [guardias](./lugares.html?param=@npcs&amp;room=6) a organizar la huida de los refugidados al interior de la escuela. Por ejemplo: pueden organizar a los guardias para que formen y protejan la puerta (*Persuasión* DC 7), organizar a la multitud para que pasen ordenadamente (*Intimidación* DC 10). 
6   | Te bloquea el paso un perro del infierno, puedes intentar enfrentarte o esquivarlo recibiendo un ataque de oportunidad. 
7   | Quedas atrapado en una multitud que huye y debes superar una tirada de *Fuerza* o *Sabiduría* para no caer al suelo y ser aplastado y recibir 1d6 pgs. 
8   | Una formación de guardias se está enfrentando a dos Bestias Fundidoras: parece una buena oportunidad para ayudarles. 

Si alguno de los personajes baja por debajo de 0 puntos de vida, puedes hacer que los [guardias](./lugares.html?param=@npcs&amp;room=6) le recogan y lo lleven dentro de la Escuela. 


### Saliendo por la puerta

En caso de que decidan salir de la Escuela por la puerta principal, las Bestias Fundidoras les atacarán brutalmente, no quieren que nadie pueda dar la alarma en el resto de la ciudad antes de que hayan terminado su trabajo aquí.
En el dudoso caso de que los jugadores lograrán escapar, las Bestias Fundidoras los perseguirán hasta hacerlos refugiarse en un edificio cercano: una [[Torre de Vigilancia]] donde los jugadores pueden hacerse fuertes y resistir. Varios enemigos se quedarán en el exterior a la espera de que salgan. 

## Ataque en el interior de la Escuela

El portal del que surgen las bestias fundidoras se abre en la Biblioteca donde se encuentran Wilbur y Monak. 
Yonsee está en su habitación cerca de la Biblioteca y el estruendo que surge de allí le ha despertado. 

&gt; Cuando el torbellino desaparece, se revela ante vosotros una puerta de energía roja y crepitante de la que surgen, a gran velocidad, decenas de seres cuadrúpedos. Estos seres están cubiertos de punta a punta por una dura piel metalizada. El final de sus extremidades acaba en duras pezuñas que provocan chispas al chocar contra el suelo. Un par de cuernos retorcidos asoma desde su cráneo hasta la altura de la boca. Además, púas afiladas sobresalen de su espalda. Los monstruos se mueven a una velocidad increíble y arrasan todo a su paso, atacando y devastando aquello que tienen cerca. Su número es tan grande que muchos de ellos pasan por encima de sus compañeros, que mueren aplastados bajo el peso de sus aliados. Otros salen despedidos llevándose por delante cualquier cosa que encuentren en su caída. Si tuvieran un rostro humano diríais que están sonriendo.

En la Biblioteca tiene las siguientes opciones:
* Pueden aprovechar la oportunidad de lanzar las estanterías de la biblioteca sobre las bestias fundidoras, lo que les causará daño y además retrasará su avance dos turnos. (*Fuerza* DC 17)
* Pueden *Sigilo* (Bonificación +4 vs *Percepción* +2) y esperar a que terminen de salir las Bestias Fundidoras (10 turnos). En este caso, para llegar a una zona segura tendrán que enfrentarse a los enemigos que se queden por los pasillos, o bien encontrar la puerta secreta que comunica con los [[Subterráneos]]. 
* Huir por delante de los monstruos requiere que los jugadores  esprinten hasta una zona segura.
* Si los personajes tienen muchos problemas el Maestro Nizgul saldrá de su habitación y ayudará a que los personajes se retiren a un lugar seguro. 

En la Biblioteca se pueden dar las siguientes situaciones.

1d4 | Resultado 
--- | ---
1   | Te bloquea el paso un bestia fundidora, puedes intentar enfrentarte o evadirlo recibiendo un ataque de oportunidad. 
2   | Uno de las bestias fundidoras derriba una estantería sobre un jugador dejándolo atrapado en caso de que no supere una tirada de salvación de destreza (DC 10). Si queda atrapado, estará *derribado* y deberá usar un turno completo para liberarse. 
3   | Unos [estudiantes](./lugares.html?param=@npcs&amp;room=2) entran a la Biblioteca y se enfrentan a las Bestias Fundidoras ayudando a los personajes. 
4   |  Uno de los [estudiantes,](./lugares.html?param=@npcs&amp;room=3) Rufi &#39;el mago&#39;, llega a la Biblioteca y entra en pánico al ver a los monstruos. Empieza a sacar pergaminos de un estuche y a leerlos indiscriminadamente afectando tanto a enemigos como jugadores. Debe pasar la tirada de Spellcraft correspondiente para que el conjuro tenga efecto. &lt;div style=&quot;padding:2%;&quot;&gt;**Tira 1d6:** &lt;br&gt; 1- *Confusion*, &lt;br&gt; 2-*Luz de día*, &lt;br&gt; 3-*Bola de Fuego* (solo sobre los monstruos), &lt;br&gt; 4-*Invisibilidad*, &lt;br&gt; 5-*Grasa*, &lt;br&gt; 6-*Invertir gravedad*.&lt;/div&gt;


### En los pasillos

Dos turnos después de que se abran los portales, los pasillos se llenarán de Bestias Fundidoras procedentes de la Biblioteca. Entre el turno 3 y el 10, la horda es arrolladora y no hay posibilidad de avanzar ni enfrentarse a ella, por lo que es necesario refugiarse en alguna habitación hasta al menos el turno 10. También pueden intentar escapar por los [[Subterráneos]].

La horda empuja a los jugadores que se encuentren en El Patio y la Biblioteca hacia el Templo. Si los jugadores se encuentran en algún otro lugar del interior de la Escuela, pueden refugiarse donde estimen oportuno pero el único lugar verdaderamente seguro seguirá siendo el Templo. 

Una vez que la mayoría de las Bestias Fundidoras ha abandonado la Escuela, se pueden recorrer los pasillos enfrentándose a los monstruos que han quedado a discreción del Master, ver [[Buscando culpables]].  


AT A GLANCE
---
* *Detectar magia*:
 * El portal por el que entran los demonios desprende magia. 
* *Conocimiento Arcano* / *Religión*: No está al alcance de unos jugadores de nivel 1. 
  * (DC 40) Son bestias fundidoras.
* *Detectar el bien y el mal*: 
 * Los demonios son caóticos malvados. 
* *Percepción* en el Patio: 
 * (DC 5) Unos niños están a punto de ser aplastados por los demonios. 
 * (DC 10) Ves la posibilidad de parar el avance de los demonitos derribando un andamio.
 * (DC 10) Se ha provocado un incendio que amenaza los edificios.
 * (DC 15) Escuchas los gritos de socorro de los prisioneros atados.
* *Inteligencia* en la Biblioteca: 
 * (DC 10) Ves la posibilidad de parar el avance de los demonitos derribando unas estanterías.
 

* Además, ten en cuenta las [características generales](../lugares.html?param=@caracteristicas&amp;room=0) de la Escuela. 

CONCLUSION
---
El combate debería terminar con los jugadores y el resto de supervivientes de la Escuela refugiados en las zonas no invadidas. Ahora llega el momento de hacer recuento de bajas, organizar la resistencia y decidir los próximos pasos.

Los jugadores continuarán probablemente [[Buscando culpables]]

images {./images/act-1/playground.jpg, ./maps/mschool-es.html, ./images/act-1/library.jpg}
music {school-under-attack.mp3}

</tw-passagedata><tw-passagedata pid="19" name="Torre de Vigilancia" tags="encounter @torre-vigilancia" position="572,457" size="100,100">
# ([75XP](SRD_XP-5.html)) DESPLIEGUE

La Torre de la Guardia es el edificio más cercano a la Escuela de Magia y se encuentra comunicada con la Academia a través de **un túnel** que da a parar a los Barracones de la Guardia (sala 30)

Los jugadores pueden llegar a la Torre en momentos diferentes de la Aventura:

* Durante el primer ataque de las *Bestias Fundidoras*, si los jugadores optan por huir de la Escuela este será el único edificio que encuentren antes de que la horda los de alcance. Pueden refugiarse en su interior y esperar a que los atacantes pasen de largo. Para regresar a la Escuela, deben encontrar el túnel que comunica la torre con la habitación 30 o volver por donde habían huido hasta el [[Patio de Armas]]. Dentro de la Escuela, utiliza el mapa y esta tabla de encuentros dependiendo del tiempo que haya pasado desde el inicio del ataque:

nºturnos | % Encuentro
---      | ---
1-3      | 90% por habitación, 1d3 bestias fundidoras
4-10     | 50% por habitación, 1d2 bestias fundidoras
11-15    | 25% por habitación, 1d2 bestias fundidoras
16+      | 5% por habitación, 1 bestia fundidora


* Los personajes también pueden llegar a la Torre desde el interior de la Academia, usando el túnel que comunica con la sala 30, como medio para abandonar la Escuela y salir a la ciudad.

Los personajes pueden encontrar en la Torre todo tipo de armas no exóticas que puedan necesitar, así como equipo básico.


AT A GLANCE
---
* *Percepción*
 * (DC 9) Descubres un túnel que comunica con [[Subterráneos]] de la Escuela


* Además, ten en cuenta las [características generales](../lugares.html?param=@caracteristicas&amp;room=0) de la Escuela.  

CONCLUSION
---
Desde la Torre, los jugadores pueden ir a [[Buscando culpables]] o [[Buscando a Doris]] 

images {./images/monsters/hellhound.jpg, ./images/maps/tower-map.jpg, ./maps/mschool-es.html}
music {playground.mp3}


</tw-passagedata><tw-passagedata pid="20" name="Encerrados" tags="encounter @encerrados" position="721,753" size="100,100">
# ([100 XP](SRD_XP-5.html)) DESPLIEGUE

* 3 *Bestias Fundidoras*

Si los personajes se dirigen a través de la Escuela hacia la habitación donde los aprendices están atrapados, encontrarán a tres Bestias Fundidoras acechando en el pasillo que comunica las habitaciones 30, 31 y 32. Si atraviesan el Patio de Armas (1) y entran en la habitación del Sargento Menzal (32) gracias a medios mágicos, podrán evitar el encuentro.

Lee a los jugadores lo siguiente cuando estén en el pasillo:

&gt; Ni una gota de luz ilumina este largo pasillo. Lo único que revela vida en la zona son unos incesantes golpetazos desde el fondo que hacen retumbar todas las paredes. De repente el ruido cesa y todo queda tranquilo, como si el tiempo se hubiera detenido

# TÁCTICAS
Los golpes los producen dos Bestias Fundidoras envistiendo la puerta de la habitación del Sargento Menzal (32). Cuando los jugadores se acerquen a la casilla marcada en el mapa con una X, los monstruos detectan las vibraciones de sus pasos y detienen sus embestidas, preparándose para atacar. La tercera Bestia Fundidora, en la sala 31, esperará un turno después de iniciado el combate para actuar e intentar pillar desprevenidos a los jugadores por el flanco que más daño pueda hacer.

# TERRENO
El lugar se encuentra en *oscuridad total*.

## LA HABITACIÓN DEL SARGENTO MENZAL
La habitación del sargento de la guardia es un sencillo y pulcro dormitorio.

Una vez en el interior de la habitación 32, los jugadores pueden liberar a los aprendices. Están todavía vivos, así como el matrimonio de cocineros, pero la mayoría está en un estado muy crítico. 

Si registran la habitación, una tirada de *Investigación* (DC 11) revelará un doble fondo en el baúl. Dentro hay una caja de metal con una cerradura *Destreza* (DC 16). En el interior se encuentran 200 monedas de oro y los títulos de propiedad de una hacienda al sur del continente recientemente adquirida por el Sargento Menzal. Envuelto en un trapito de terciopelo hay una llave: se trata de una copia de la llave maestra del Maestro Lormam con la que se pueden abrir todas las puertas de la Escuela. Hace tiempo, Menzal se hizo con la llave y desde entonces ha ido sacando pequeñas cantidades de dinero de la Cámara del Tesoro. Gracias a estos “ingresos extra” ha logrado juntar el dinero para comprar una granja donde retirarse.

## REGRESO AL TEMPLO

Si los jugadores regresan al Templo por el interior de la Escuela, una vez que dejen atrás la Galería de los Espíritus (15), y entren el pasillo donde están las entradas al Templo (3) lee esto:

&gt; Precedidas por un temblor y un ruido ensordecedor, decenas de Bestias Fundidoras provenientes del Portal de la Biblioteca intentan salir agolpándose unos contra otros, chocando entre ellos y contra las paredes para daros caza. Se entorpecen la carrera entre ellos mismos formando un tapón unos con otros; se pisotean o salen despedidos en un caos de gruñidos. Los que logran salir, corren tras vosotros.

Los jugadores deberán correr por el pasillo hasta llegar al Templo. No dejes que se enfrenten a la horda, pues es una muerte segura. La situación simplemente debe servir para que los jugadores sigan siendo conscientes del peligro que supone deambular por los pasillos de la Escuela.

Si los jugadores regresan al Templo (2) por el Patio de la Escuela (1), una vez lleguen a la puerta del santuario, lee esto:

&gt; Precedidas por un temblor y un ruido ensordecedor, decenas de Bestias Fundidoras provenientes del portal del Patio intentan salir agolpándose unos contra otros y chocando entre ellos. Se entorpecen la salida entre ellos mismos formando un tapón unos con otros; se pisotean o salen despedidos en un caos de gruñidos. Los que logran salir, corren tras vosotros.

Una vez en el interior del Templo, lee lo siguiente:

&gt; Los guardias cierran la puerta detrás de vosotros antes de que algún monstruo logre introducirse en el Templo. Con un suspiro de alivio os dejáis caer rendidos tras el esfuerzo y con la satisfacción de haber logrado salvar un buen número de vidas, pero rápidamente os invade la inquietud de lo poco que ha faltado para que los monstruos acabaran con vuestras vidas. 

AT A GLANCE
---
* *Percepción* (DC 12):
 * Escuchas la respiración de una Bestia Fundidora en la habitación 30. 
* *Detectar magia*:
 * Nada desprende magia. 
* *Detectar el bien y el mal*: 
 * Los demonios son caóticos malvados.  

* Además, ten en cuenta las [características generales](../lugares.html?param=@caracteristicas&amp;room=0) de la Escuela.  

CONCLUSION
---
Una vez terminado el encuentro, lee la sección de regreso al templo, después podrán continuar [[Buscando culpables]] 

images {./images/act-2/kitchen.jpg, ./images/monsters/hellhound.jpg, ./images/maps/kitchen-map.jpg}
music {playground.mp3}

</tw-passagedata><tw-passagedata pid="21" name="Main-index" tags="index @index-main" position="94,72" size="100,100"> 
# INDICE
* [Bienvenido a DD20](./index.html?param=@bienvenido)
* [El asedio de Sâlorium](./index.html?param=@resumen)
  * [Personajes Pre-generados](./index.html?param=@personajes)
  * [Comienza la Aventura](./encounter.html?param=@comienza-aventura)
* ACTO I: [Ataque a la Escuela](./encounter.html?param=@ataque-escuela)
  * [La torre de vigilancia](./encounter.html?param=@torre-vigilancia)
* ACTO II: [Buscando a los culpables](./encounter.html?param=@buscando-culpables)
  * [Patio de Armas](./encounter.html?param=@patio-armas)
  * [Alumnos Encerrados](./encounter.html?param=@encerrados)
  * [La Biblioteca](./encounter.html?param=@biblioteca)
  * [Aposentos de Glaucom](./encounter.html?param=@glaucom)
  * [Robando la cámara del tesoro](./encounter.html?param=@tesoro)
* ACTO III: [Buscando a Doris](./encounter.html?param=@saliendo-exterior)
  * [Subterráneos](./encounter.html?param=@dungeon)
  * [La plaza del pueblo](./encounter.html?param=@plaza-pueblo)
  * [La Ballena Blanca](./encounter.html?param=@ballena-blanca)
  * [Un prisionero en la Escuela](./encounter.html?param=@prisionero)
* ACTO IV: [Buscando Huesos](./encounter.html?param=@buscando-huesos)
  * [El maestro Nizgul](./encounter.html?param=@nizgul)
  * [En el cementerio](./encounter.html?param=@cementerio)
* [CONCLUSIÓN](./encounter.html?param=@conclusion)
* ANEXOS
 * [Entregables](./index.html?param=@mapas) 
</tw-passagedata><tw-passagedata pid="22" name="Maestros de la Escuela de Magia" tags="index @maestros @main-npcs" position="249,727" size="100,100">
# MAESTROS DE LA ESCUELA

## Maestro Lorman (director de la escuela)
![medium](./images/magisters/lorman.jpg)

El Maestro Lorman dirige esta institución con mano de hierro. Es un hombre regordete de rostro afable que oculta un carácter férreo. No tolera las bromas y es recto como su vara, que no duda en emplear contra los alumnos menos aplicados.

### Donde encontrarle
El Maestro Lorman está descansando en su habitación antes del ataque a la Escuela. Después se le puede encontrar en la Cripta del Templo junto al resto de supervivientes. No es probable que abandone esta ubicación.

### Ficha
El maestro Lorman es un mago de nivel 12. 
	

## Maestro Nizgul (experto en Nigromancia)
![medium](./images/magisters/nizgul.jpg)

El Maestro Nizgul es un tipo huraño y reservado que vive en el laboratorio situado en el sótano bajo la Biblioteca. Imparte las clases justas para no ser despedido y pasa la mayor parte del tiempo al margen de la vida de la Escuela encerrado en sus aposentos. Es un hombre menudo con la tez de porcelana y el rostro tatuado por extraños símbolos, lo que le proporciona un aspecto desasosegante.


### Donde encontrarle
Durante el ataque a la Escuela, Nizgul se encuentra en su laboratorio enfrascado en sus investigaciones. Saldrá de sus aposentos para enfrentarse a los asaltantes y perecerá en la Biblioteca luchando contra las Bestias Fundidoras.

### Ficha
El maestro Nizgul está muerto. 


## Señorita Bilwa (experta en pociones)
![medium](./images/magisters/bilwa.jpg)

La señorita Bilwa es una coqueta mujer que imparte conocimientos sobre pociones y elixires. Es abierta y simpática. Se rumorea que mantiene varios romances con algunos de los hombres de la guardia. Desdeña abiertamente al Maestro Nizgul al que públicamente llama ‘El imbécil’.


### Donde encontrarle
Bilwa está durmiendo entre sus sábanas de seda cuando las Bestias Fundidoras atacan la Escuela. Saldrá de su habitación y se refugiará en la Cripta del Templo junto a los demás supervivientes. Después, se la puede encontrar en el Laboratorio de Nizgul.

### Ficha
La señorita Bilwa es una maga de nivel 15.  

## Maestro Glaucom (experto en portales)
![medium](./images/magisters/glaucom.jpg)

El Maestro Glaucom es un viejo inválido que necesita de muletas para poder desplazarse. Las lenguas más viperinas dicen que la razón que le llevó a interesarse por el estudio de los portales fue para encontrar medios de desplazarse a pesar de su incapacidad. Su rostro está demacrado por el paso de los años y siempre viste ropas acolchadas que le protegen de eventuales caídas en caso de que sus muletas le fallen.


### Donde encontrarle
Glaucom lleva días muerto y su cadáver reposa en la cama de su habitación.

### Ficha
El maestro Glaucom está muerto. 

## Maestro Roniam (bibliotecario de la escuela)
![medium](./images/magisters/roniam.jpg)

El Maestro Roniam es el bibliotecario de la Escuela. Es un anciano despistado que siempre parece ausente, excepto para todo lo relacionado con el control y organización de los miles de volúmenes y pergaminos que componen la Gran Biblioteca. Es un empedernido fumador de pipa, costumbre que le ha provocado más de un disgusto cuando algo de ceniza ha caído sobre uno de sus preciados pergaminos.


### Donde encontrarle
Roniam está repasando los ficheros de la Sala de Mapas cuando se produce el ataque y corre todo lo rápido que su edad le permite a refugiarse en la cripta del Templo, donde se le puede encontrar durante el transcurso de la aventura.

### Ficha
El maestro Roniam es un mago de nivel 11.

## Sargento Menzal (jefe de la guardia)
![medium](./images/magisters/menzal.jpg)

El sargento Menzal es un veterano de guerra que ha encontrado su retiro como responsable de la seguridad de la Escuela de Magia. Es un hombre tiránico y mal encarado que gusta de emborracharse y dar palizas a sus subalternos. A pesar de su carácter violento, el director de la Escuela le permite seguir en su puesto ya que sus conocimientos militares compensan su airada personalidad. Menzal es un hombre intimidante de casi dos metros, en muy buena forma física para su edad y es raro verlo sin su pesada armadura.


### Donde encontrarle
Durante el ataque a la Escuela, Menzal está en su habitación durmiendo. Rápidamente se unirá a sus hombres en los Barracones de la Guardia e intentará organizar la defensa de la Academia. Al verse superado por las Bestias Fundidoras, ayudará a la evacuación de los supervivientes a la cripta del Templo, donde él también se refugiará durante el resto de la Aventura.

### Ficha
El Sargento Menzal es un guerrero de nivel 12. 

## Doris (cambiaformas)
![medium](./images/magisters/doris.jpg)

Doris es un mercenario cambiaformas que trabaja para el mejor postor. No le importa nadie que no sea él mismo, pero es un gran profesional y siempre cumple su parte del trato. 


### Donde encontrarle
Tras el ataque a la Escuela, Doris se esconde en la posada &#39;La Ballena Blanca&#39;.

### Ficha
*Monstruosidad mediana (cambiaformas), caótico neutral*
_____________________________________________
**Armadura** 14  
**Puntos de golpe** 52 (8d8 + 16)  
**Velocidad** 30 
_____________________________________________
|FUE|DES|CON|INT|SAB|CAR|
|:---:|:---:|:---:|:---:|:---:|:---:|
|11 (+0)|18 (+4)|14 (+2)|11 (+0)|12 (+1)|14 (+2)|
_____________________________________________
**Habilidades** Engaño +6, Perspicacia +3  
**Inmunidad a condiciones** encantado  
**Sentidos** Visión en la oscuridad 60 ft., Percepción pasiva 11  
**Idiomas** Común  
**Desafío** 3 (700 XP)  
_____________________________________________
***Cambiaformas.*** El doppelganger puede usar esta accion para transformarse en una criatura pequeña o mediana que haya visto, o volver a su auténtica forma. Sus estadísticas, aparte de su tamaño, son las mismas en cualquier forma. Cualquier equipo que porte o lleve no es transformado. Revierte a su auténtica forma si muere.  
***Emboscador.*** En su primer turno de combate, el doppelganger tiene ventaja en sus tiradas de ataque contra cualquier criatura que haya sido sorprendida.  
***Ataque por sorpresa.*** Si el doppelganger sorprende a una criatura y la impacta con un ataque durante el primer turno de combate, el objetivo recibe 10 (3d6) puntos de daño extra.  
### Acciones  
***Ataque múltiple.*** El doppelganger realiza dos ataques cuerpo a cuerpo.  
***Manotazo.*** *Ataque cuerpo a cuerpo:* +6 para impactar, alcance 5 ft., un objetivo. *Daño:* 7 (1d6 + 4) Daño contundente.  
***Leer pensamientos.*** El doppelganger lee mágicamente la los pensamientos superficiales de una criatura en un rango de 60 pies a su alrededor. Este efecto puede atravesar barreras, pero tres pies de madera o tierra, dos pies de piedra, dos pulgadas de metal o una fina capa de plomo puede bloquearlo. Mientras el objetivo esté dentro del rango, el doppelganger puede continuar leyendo sus pensamientos, siempre y cuando su concentración no se vea interrumpida (como si estuviera concentrándose en un conjuro).Mientras lee la mente del objetivo, el doppelganger tiene ventaja en sus pruebas de Sabiduría (Perspicacia) y Carisma (Engaño, Intimidación y Persuasión) contra el objetivo.  
_____________________________________________
Los Doppelgangers son astutos cambiaformas que toman la apariencia de otros humanoides, lanzándose en la persecución de presas atraidas por su habilidad de engaño. Pocas criaturas desprenden tanto miedo y desconfianza como los doppelgangers. Encontrados en toda tierra y cultura, pueden adoptar el rol de cualquier individuo de cualquier raza.  
***Robando secretos.*** La forma adoptada por un doppelganger le permite infiltrarse en casi cualquier grupo o comunidad, pero esta transformación no enseña idiomas, manierismos, recuerdos o personalidad. Los doppelgangers suelen seguir o capturar criaturas que tratan de copiar, estudiándolas y hurgando en sus mentes en busca de secretos. Un doppelganger puede leer los pensamientos superficiales de una criatura, pudiendo conocer su nombre, deseos y miedos, además de algunos recuerdos sueltos. Un doppelganger personalizando una criatura específica como parte de un plan a largo plazo puede mantener esta doble vida durante semanas, inspeccionando la mente de la vida a diario para aprender cómo comportarse y hablar de forma apropiada.  
***Estafadores hedonistas.*** Los doppelgangers trabajan en solitario o en pequeños grupos, con roles que cambian en cada caso. Mientras un toma el papel de un mercader o noble asesinado, los demás adquieren un numero de identidades que las circunstancias requieran, jugando partes de la familia o sirvientes mientras viven de las riquezas de la víctima.  
***Cambiantes.*** Los doppelgangers son demasiado vagos y egoístas como para criar a los suyos. Asumen el aspecto de alguna forma masculina atractiva y seducen mujeres, dejando que ellas críen a su progenie. Un niño doppelganger parece un miembro normal de la especie de su madre hasta que alcanza la adolescencia, momento en el cual descubre su verdadera naturaleza y es guiado a encontrar a los suyos y unirse a ellos.

## Lord Gimion (Espectro)
![medium](./images/magisters/spectre.jpg)

*Lord Gimion* es un antiguio caballero cuya vida después de la muerte fue consagrada por sacerdotes a la protección de los finados. No permite que nadie irrumpa el sueño de los muertos y atacará a aquellos que con sus actos mancillen el suelo sagrado.


### Donde encontrarle
*Lord Gimion* puede ser encontrado en [[El cementerio]].

### Ficha
*No-muerto mediano, neutral malvado*
_____________________________________________
**Armadura** 13  
**Puntos de golpe** 67 (9d8 + 27)  
**Velocidad** 0 ft., fly 60 ft. (flotar)
_____________________________________________
|FUE|DES|CON|INT|SAB|CAR|
|:---:|:---:|:---:|:---:|:---:|:---:|
|6 (-2)|16 (+3)|16 (+3)|12 (+1)|14 (+2)|15 (+2)|
_____________________________________________
**Resistencia al daño** acido, frío, fuego, relámpago, trueno; contundente, penetrante, y cortante de ataques no mágicos que no estén hechos con armas de plata  
**Inmunidades al daño** necrotico, veneno  
**Inmunidad a condiciones** encantado, exhausto, apresado, paralizado, petrificado, envenenado, derribado, ralentizado  
**Sentidos** Vision en la oscuridad 60 ft., Percepcion pasiva 12  
**Idiomas** Común, élfico  
**Desafío** 5 (1,800 XP)  
_____________________________________________
***Movimiento incorpóreo.*** La Aparición puede moverse a través de otras criaturas y objetos como si fueran terrenos difíciles. Recibe 5 (1d10) de daño de fuerza si termina su turno dentro de un objeto.  
***Sensibilidad a la luz solar.*** Mientras está bajo la luz del sol, la Aparición tiene desventaja en las tiradas de ataque, así como en los controles de Sabiduría (Percepción) que dependen de la vista.  
### Acciones  
***Robo de vida.*** *Ataque cuerpo a cuerpo:* +6, alcance 5 ft., un objetivo. *Hit:* 21 (4d8 + 3) daño necrótico. El objetivo debe tener éxito en una tirada de salvación de Constitución de CD 14 o sus puntos de golpe máximos se reducen en una cantidad igual al daño recibido. Esta reducción dura hasta que el objetivo finaliza un descanso largo. El objetivo muere si este efecto reduce sus puntos de golpe máximos a 0.  
***Crear espectro.*** La toma como objetivo a un humanoide a 10 pies de distancia de ella que lleve muerto no más de 1 minuto y haya muerto violentamente. El espíritu del objetivo se eleva como un [espectro](https://www.dandwiki.com/wiki/5e_SRD:Specter &quot;5e SRD:Specter&quot;) en el espacio de su cadáver o en el espacio desocupado más cercano. El espectro está bajo el control de la Aparición. La Aparición no puede tener más de siete espectros bajo su control al mismo tiempo.
_____________________________________________
Una Aparición es pura malicia encarnada, concentrada en una forma incorpórea que busca apagar toda la vida. La criatura está llena de energía negativa, y su mero paso por el mundo deja a las plantas cercanas ennegrecidas y marchitas. Los animales huyen de su presencia. Incluso los incendios pequeños pueden extinguirse por el olvido de la horrible existencia de la Aparición.  
***Horrible olvido.*** Cuando un humanoide mortal vive una vida degradada o entra en un pacto diabólico, entrega su alma a la condenación eterna en los planos inferiores. Sin embargo, a veces el alma se llena tanto de energía negativa que colapsa sobre sí misma y deja de existir en el instante antes de que pueda mudarse a una horrible vida después de la muerte. Cuando esto ocurre, el espíritu se convierte en una Aparición sin alma, un vacío malévolo atrapado en el avión donde murió. Casi nada de la existencia anterior de la Aparición se conserva; en esta nueva forma, existe solo para aniquilar otra vida.  
***Desprovisto de cuerpo.*** Una Aparición puede moverse a través de criaturas sólidas y objetos tan fácilmente como una criatura mortal se mueve a través de la niebla.  
Una Aparición podría retener algunos recuerdos de su vida mortal como ecos sombríos. Sin embargo, incluso los eventos más fuertes y las emociones se convierten en poco más que débiles impresiones, fugaces como sueños medio recordados. Una Aparición podría hacer una pausa para mirar algo que le fascinaba en la vida, o podría frenar su ira en reconocimiento de una amistad pasada. Sin embargo, estos momentos rara vez ocurren, porque la mayoría de las Apariciones desprecian lo que eran como un recordatorio de lo que se han convertido.  
***Comandantes no-muertos.*** Una Aparición puede crear un sirviente no muerto en el espíritu de una criatura humanoide que recientemente ha sufrido una muerte violenta. Tal fragmento de aflicción se convierte en un espectro, a pesar de todo lo que vive.  
Las apariciones a veces gobiernan las legiones de los muertos, conspirando el destino de las criaturas vivientes. Cuando salen de sus tumbas para luchar, la vida y la esperanza se marchitan ante ellos. Incluso si los ejércitos de una Aparición se ven obligados a retirarse, las tierras que ocupan sus fuerzas están tan arruinadas y marchitas que los que viven allí a menudo mueren de hambre y mueren.  
***Naturaleza no-muerta.*** Una Aparición no requiere aire, comida, bebida o dormir.</tw-passagedata><tw-passagedata pid="23" name="Tutorial" tags="tutorial" position="225,75" size="100,100">Tutorial 1/5&lt;hr&gt;
En todo momento estará disponible el menú de índice. Que te permitirá acceder a los contenidos por un índice de texto, por localizaciones, por personajes o por un diagrama temporal.
$

Tutorial 2/5&lt;hr&gt;
Siempre puedes hacer scroll en lado derecho e izquierdo de la pantalla
$

Tutorial 3/5&lt;hr&gt;
Puedes hacer clic en cualquier título del índice o en cualquier palabra del texto marcada en rojo. Te llevará a la escena o evento relevante.
$

Tutorial 4/5&lt;hr&gt;
En las páginas de encuentro. Tendrás siempre tres pestañas &#39;at glance&#39;, &#39;body&#39; y &#39;conclusion&#39; además de los iconos con las imágenes relevantes.
$

Tutorial 5/5&lt;hr&gt;
Algunos enlaces no te llevarán a otra localización si no que te mostrarán información relevante en lado izquierdo. Puedes hacer clic en cualquier enlace rojo, en realidad tienes el manual entero a tu disposición.
$
</tw-passagedata><tw-passagedata pid="24" name="Localizaciones Escuela" tags="lugares @escuela-map" position="378,597" size="100,100">
# El Patio Sur (1)
El gran patio de la Escuela ha sido utilizado como zona para acoger a los refugiados que han llegado a Sâlorium. Decenas de tiendas de campaña invaden la explanada. Un viejo establo sin caballos es la única estructura construida en el descampado. En el Patio también se encuentra un poste al que atan a los prisioneros y el pozo que sirve para proporcionar agua a la Escuela.

# El Templo de la Magia (2)
Este templo está dedicado a la Diosa de la Magia. Cada mañana, un sacerdote acude desde la ciudad para oficiar una ceremonia a la que asisten maestros y profesores. 

El templo contiene cinco estatuas, una tirada de *Religión* (DC 5) revela que cuatro de ellas, las que se encuentran a lo largo de las paredes, representan a servidores menores de la Diosa de la Magia. La quinta, tras el Altar es una efigie humanizada de la Deidad. Esta última escultura está tirada sobre el suelo, hecha pedazos. 

El Templo antes del ataque:

&gt; Este frio templo dedicado a la Diosa de la Magia es un lugar tranquilo y silencioso, envuelto en un intenso olor a algún tipo de resina aromática. La luz de las antorchas rebota contra las cuatro estatuas colocadas a lo largo de las paredes proyectando retorcidas sombras sobre las losas del suelo. Dos incensarios apagados flanquean un altar esculpido a partir de una única roca. Una quinta estatua, más grande que las otras, yace hecha añicos al fondo de la capilla. Una escalera en la esquina sureste se adentra en la tierra

# Pasillo de la Biblioteca (3)
&gt; Un largo pasillo comunica el Templo con el resto de la Escuela. Tres robustas puertas de madera dan acceso al santuario dedicado a la Diosa de la Magia.

# La Biblioteca (4)
La Gran Biblioteca es el corazón de la Escuela. Miles de libros contienen el saber recopilado a lo largo de los años por los habitantes de la Academia. El único objeto mágico que se puede hallar en el lugar es un Pedestal de Lectura situado en la esquina cercana al archivo de la Biblioteca. Un personaje con el tiempo suficiente puede encontrar prácticamente cualquier información académica que le interese.  

Buscar sin un índice es complicado, los jugadores pueden localizar cualquier libro que les pueda interesar superando una tirada de *Investigación* (DC 12). Estas referencias les podrán proporcionar un bono de +6 a cualquier tirada de conocimiento. 

# El Observatorio (5)
Esta sala circular sirve de observatorio astronómico. Una apertura en el techo permite ver el cielo mediante un telescopio situado bajo la abertura.

&gt; Un enorme telescopio de cobre preside el centro de esta estancia circular mientras que un vano en el techo de la sala permite ver el cielo abierto sobre la Escuela. De las paredes cuelgan cartas astronómicas y una mesa de caoba contiene numerosos papeles con apuntes sobre constelaciones, estudios sobre la rotación de los astros y otros cálculos astronómicos. Varios modelos de movimientos astrales rodean el telescopio  

# Laboratorio de Anatomía Monstruosa (6)
Este laboratorio está dedicado al estudio de la anatomía de los seres vivos. Con el paso de los años se ha convertido en un museo de taxidermia donde se exhiben toda clase de animales y monstruos disecados.

&gt; Un punzante olor a ácido fórmico y alumbre para curtir asalta a los sentidos nada más abrir la puerta de esta habitación. Una pequeña exposición de animales y monstruos disecados os observa desde las vitrinas que forran las paredes, mientras que dos mesas de disección exponen restos de vísceras y los cuerpos mutilados de pequeños roedores. 

# Laboratorio de Alquimia (7)
En esta aula la señorita Bilwa enseña a los alumnos la creación de pócimas y elixires. 

&gt; Dos grandes mesas, horadadas por el uso de componentes ácidos sobre su superficie, se encuentran en el centro de la sala. Alambiques y redomas ocupan gran parte de los escritorios. En las paredes, armarios acristalados albergan todo tipo de frascos, sacos y cajas que contienen extraños componentes para conjuros y todo tipo de instrumentos para el estudio de la magia.

Una tirada de *Investigación* (DC 11) dará como resultado el hallazgo de dos pociones de [Curar Heridas Ligeras](../core/SRD5e/gamemastering/magic-items/potions-oils.html#TOC-Potion-of-Healing), cuatro de [Visión en la Oscuridad](../core/SRD5e/spellcasting/all-spells/d/darkvision.html),
dos [Fuegos del Alquimista](../core/SRD5e/equipment/adventuring-gear.html) y un [Saquito con Polvo de Desaparición](../core/SRD5e/gamemastering/magic-items/wondrous-items.html#TOC-Dust-of-Disappearance). En los armarios, los jugadores pueden encontrar prácticamente cualquier componente para conjuros que pudieran necesitar. 

# Aula Principal (8)
En esta aula es donde se imparte la mayor parte de las clases. 

&gt; Tres largas hileras de mesas y sillas, orientadas hacia un escritorio cubierto de libros y pergaminos, ocupan casi toda la estancia. Una enorme pizarra preside en silencio cubriendo toda la pared sur.

No hay nada de valor en esta habitación, solo libros y apuntes de los estudiantes de la Escuela. 

# Archivo de la Biblioteca (9)
En esta sala se guarda el archivo que sirve como catálogo de los libros que alberga a Biblioteca.

&gt; Esta habitación seca y poco iluminada protege el archivo de la biblioteca. Miles de fichas ordenadas alfabéticamente se encuentran protegidas en cajoneras a lo largo de la sala. Dos mesas de consulta completan el mobiliario de la estancia. Una oxidada escalera de metal desciende a los subterráneos de la Escuela

Los jugadores pueden localizar a través del archivo cualquier libro que les pueda interesar superando una tirada de *Investigación* (DC 6) Estas referencias les podrán proporcionar un bono de +6 a cualquier tirada de conocimiento. 

La escalera conduce a la habitación del Maestro Nizgul.

# Habitación del Maestro Glaucom (10)
Estos son los aposentos del fallecido Maestro Glaucom. Para una descripción más detallada ve a [Aposentos de Glaucom](./encounter.html?param=@glaucom).
Durante el ataque la puerta está cerrada, abrirla exige una tirada de *Destreza* con herramientas de ladrón (DC 21) o romper la puerta de resistencia 5 y 30 puntos de golpe. 

# Despacho del Director (11)
El despacho del director es el lugar que Lormam usa para trabajar, reunirse con el resto de maestros y tratar los temas relativos a la organización de la Escuela.

&gt; Un imponente escritorio preside el despacho del director Lormam, una sala de aspecto espartano donde lo funcional prevalece por encima de lo estético. Una sencilla mesa redonda con cuatro sillas y una humilde librería completan el mobiliario de la habitación

Si los jugadores rebuscan entre los papeles del escritorio pueden encontrar aburridas notas sobre el plan académico y otros documentos relativos a la gerencia de la Escuela. En uno de los cajones del escritorio hay una Varita de Detectar Magia con 15 cargas y una llave. Cualquier ladrón del grupo puede deducir que se trata de una llave maestra que abre cualquier puerta de la Escuela.

# Habitación del Director (12)
Esta es la habitación en la que el director Lormam descansa tras un fatigoso día de trabajo en la Escuela.

&gt; Los aposentos privados del director Lormam son un contrapunto a la sobriedad de su despacho. Una elegante cama cubierta por pieles de animales exóticos reposa sobre una suntuosa alfombra con ricos bordados mientras que un armario, tallado por la mano de un fino ebanista, descansa sobre el muro sur. Un tapiz sobre la pared oeste representa una escena costumbrista con un grupo de personas festejando algún tipo de celebración popular en la plaza de un pueblo. Siete bustos de mármol, del tamaño del puño de un gigante cada uno, miran desafiantes entre los tomos de la librería, en el lado este de la estancia. Por último, un baúl de madera, cerrado con un candado, asoma en la esquina noreste de la sala 

Los bustos de mármol de la librería representan a los antiguos directores de la Escuela. A Lorman le gusta pensar que, desde el más allá, velan por el bien de la Academia. En momentos de vicisitudes o frustraciones le gusta buscar las miradas pétreas de sus antecesores en busca de la fuerza necesaria para seguir adelante con su trabajo. Con una tirada de *Historia* (DC 4) un jugador sabrá que los bustos representan a los siete antiguos directores de la Escuela y sus respectivos nombres.

El baúl de la esquina noreste contiene una pequeña cantidad de oro que Lormam usa para los pagos corrientes de la Escuela. Puede abrirse superando una tirada de *Destreza* con herramientas de ladron (DC 12) y en su interior se encuentran tres pequeños sacos de cuero con 25 monedas de plata cada uno. 

Si se supera una tirada de *Investigación* (DC 16) o se mira directamente detrás del tapiz, los jugadores encontrarán un vano escavado en la piedra de la pared en el que reposa una bolsa de cuero. Se trata de un [saco contenedor](../core/SRD5e/gamemastering/magic-items/wondrous-items.html#TOC-Bag-of-Holding) que contiene una poción de [Curar Heridas Moderadas](../core/SRD5e/gamemastering/magic-items/potions-oils.html#TOC-Potion-of-Healing), 
20 monedas de oro, una [Gema de brillo](../core/SRD5e/gamemastering/magic-items/wondrous-items.html#TOC-Gem-of-Brightness) y una [Perla de Poder](../core/SRD5e/gamemastering/magic-items/wondrous-items.html#TOC-Pearl-of-Power).


# Habitación del Bibliotecario (13)
El anciano bibliotecario pasa las noches en esta habitación entre legajos y libros viejos.

&gt; Una muy mal iluminada sala contiene las pertenencias del viejo bibliotecario. Decenas de libros y pergaminos se amontonan por el suelo de la estancia. Una mesa cubierta de papeles y tomos abiertos sostiene la única vela que ilumina la estancia. Hay libros incluso sobre la cama, lo que parece indicar que el anciano no dedica muchas horas a dormir

Una tirada de *Percepcion* (DC 7) entre los papeles del escritorio dará como resultado el hallazgo de unos [Anteojos de Hechicero](SRD_Wizard_Spectacles-5.html).

# Habitación de la Señorita Bilwa (14)
La habitación de la Señorita Bilwa es el dormitorio más grande de toda la Escuela. Lo utiliza como alcoba y como laboratorio para crear sus famosos elixires. 

&gt; Los aposentos de la Señorita Bilwa están divididos entre un laboratorio de alquimia y una alcoba. El laboratorio, en la parte norte de la sala, lo componen dos mesas llenas de alambiques y botellas donde la hechicera prepara sus pociones. La parte sur de la sala está ocupada por una gran cama con edredones y cojines de colores chillones, un gran espejo dorado de cuerpo entero y un armario repleto de vestidos de la mejor calidad. Un cofre, sin cerrar, en la pared Este, guarda una buena colección de sombreros. También hay un Perchero de Reparar.

Los jugadores pueden encontrar sobre las mesas, a discreción del Master, diversas opciones y aceites fabricados por la Señorita Bilwa. 

Dos de los vestidos de la Señorita Bilwa son de una calidad excepcional y están decorados con pequeñas gemas. Podrían alcanzar el precio de 100mo cada uno si se encuentra al comparador adecuado.

# Galería de los Espíritus (15)
Este pasillo se utiliza para las recepciones de invitados a la Escuela y para recibir a los nuevos alumnos al comienzo de curso. Galería de los Espíritus es el título con el que se conoce a la estancia entre los alumnos, debido a una leyenda que cuenta como hace años un enajenado hechicero asesinó en el lugar a varios de sus colegas. La historia dice que los espíritus de los muertos se aparecen de vez en cuando a los habitantes de la Escuela para advertirles sobre graves peligros. Una tirada de *Historia* (DC 5) dará está información a los jugadores.

&gt; Este pasillo se encuentra totalmente vacío. Sólo es utilizado en contadas ocasiones al año para acoger recepciones o eventos importantes de la Escuela. Es entonces cuando los empleados de la Academia colocan sillas y un estrado desde donde el director se dirige a los presentes.

# Habitaciones (16)
Estos son los cuartos de los alumnos de primer curso. Los estudiantes más jóvenes disfrutan en sus habitaciones de una cama, un pupitre y un contenedor para guardar sus posesiones.  Si se registra la zona pueden encontrarse: 1d4x5mp y 1d6-3 objetos de arte por valor de 10mo cada uno. 
  
# Sala de mapas (17)
Esta sala es una pequeña biblioteca dedicada en almacenar todo el conocimiento cartográfico que los magos han logrado recopilar a lo largo de los años. Unos caballetes sostienen un mapa en relieve de todo el continente ocupando casi toda la sala. De las paredes cuelgan numerosos mapas y dos estanterías contienen archivadores con atlas y cartas de navegación. Si los jugadores *Investigan* y superan una tirada (DC 5) encontrarán planos de la Escuela, de la ciudad y de la región circundante.

&gt; Un enorme mapa del continente en relieve, sostenido por un robusto caballete de roble, ocupa la mayor parte de esta sala, mientras que numerosos planos cuelgan de las paredes. Dos librerías acristaladas contienen decenas de archivadores 

# Sala de té (18)
&gt; Una habitación con el suelo cubierto de cojines y un par de teteras sirve como punto de encuentro entre los alumnos de la Escuela para relajarse, charlar y pasar el rato disfrutando de infusiones.

# Comedor Principal (19)
Aquí se reúnen tres veces al día todos los alumnos de la Escuela para ser alimentados. No hay ningún tipo de decoración y el aire apesta a puchero y pescado cocinado

&gt; Cuatro largas mesas de madera y numerosos taburetes copan el espacio de esta sala flanqueada por dos enormes chimeneas con rescoldos palpitantes. El olor a comida impregna todo el ambiente creando una atmósfera cargada y no muy agradable.

# Hall de Entrada (20)
Los muros de la entrada a la Escuela son un tributo a los ex alumnos y maestros que han pasado por la Academia. Cientos de retratos colman las paredes hasta el punto de que es difícil adivinar la piedra tras la maraña de pinturas colgadas. Una tirada de *Percepción* (DC 12) revelará un pequeño cuadro en la esquina superior izquierda del muro oeste tapado por una mohosa tela. Si se logra alcanzar y se retira el trapo, se descubre la estampa de un joven mago de sonrisa sardónica. En el marco puede leerse *Black Skull*. Si se supera una tirada de *Historia* (DC 10) los jugadores sabrán que se trata de un ex alumno de la Escuela que, tras abandonar la Academia se convirtió en un infame hechicero en el norte del continente. Tras conocerse sus horribles crímenes, el director decidió tapar la imagen como señal de repulsa a sus actos.   

&gt; La entrada a la Escuela es una habitación con las paredes plagadas de cuadros. De arriba abajo y de norte a sur, cientos de retratos cubren los muros. Cada pintura muestra el retrato de un antiguo alumno o maestro de la Academia con su nombre grabado en el marco.

# Galería de los Ingenios (21)
Este largo pasillo contiene una pequeña exposición de artefactos y cachivaches mecánicos creados por los maestros y alumnos de la Escuela a lo largo de los años.
La muestra también contiene una buena colección de relojes que con su tic tac perpetuo envuelven la zona. Cada hora en punto, se unen en una cacofonía de timbres que puede oírse en toda la Escuela.
Entre todos los cacharros del salón existen un par de objetos de mágicos relevantes: Las [Botas de Atravesar Aguas Caudalosas](../core/SRD5e/gamemastering/magic-items/magic-rings.html#TOC-Ring-of-Water-Walking) 
y [La Máscara del Caricato](../core/SRD5e/gamemastering/magic-items/wondrous-items.html#TOC-Hat-of-Disguise),
 ambas creaciones de un ex alumno conocido como Ki. Un par de Golems de Hierro protegían antaño la sala, pero hace tiempo que fueron desmantelados por el peligro que suponían para la seguridad de los alumnos que, despistados, atravesaban el salón a alguna hora intempestiva.

&gt; La Galería de los Ingenios es uno de los pasillos principales de la Escuela. La larga estancia acoge una curiosa exposición de artefactos mecánicos creados por los habitantes de la Academia a lo largo de los años. Pájaros metálicos que baten sus alas, autómatas que recitan poemas y toda clase de pequeños juguetes de cuerda que sorprenden al observador por su complejidad técnica. La pared norte se encuentra tapizada por innumerables relojes, de todos los tamaños y materiales, que con su perpetuo tic tac marcan el paso del tiempo. Dos imponentes figuras de metal de dos metros de altura cada una observan con mirada perdida a los visitantes
 
# Comedor de los Maestros (22)
&gt; Este refectorio, separado del principal, es el que usan los maestros para comer al margen de los alumnos. Una mesa de buena calidad y unas sillas cómodas ponen de relieve la diferencia de rango entre los que comen aquí y los que lo hacen en la sala adyacente.
 
# Almacén de la Vajilla (23)
Esta sala tiene las paredes forradas de estanterías con decenas de platos y vasos de madera que se utilizan en las comidas. Los cubiertos, también de madera, están almacenados en una pequeña cajonera. Un armario con llave protege la vajilla de calidad que utilizan los maestros. Abrirla exige una tirada de *Destreza* o *Fuerza* (DC 4). Esta vajilla está compuesta por 132 piezas, entre platos de diferentes tamaños y copas, fabricadas en porcelana con ribetes de oro. Su valor puede llegar a ser de 100 monedas de oro. Una enorme pileta de agua se utiliza para fregar todos los platos. Sobre una mesa reposa un [Decantador de Agua Infinita](../core/SRD5e/gamemastering/magic-items/wondrous-items.html#TOC-Decanter-of-Endless-Water).

&gt; Varias estanterías rebosantes de platos, vasos y todo tipo de fuentes cuelgan de las paredes de esta habitación, además de una cajonera y un pequeño armarito con llave. Una enorme pileta con agua sucia completa el mobiliario de la estancia.

# Habitaciones (24)
Esta zona contiene las habitaciones de las estudiantes femeninas, indistintamente del curso al que pertenezcan. Todas las estudiantes cuentan con una cama, una mesa de estudio con su silla y un baúl para guardar sus pertenencias. Si se registra la zona pueden encontrarse: 1d4x5mp una guitarra de gran calidad y 1d6-3 objetos de arte por valor de 20mo cada uno. A discreción del Master pueden hallarse pergaminos de la tabla de *Pergaminos Menores*. 

# Habitaciones (25)
Esta Zona de la Escuela alberga las habitaciones de los Estudiantes de grado medio. Como el resto de cuartos de los alumnos, las habitaciones proporcionan a cada residente un catre, una mesa de trabajo y un baúl donde guardar sus pertrechos. Si se registra la zona pueden encontrarse: 1d4x5mp y 1d6-4 objetos de arte por valor de 20 mo cada uno. A discreción del Master pueden hallarse los siguientes objetos mágicos: [Poción de Apresuramiento](../core/SRD5e/spellcasting/all-spells/h/haste.html) y una Daga +1. También se puede hacer una tirada en la tabla de *Pergaminos Menores*. 
En esta zona, también se encuentra uno de los retretes que los habitantes de la Academia utilizan para aliviar sus necesidades.

# Habitaciones (26)
Estos son los aposentos de los estudiantes de último curso y dos retretes. Cada cuarto tiene una cama, una mesa de estudio con su silla y un baúl. Si los jugadores registran las habitaciones pueden encontrar en cada una de ellas: 1d6x5mp y 1d6-4 objetos de arte por valor de 20mo cada uno. A discreción del Master pueden hallarse los siguientes objetos mágicos: un [Globo de Humo](../core/SRD5e/spellcasting/all-spells/f/fog-cloud.html), una [pergamino de invocación](../core/SRD5e/spellcasting/all-spells/i/instant-summons.html) 
y un [Tomo Académico](SRD_Academic_Tome-5.html). También se puede hacer una tirada en la tabla de *Pergaminos Medios*. 
Los dos retretes son poco menos que dos agujeros, que comunican con una corriente subterránea, empleados por los habitantes de la Escuela para aliviarse.

# Cocina (27)
La cocina de la Escuela es una gran sala con una chimenea central y un par de fogones.

&gt; La cocina es el lugar más cálido de la Escuela. La enorme chimenea central y los fogones hacen que la temperatura se eleve un par de grados respecto al resto de estancias. Un fuerte olor a comida golpea a quien entra en la habitación mientras una humeante olla de metal descansa suspendida sobre el fuego de la chimenea central, cociendo la comida del próximo día. Sacos, toneles y otros contenedores protegen la comida que los cocineros utilizan para alimentar a alumnos y profesores.

# Almacén Principal (28)
&gt; Esta sala se utiliza como almacén de la Escuela. Sacos, baúles, tinajas y barriles guardan alimentos, telas y todo tipo de herramientas necesarias en el día a día de la Academia

Los jugadores pueden encontrar aquí todo tipo de herramientas mundanas como palas, picos, martillos, etc. y hasta 33 metros de cuerda. 

# Habitaciones (29)
Esta ala de la Escuela la comparten alumnos de grado medio y el matrimonio de cocineros que trabaja en la Escuela. Las habitaciones de los estudiantes son como el resto de los cuartos de alumnos: Una cama, un pupitre y un baúl. Si se registra la zona pueden encontrarse: 1d4x5mp y 1d6-4 objetos de arte por valor de 20mo cada uno. A discreción del Master pueden hallarse los siguientes objetos mágicos: un [Anillo de cahida de pluma](../core/SRD5e/gamemastering/magic-items/magic-rings.html#TOC-Ring-of-Feather-Falling) y un [pergamino de invisibilidad](../core/SRD5e/spellcasting/all-spells/i/invisibility.html).
También se puede hacer una tirada en la tabla de *Pergaminos Menores*.
Por su parte, los cocineros disfrutan en sus aposentos de una cómoda cama de matrimonio y un gran armario. Tienen también un baúl cerrado con llave. Se necesita una tirada de *Destreza* con herramientas de larón (DC 8) para descubrir las 30mo de su interior.   

# Barracones (30)
Esta la larga sala sirve de dormitorio y de lugar de asueto para los miembros de la guardia.

&gt; Una larga sala alberga los camastros de los guardias de la Escuela. Varias mesas sirven a los soldados para pasar las horas muertas jugando a las cartas en sus ratos libres.

Los jugadores pueden rebuscar entre los baúles y bolsas de lona que los guardias usan para guardar sus objetos personales, y encontrar un total de 4 monedas de plata, 34 de cobre y dos anillos por valor de 3 monedas de oro cada uno.

Existe una puerta secreta, *Percepción* (DC 12), que comunica con [La Torre de Vigilancia](./encounter.html?param=21).

# Armería (31)
En esta sala los guardias de la Escuela almacenan las armas. También usan la estancia como lugar de entrenamiento.

&gt; Esta desangelada estancia contiene caballetes donde se exhiben lanzas y espadas. Una veintena de escudos descansa apilada en la esquina noroeste y una enorme colchoneta deshilachada y envejecida por el uso ocupa el centro de la sala. El aire está muy cargado y el olor a sudor impregna el ambiente

Los jugadores pueden encontrar aquí cualquier tipo de arma no exótica, escudos medianos y armaduras de cuero.

# Habitación del Sargento Menzal (32)
La habitación del sargento de la guardia es un sencillo y pulcro dormitorio.

&gt; Este dormitorio está limpio y ordenado. Una cama, un armario y un baúl son los únicos muebles de la habitación.

Una tirada de *Percepcion* (DC 11) revelará un doble fondo en el baúl. Dentro hay una caja de metal con una cerradura *Destreza* y herramientas (DC 20). En el interior se encuentran 200 monedas de oro y los títulos de propiedad de una hacienda al sur del continente recientemente adquirida. Envuelto en un trapito de terciopelo hay una llave: se trata de una copia de la llave maestra del Maestro Lormam con la que se pueden abrir todas las puertas de la Escuela. Hace tiempo, Menzal se hizo con la llave y desde entonces ha ido sacando pequeñas cantidades de dinero de la Cámara del Tesoro. Gracias a estos *ingresos extra* ha logrado juntar el dinero para comprar una granja donde retirarse.
</tw-passagedata><tw-passagedata pid="25" name="Localizaciones Sâlorium" tags="lugares @salorium-map" position="249,598" size="100,100">
# La Escuela de Magia (1)
La Escuela de Magia es el orgullo de los habitantes de Sâlorium. Su biblioteca atrae a eruditos de todo el continente, y la fama de sus profesores y alumnos intimida a los posibles atacantes. 

# La Torre de Vigilancia (2)
La Torre de la Guardia es el edificio más cercano a la Escuela de Magia y se encuentra comunicada con la Academia a través de **un túnel** que da a parar a los Barracones de la Guardia (sala 30)

Los jugadores pueden llegar a la Torre en momentos diferentes de la Aventura.

# El Castillo (3)
La Fortaleza de Sâlorium se alza sobre el resto de edificios de la Ciudad ofreciendo a los ciudadanos de la villa el halo de seguridad que otorga su mera presencia. La Guardia, al mando del Maestre General Borcious, acuartelada tras los muros, sirve tanto para mantener el orden dentro de la ciudad como para defenderla de amenazas externas.    

# El Cementerio (4)
El campo santo de Sâlorium es una de las zonas más viejas de la ciudad. Al principio se encontraba fuera de los muros, pero con el desarrollo de la urbe ha terminado por ser incorporado al interior de la muralla. 

# El puente (5)
Este es uno de los puentes que comunican las dos zonas de la ciudad separadas por el Río Orium. Es el único que se encuentra en buen estado, lo que provoca grandes atascos, especialmente los días de mercado. Una patrulla de la Guardia dirige el paso a través de la pasarela regulando el tráfico de carros y personas. Las peleas y rifi rafes entre los usuarios son muy habituales y más de una vez se han montado peleas multitudinarias debido a los retrasos e inconvenientes que provoca la saturación del viaducto.   

# El puente roto (6)
Este puente fue arrastrado por la corriente hace unos años y desde entonces ha permanecido inservible, a pesar de las quejas de los vecinos. Los responsables de la ciudad mantienen su promesa de repararlo, pero los trabajos de rehabilitación aún no se han comenzado. 

# La Plaza del Mercado (7)
Esta plaza alberga el Mercado principal de Sâlorium. Durante el día, decenas de puestos inundan el lugar donde pueden comprarse todo tipo de productos. Durante la noche, una vez que las tiendas han sido desmontadas y mercaderes y compradores descansan en sus casas, el lugar es una gran explanada vacía y silenciosa.

# La Ballena Blanca (8)
Una de las muchas posadas de la Ciudad, conocida por su parroquia poco recomendable. [La Ballena Blanca](./encounter.html?param=13)
</tw-passagedata><tw-passagedata pid="26" name="Los Mapas" tags="index @mapas" position="505,728" size="100,100">
## Mapas, Hojas de personaje y otros entregables

Puedes descargar los mapas, las hojas de personaje y otros entregables de esta aventura desde la web www.digitald20.com.
</tw-passagedata><tw-passagedata pid="27" name="Subterráneos" tags="encounter @dungeon" position="909,188" size="100,100">
# SITUACIÓN

Los túneles que componen el subterráneo de la Escuela de Magia están escavados en roca viva. Las paredes y el suelo han sido pulidos concienzudamente dando al lugar un aspecto pulcro. Cada 10 metros se puede encontrar en una de las paredes un colgador vacío donde encajar una antorcha. La única luz del lugar es la que traiga cada visitante consigo mismo, a excepción del pasillo de la Cámara del Tesoro, donde antorchas mágicas arden en todo momento.

Una corriente subterránea, que comunica con el Río Orium, recorre el subsuelo de la Escuela y comunica con los sótanos construidos bajo tierra. Los habitantes de la Academia lo utilizan como fuente para obtener agua a través del pozo del Patio y para verter los deshechos por los retretes.

Las entradas a los subterráneos se encuentran en:
 * Trampilla en el [despacho del Director](./lugares.html?param=@escuela-map&amp;room=11).
 * Puerta secreta en la [cripta del templo](./lugares.html?param=@escuela-map&amp;room=11). 
 * Trampilla en la habitación del [maestro Nizgul](./lugares.html?param=@escuela-map&amp;room=11). 


La corriente es poderosa y arrastra en dirección Sureste-Noroeste a cualquier cosa que flote sobre su superficie. Nadar en estas aguas exige una tirada de *Fuerza* (DC 10) si se va a favor de la corriente y de (DC 15) si se hace en su contra.  

Se puede caminar por el borde del río durante su paso bajo la Escuela.

Si los jugadores se sumergen en estas oscuras aguas, a discreción del Master pueden tener un encuentro con 1d2 [Ratas Gigantes](../core/SRD5e/gamemastering/monsters-foes/monsters-alphabetical/monsters-a/animals/animal-rat-giant.html) 

La única zona iluminada por antorchas es la del [puente](./lugares.html?param=@dungeon-map&amp;room=3) que cruza el riachuelo comunicando El Laboratorio del Maestro Nizgul con el pasillo de la Cámara del Tesoro. 

AT A GLANCE
---
* Los jugadores que se hayan gastado al menos 1 punto en *Historia* o que vivan en la Escuela conocen la existencia de los subterráneos, pero no los puntos de acceso. 
* *Supervivencia*
  * (DC 1) Sabes que las aguas no son tóxicas. 
  * (DC 5) Sabes que va a ser muy complicado Nadar contra corriente. 
  * (DC 5) Seguramente Ratas Gigantes habiten en estos subterráneos. 
* *Percepción* si se combate a las ratas:
  * (DC 15) Te percatas de que a Yonse no le atacan las ratas. 
  * Además, ten en cuenta las [características generales](../lugares.html?param=@caracteristicas&amp;room=0) de la Escuela. 

CONCLUSION
---
Desde aquí, los jugadores pueden partir a otros encuentros relevantes

* [[Maestro Nizgul]]
* [Cámara del Tesoro](./encounter.html?param=@tesoro)

images {./images/act-2/river.jpg, ./maps/dungeon_river-es.html, ./maps/mschool_dungeon-es.html}
music {nizgul-room.mp3}


</tw-passagedata><tw-passagedata pid="28" name="Características de la Escuela" tags="lugares @caracteristicas" position="113,600" size="100,100">
# CARACTERISTICAS DE LA ESCUELA
La Escuela de Magia fue el primer edificio de Sâlorium, alrededor del que creció el resto de la urbe. En sus orígenes, se trataba de una fortaleza construida para proteger esta zona del continente frente a las hordas de orcos y monstruos que habitan en el Norte. Debido a su carácter defensivo, la Escuela está construida con poderosos muros de sillería sin ventanas y rodeada de una monumental muralla que ha sufrido durante siglos el asedio de ejércitos y hordas. Con su reconversión en Escuela, el edificio ha sufrido pequeñas remodelaciones, como la construcción del Observatorio, pero su naturaleza militar sigue siendo preponderante en la edificación. 

### Muros:
* Muros Interiores: Los muros interiores de la Escuela están construidos con piedra y tienen una anchura de 1 metro. 

* Muralla y Muros Exteriores: Tanto la muralla como los muros exteriores de la Escuela tienen una anchura de 2 metros.


### Alturas:
* Exterior: La Escuela se alza hasta una altura de 6 metros, excepto en el caso de Biblioteca y Observatorio y del Templo, que llegan hasta los 18 metros de altura. 
* Habitaciones: Las habitaciones, si no se especifica lo contrario, tienen una altura de 5 metros.  
* Pasillos: Los pasillos, si no se especifica lo contrario, tienen una altura de 5 metros.
* Subterráneos: Los pasillos subterráneos alcanzan poco más de 2 metros de altura. 
* Muralla: Los muros que rodean el Patio de la Escuela tienen una altura de 8 metros. 

### Suelo 
El suelo de la Escuela está compuesto de losetas de piedra pulida. Si no se menciona lo contrario, el movimiento sobre la superficie es normal.

### Iluminación
Debido a su origen defensivo la escuela carece de ventanas, por lo que la iluminación interior depende de la iluminación artificial. Los pasillos y habitaciones principales tienen antorchas sobre las que se ha lanzado un conjuro de Luz de forma permanente. En esta Aventura, debido al conjuro de Dispar Magia lanzado sobre la Escuela, estos encantamientos han sido disipados, sumiendo a la Academia en al más negra de las oscuridades.
En las habitaciones pueden encontrarse linternas, faroles y velas usadas por los habitantes del edificio.

</tw-passagedata><tw-passagedata pid="29" name="Localizaciones Dungeon" tags="lugares @dungeon-map" position="503,599" size="100,100">
# Cripta
El sótano del Templo es un lugar húmedo y con el aire muy cargado. Un moho verdoso crece entre los sillares de las paredes y las losas del suelo. Si este lugar tubo alguna utilidad debió de ser hace mucho tiempo, pues no queda ningún vestigio de su antiguo uso.

# Cámara del Tesoro
La Cámara donde el Director de la Escuela guarda el tesoro de la Academia es una habitación sencilla con las paredes encaladas. Una enorme plancha de metal con un mecanismo de rueda y una cerradura impide la entrada a los curiosos. 

Continúa en [[Cámara del Tesoro]].

# Puente 
Un puente de madera medio podrida cubre el paso sobre el río subterráneo. A pesar de su aspecto débil, los tablones aguantan bien el paso de varias personas a la vez.

# Laboratorio de Nizgul
La habitación del Nigromante Nizgul se encuentran bajo el Archivo de la Biblioteca (9). Se trata de una habitación grande que cumple la función de dormitorio y laboratorio. El olor a productos químicos es insoportable y el hecho de que compartiera cuarto con algunos de sus experimentos nigrománticos da idea de lo perturbado que se encuentra el maestro. 

# Almacén de Nizgul
Está sala esta forrada de altas estanterías hasta el techo. Cada balda está cargada de viales y botes de cristal que contienen todo tipo de componentes para conjuros de lo más exóticos, así como productos químicos de naturaleza mucho más mundana. No hay nada clasificado ni etiquetado, el maestro Nizgul tiene memorizada la posición de todos los frascos y que contiene cada uno de ellos.

# Letrina
Esta letrina da acceso al rio subterráneo. 


# Pozo del patio
Este pozo da acceso al rio subterráneo. 


# Puerta secreta
Esta puerta secreta comunica con el Templo de magia
</tw-passagedata><tw-passagedata pid="30" name="NPCS" tags="lugares @npcs" position="115,724" size="100,100">
# Refugiado delincuente (Hombre Común)

**Lunkar**, Neutral Elvil  
_____________________________________________
**Armor Class**: 12 (Padded)  
**Hit Points**: 6 (1d8 +2)  
**Speed**: 30ft (9m / 6 sqr)  
**Proficiency**: +2  
_____________________________________________

STR     | DEX     | CON     | INT     | WIS     | CHA
---     |---      |---      |---      |---      | ---
11 (+0) | 13 (+1) | 15 (+2) | 11 (+0) | 13 (+1) | 9 (-1)

______________________________________________
**Skills**: Stealth +3, Sleight of Hand +3  
**Challenge**: 1/8 (25 XP)  
______________________________________________
**Club**. Melee Weapon Attack +2 to hit, reach 5 ft, one target. Hit: 2 (1d4 +0 ) bludgeoning damage.
Properties: Light,


# APRENDIZ DE MAGO (Mago de Nivel 1)

**Armor Class**: 13 (with mage armor)  
**Hit Points**: 6 (1d8 +2)  
**Speed**: 30ft (9m / 6 sqr)  
**Proficiency**: +2  
________________________________

STR     | DEX     | CON     | INT     | WIS     | CHA
---     |---      |---      |---      |---      | ---
9 (-1)  |11 (+0)  |14 (+2)  |16 (+3)  |13 (+1)  |15 (+2)
_______________________________________
**Skills**: Arcana +5, History +5  
**Challenge**: 1/2 (100 XP)  
_______________________________
**Quarterstaff**. Melee Weapon Attack +1 to hit, reach 5 ft, one target. Hit: 2 (1d6 -1 ) bludgeoning damage.
Properties: Versatile (1d8)  

Spells
---
Its spellcasting ability is Intelligence (spell save DC 13, to hit with spell attacks +5)  

**Cantrips** (at will): *Mending*, *Light*, *Ray of Frost*  
**1st level** (2 slots): *Unseen Servant*, *Tensers Floating Disk*, *Burning Hands*, *Find Familiar*, *Mage Armor*  


# RUFI (Mago Humano de Nivel 6)

**Rufi**, Neutral Bueno
_________________________________________
**Armor Class:** 13 (with mage armor)  
**Hit Points:** 39 (6d8 +12)  
**Speed:** 30ft (9m / 6 sqr)  
**Proficiency:** +3  
_________________________________________

STR     | DEX     | CON     | INT     | WIS     | CHA
---     |---      |---      |---      |---      | ---
9 (-1)  |11 (+0)  |14 (+2)  |16 (+3)  |13 (+1)  |15 (+2)
_________________________________________

**Skills:** Arcana +6 History +6
**Challenge:** 3 (700 XP) 
__________________________________________

**Quarterstaff**. Melee Weapon Attack +2 to hit, reach 5 ft, one target. Hit: 2 (1d6 -1 ) bludgeoning damage.
Properties: Versatile (1d8),

Spells
---
Its spellcasting ability is Intelligence (spell save DC 14, to hit with spell attacks +6)  

**Cantrips** (at will): *Acid Splash*, *Poison Spray*, *Mending*, *Prestidigitation*  
**1st level** (4 slots): *Find Familiar*, *Sleep*, *Magic Missile*, *Mage Armor*  
**2nd level** (3 slots): *Scorching Ray*, *Crown of Madness*, *Darkvision*  
**3rd level** (3 slots): *Remove Curse*, *Major Image*  


# NATSO (Mago Humano de Nivel 11)

**Natso**, Elvil legal
________________________________________
**Armor Class:** 16 (with mage armor)  
**Hit Points:** 71 (11d8 +22)  
**Speed:** 30ft (9m / 6 sqr)  
**Proficiency:** +4  
_________________________________________

STR     | DEX     | CON     | INT     | WIS     | CHA
---     |---      |---      |---      |---      | ---
11 (+0) |17 (+3)  |15 (+2)  |19 (+4)  |13 (+1)  |11 (+0)

_________________________________________
**Skills:** Arcana +8, History +8, Investigation +8, Persuasion +7  
**Saving Throws:** Intelligence +8 Charisma +7  
**Challenge:** 7 (2900 XP)  
_________________________________________
**Quarterstaff**. Melee Weapon Attack +4 to hit, reach 5 ft, one target. Hit: 3 (1d6 +0 ) bludgeoning damage.
Properties: Versatile (1d8)  

Spells
---
Its spellcasting ability is Intelligence (spell save DC 16, to hit with spell attacks +8)
**Cantrips** (at will): Light, Ray of Frost, Message, Mending, Chill Touch  
**1st level** (4 slots): Disguise Self, Sleep, Mage Armor  
**2nd level** (3 slots): Invisibility, Darkvision  
**3rd level** (3 slots): Lightning Bolt, Remove Curse, Fly, Blink  
**4th level** (3 slots): Conjure Minor Elementals, Wall of Fire  
**5th level** (2 slots): Cone of Cold, Planar Binding  
**6th level** (1 slots): Chain Lightning, Disintegrate  


# ZORX, DUEÑO DE BALLENA BLANCA (Hombre Común Nivel 2)

**Zorx**, Neutral Good
_________________________________________________
**Armor Class:** 11 (Padded)  
**Hit Points:** 13 (2d8 +4)  
**Speed:** 30ft (9m / 6 sqr)  
**Proficiency:** +2  
__________________________________________________
STR     | DEX     | CON     | INT     | WIS     | CHA
---     |---      |---      |---      |---      | ---
9 (-1)  |11 (+0)  |14 (+2)  |13 (+1)  |15 (+2)  |16 (+3)
___________________________________________________

**Skills:** Insight +4, Persuasion +5, Deception +5, Investigation +3  
**Challenge:** 1/8 (25 XP)  
_________________________________________________

**Dagger**. Melee Weapon Attack +2 to hit, range 20/60, one target. Hit: 2 (1d4 +0 ) piercing damage.
Properties: Thrown: range 20/60, Finesse, Light, Its actually a kitchen knife  

# GUARDIA DE LA ESCUELA (Guerrero Nivel 1)

**Armor Class:** 15 (Chain shirt)  
**Hit Points:** 6 (1d8 +2)  
**Speed:** 30ft (9m / 6 sqr)  
**Proficiency:** +2  

_____________________________________

STR     | DEX     | CON     | INT     | WIS     | CHA
---     |---      |---      |---      |---      | ---
16 (+3) |14 (+2)  |15 (+2)  |9 (-1)   |11 (+0)  |13 (+1)

_____________________________________

**Skills:** Athletics +5 Intimidation +3
**Challenge:** 1/2 (100 XP) 
______________________________________

**Pike**. Melee Weapon Attack +5 to hit, reach 10 ft, one target. Hit: 8 (1d10 +3 ) piercing damage.
Properties: Heavy, Reach, Two-handed  

**Javelin**. Melee Weapon Attack +5 to hit, range 30/120, one target. Hit: 6 (1d6 +3 ) piercing damage.
Properties: Thrown: range 30/120


</tw-passagedata><tw-passagedata pid="31" name="Open Game License" tags="index @open-game-license" position="90,188" size="100,100">
# Licencia
OPEN GAME LICENSE Version 1.0a

The following text is the property of Wizards of the Coast, Inc. and is
Copyright 2000 Wizards of the Coast, Inc (“Wizards”). All Rights
Reserved.

1\. Definitions: (a)”Contributors” means the copyright and/or trademark
owners who have contributed Open Game Content; (b)”Derivative Material”
means copyrighted material including derivative works and translations
(including into other computer languages), potation, modification,
correction, addition, extension, upgrade, improvement, compilation,
abridgment or other form in which an existing work may be recast,
transformed or adapted; (c) “Distribute” means to reproduce, license,
rent, lease, sell, broadcast, publicly display, transmit or otherwise
distribute; (d)”Open Game Content” means the game mechanic and includes
the methods, procedures, processes and routines to the extent such
content does not embody the Product Identity and is an enhancement over
the prior art and any additional content clearly identified as Open Game
Content by the Contributor, and means any work covered by this License,
including translations and derivative works under copyright law, but
specifically excludes Product Identity. (e) “Product Identity” means
product and product line names, logos and identifying marks including
trade dress; artifacts; creatures characters; stories, storylines,
plots, thematic elements, dialogue, incidents, language, artwork,
symbols, designs, depictions, likenesses, formats, poses, concepts,
themes and graphic, photographic and other visual or audio
representations; names and descriptions of characters, spells,
enchantments, personalities, teams, personas, likenesses and special
abilities; places, locations, environments, creatures, equipment,
magical or supernatural abilities or effects, logos, symbols, or graphic
designs; and any other trademark or registered trademark clearly
identified as Product identity by the owner of the Product Identity, and
which specifically excludes the Open Game Content; (f) “Trademark” means
the logos, names, mark, sign, motto, designs that are used by a
Contributor to identify itself or its products or the associated
products contributed to the Open Game License by the Contributor (g)
“Use”, “Used” or “Using” means to use, Distribute, copy, edit, format,
modify, translate and otherwise create Derivative Material of Open Game
Content. (h) “You” Not for resale. Permission granted to print or
photocopy this document for personal use only. System Reference Document
5.1 1 or “Your” means the licensee in terms of this agreement.

2\. The License: This License applies to any Open Game Content that
contains a notice indicating that the Open Game Content may only be Used
under and in terms of this License. You must affix such a notice to any
Open Game Content that you Use. No terms may be added to or subtracted
from this License except as described by the License itself. No other
terms or conditions may be applied to any Open Game Content distributed
using this License.

3\. Offer and Acceptance: By Using the Open Game Content You indicate
Your acceptance of the terms of this License.

4\. Grant and Consideration: In consideration for agreeing to use this
License, the Contributors grant You a perpetual, worldwide, royalty
free, non exclusive license with the exact terms of this License to Use,
the Open Game Content.

5.Representation of Authority to Contribute: If You are contributing
original material as Open Game Content, You represent that Your
Contributions are Your original creation and/or You have sufficient
rights to grant the rights conveyed by this License.

6\. Notice of License Copyright: You must update the COPYRIGHT NOTICE
portion of this License to include the exact text of the COPYRIGHT
NOTICE of any Open Game Content You are copying, modifying or
distributing, and You must add the title, the copyright date, and the
copyright holder’s name to the COPYRIGHT NOTICE of any original Open
Game Content you Distribute.

7\. Use of Product Identity: You agree not to Use any Product Identity,
including as an indication as to compatibility, except as expressly
licensed in another, independent Agreement with the owner of each
element of that Product Identity. You agree not to indicate
compatibility or co adaptability with any Trademark or Registered
Trademark in conjunction with a work containing Open Game Content except
as expressly licensed in another, independent Agreement with the owner
of such Trademark or Registered Trademark. The use of any Product
Identity in Open Game Content does not constitute a challenge to the
ownership of that Product Identity. The owner of any Product Identity
used in Open Game Content shall retain all rights, title and interest in
and to that Product Identity.

8\. Identification: If you distribute Open Game Content You must clearly
indicate which portions of the work that you are distributing are Open
Game Content.

9\. Updating the License: Wizards or its designated Agents may publish
updated versions of this License. You may use any authorized version of
this License to copy, modify and distribute any Open Game Content
originally distributed under any version of this License.

10\. Copy of this License: You MUST include a copy of this License with
every copy of the Open Game Content You Distribute.

11\. Use of Contributor Credits: You may not market or advertise the Open
Game Content using the name of any Contributor unless You have written
permission from the Contributor to do so.

12\. Inability to Comply: If it is impossible for You to comply with any
of the terms of this License with respect to some or all of the Open
Game Content due to statute, judicial order, or governmental regulation
then You may not Use any Open Game Material so affected.

13\. Termination: This License will terminate automatically if You fail
to comply with all terms herein and fail to cure such breach within 30
days of becoming aware of the breach. All sublicenses shall survive the
termination of this License.

14\. Reformation: If any provision of this License is held to be
unenforceable, such provision shall be reformed only to the extent
necessary to make it enforceable.

15\. COPYRIGHT NOTICE

Open Game License v 1.0a Copyright 2000, Wizards of the Coast, LLC.

System Reference Document 5.1 Copyright 2016, Wizards of the Coast,
Inc.; Authors Mike Mearls, Jeremy Crawford, Chris Perkins, Rodney
Thompson, Peter Lee, James Wyatt, Robert J. Schwalb, Bruce R. Cordell,
Chris Sims, and Steve Townshend, based on original material by E. Gary
Gygax and Dave Arneson.</tw-passagedata><tw-passagedata pid="32" name="Monsters" tags="lugares @monsters" position="1210,788" size="100,100">
# DORIS (Doppleganger)
![large](./images/monsters/doris.jpg)
Doris es un cambiaformas mercenario que trabaja siempre para el mejor postor Aunque no se preocupa más que por su propio interés, es perfectamente profesional para cumplir con su parte de los tratos.
*Monstruosidad mediana (cambiaformas), caótico neutral*
_____________________________________________
**Armadura** 14  
**Puntos de golpe** 52 (8d8 + 16)  
**Velocidad** 30 
_____________________________________________
|FUE|DES|CON|INT|SAB|CAR|
|:---:|:---:|:---:|:---:|:---:|:---:|
|11 (+0)|18 (+4)|14 (+2)|11 (+0)|12 (+1)|14 (+2)|
_____________________________________________
**Habilidades** Engaño +6, Perspicacia +3  
**Inmunidad a condiciones** encantado  
**Sentidos** Visión en la oscuridad 60 ft., Percepción pasiva 11  
**Idiomas** Común  
**Desafío** 3 (700 XP)  
_____________________________________________
***Cambiaformas.*** El doppelganger puede usar esta accion para transformarse en una criatura pequeña o mediana que haya visto, o volver a su auténtica forma. Sus estadísticas, aparte de su tamaño, son las mismas en cualquier forma. Cualquier equipo que porte o lleve no es transformado. Revierte a su auténtica forma si muere.  
***Emboscador.*** En su primer turno de combate, el doppelganger tiene ventaja en sus tiradas de ataque contra cualquier criatura que haya sido sorprendida.  
***Ataque por sorpresa.*** Si el doppelganger sorprende a una criatura y la impacta con un ataque durante el primer turno de combate, el objetivo recibe 10 (3d6) puntos de daño extra.  
### Acciones  
***Ataque múltiple.*** El doppelganger realiza dos ataques cuerpo a cuerpo.  
***Manotazo.*** *Ataque cuerpo a cuerpo:* +6 para impactar, alcance 5 ft., un objetivo. *Daño:* 7 (1d6 + 4) Daño contundente.  
***Leer pensamientos.*** El doppelganger lee mágicamente la los pensamientos superficiales de una criatura en un rango de 60 pies a su alrededor. Este efecto puede atravesar barreras, pero tres pies de madera o tierra, dos pies de piedra, dos pulgadas de metal o una fina capa de plomo puede bloquearlo. Mientras el objetivo esté dentro del rango, el doppelganger puede continuar leyendo sus pensamientos, siempre y cuando su concentración no se vea interrumpida (como si estuviera concentrándose en un conjuro).Mientras lee la mente del objetivo, el doppelganger tiene ventaja en sus pruebas de Sabiduría (Perspicacia) y Carisma (Engaño, Intimidación y Persuasión) contra el objetivo.  
_____________________________________________
Los Doppelgangers son astutos cambiaformas que toman la apariencia de otros humanoides, lanzándose en la persecución de presas atraidas por su habilidad de engaño. Pocas criaturas desprenden tanto miedo y desconfianza como los doppelgangers. Encontrados en toda tierra y cultura, pueden adoptar el rol de cualquier individuo de cualquier raza.  
***Robando secretos.*** La forma adoptada por un doppelganger le permite infiltrarse en casi cualquier grupo o comunidad, pero esta transformación no enseña idiomas, manierismos, recuerdos o personalidad. Los doppelgangers suelen seguir o capturar criaturas que tratan de copiar, estudiándolas y hurgando en sus mentes en busca de secretos. Un doppelganger puede leer los pensamientos superficiales de una criatura, pudiendo conocer su nombre, deseos y miedos, además de algunos recuerdos sueltos. Un doppelganger personalizando una criatura específica como parte de un plan a largo plazo puede mantener esta doble vida durante semanas, inspeccionando la mente de la vida a diario para aprender cómo comportarse y hablar de forma apropiada.  
***Estafadores hedonistas.*** Los doppelgangers trabajan en solitario o en pequeños grupos, con roles que cambian en cada caso. Mientras un toma el papel de un mercader o noble asesinado, los demás adquieren un numero de identidades que las circunstancias requieran, jugando partes de la familia o sirvientes mientras viven de las riquezas de la víctima.  
***Cambiantes.*** Los doppelgangers son demasiado vagos y egoístas como para criar a los suyos. Asumen el aspecto de alguna forma masculina atractiva y seducen mujeres, dejando que ellas críen a su progenie. Un niño doppelganger parece un miembro normal de la especie de su madre hasta que alcanza la adolescencia, momento en el cual descubre su verdadera naturaleza y es guiado a encontrar a los suyos y unirse a ellos.







# LORD GIMION (Aparición)
![large](./images/monsters/spectre-portrait.jpg)
Una forma humanoide empieza a crearse a tus pies desde la bruma . Un hombre translúcido con rostro regio y ropas elegantes aparece ante ti con actitud firme. Su rostro dibuja una mueca con un gemido que te hiela la sangre.  
Es Lord Girion, un antiguo caballero cuya vida después de la muerte fue consagrada por los sacerdotes para la protección de los muertos. No permite que nadie perturbe al resto de los muertos y atacará a todos aquellos cuyos actos profanan el terreno sagrado.
*No-muerto mediano, neutral malvado*
_____________________________________________
**Armadura** 13  
**Puntos de golpe** 67 (9d8 + 27)  
**Velocidad** 0 ft., fly 60 ft. (flotar)
_____________________________________________
|FUE|DES|CON|INT|SAB|CAR|
|:---:|:---:|:---:|:---:|:---:|:---:|
|6 (-2)|16 (+3)|16 (+3)|12 (+1)|14 (+2)|15 (+2)|
_____________________________________________
**Resistencia al daño** acido, frío, fuego, relámpago, trueno; contundente, penetrante, y cortante de ataques no mágicos que no estén hechos con armas de plata  
**Inmunidades al daño** necrotico, veneno  
**Inmunidad a condiciones** encantado, exhausto, apresado, paralizado, petrificado, envenenado, derribado, ralentizado  
**Sentidos** Vision en la oscuridad 60 ft., Percepcion pasiva 12  
**Idiomas** Común, élfico  
**Desafío** 5 (1,800 XP)  
_____________________________________________
***Movimiento incorpóreo.*** La Aparición puede moverse a través de otras criaturas y objetos como si fueran terrenos difíciles. Recibe 5 (1d10) de daño de fuerza si termina su turno dentro de un objeto.  
***Sensibilidad a la luz solar.*** Mientras está bajo la luz del sol, la Aparición tiene desventaja en las tiradas de ataque, así como en los controles de Sabiduría (Percepción) que dependen de la vista.  
### Acciones  
***Robo de vida.*** *Ataque cuerpo a cuerpo:* +6, alcance 5 ft., un objetivo. *Hit:* 21 (4d8 + 3) daño necrótico. El objetivo debe tener éxito en una tirada de salvación de Constitución de CD 14 o sus puntos de golpe máximos se reducen en una cantidad igual al daño recibido. Esta reducción dura hasta que el objetivo finaliza un descanso largo. El objetivo muere si este efecto reduce sus puntos de golpe máximos a 0.  
***Crear espectro.*** La toma como objetivo a un humanoide a 10 pies de distancia de ella que lleve muerto no más de 1 minuto y haya muerto violentamente. El espíritu del objetivo se eleva como un [espectro](https://www.dandwiki.com/wiki/5e_SRD:Specter &quot;5e SRD:Specter&quot;) en el espacio de su cadáver o en el espacio desocupado más cercano. El espectro está bajo el control de la Aparición. La Aparición no puede tener más de siete espectros bajo su control al mismo tiempo.
_____________________________________________
Una Aparición es pura malicia encarnada, concentrada en una forma incorpórea que busca apagar toda la vida. La criatura está llena de energía negativa, y su mero paso por el mundo deja a las plantas cercanas ennegrecidas y marchitas. Los animales huyen de su presencia. Incluso los incendios pequeños pueden extinguirse por el olvido de la horrible existencia de la Aparición.  
***Horrible olvido.*** Cuando un humanoide mortal vive una vida degradada o entra en un pacto diabólico, entrega su alma a la condenación eterna en los planos inferiores. Sin embargo, a veces el alma se llena tanto de energía negativa que colapsa sobre sí misma y deja de existir en el instante antes de que pueda mudarse a una horrible vida después de la muerte. Cuando esto ocurre, el espíritu se convierte en una Aparición sin alma, un vacío malévolo atrapado en el avión donde murió. Casi nada de la existencia anterior de la Aparición se conserva; en esta nueva forma, existe solo para aniquilar otra vida.  
***Desprovisto de cuerpo.*** Una Aparición puede moverse a través de criaturas sólidas y objetos tan fácilmente como una criatura mortal se mueve a través de la niebla.  
Una Aparición podría retener algunos recuerdos de su vida mortal como ecos sombríos. Sin embargo, incluso los eventos más fuertes y las emociones se convierten en poco más que débiles impresiones, fugaces como sueños medio recordados. Una Aparición podría hacer una pausa para mirar algo que le fascinaba en la vida, o podría frenar su ira en reconocimiento de una amistad pasada. Sin embargo, estos momentos rara vez ocurren, porque la mayoría de las Apariciones desprecian lo que eran como un recordatorio de lo que se han convertido.  
***Comandantes no-muertos.*** Una Aparición puede crear un sirviente no muerto en el espíritu de una criatura humanoide que recientemente ha sufrido una muerte violenta. Tal fragmento de aflicción se convierte en un espectro, a pesar de todo lo que vive.  
Las apariciones a veces gobiernan las legiones de los muertos, conspirando el destino de las criaturas vivientes. Cuando salen de sus tumbas para luchar, la vida y la esperanza se marchitan ante ellos. Incluso si los ejércitos de una Aparición se ven obligados a retirarse, las tierras que ocupan sus fuerzas están tan arruinadas y marchitas que los que viven allí a menudo mueren de hambre y mueren.  
***Naturaleza no-muerta.*** Una Aparición no requiere aire, comida, bebida o dormir.





# MALEANTES (3)
![large](./images/monsters/maleantes.jpg)Glum, Brilos y Folen son tres criminales que pertenecen a la banda de &quot;El tuerto&quot;. Son ladrones de segunda que sobreviven amenazando y extorsionando a prostitutas en la zona del puerto. Son cobardes por naturaleza y sus víctimas son siempre gente débil. En los ataques de la horda de bestias, estos tres criminales han visto la oportunidad de actuar sin restricción

## Glum (Pícaro de nivel 2)
**Armadura:** 14 (Cuero)  
**Puntos de golpe: 9** (1d8)  
**Velocidad:** 30
_____________________________________________
**Iniciativa:** +3  
**Percepción pasiva:** 12  
**Bono de competencia:** +2
_____________________________________________
|FUE|DES|CON|INT|SAB|CAR|
|:---:|:---:|:---:|:---:|:---:|:---:|
|9 (-1)|16 (+3)|13 (+1)|14 (+2)|10 (+0)|13 (+1)|
_____________________________________________
Armas c/c:  
*   **Estoque** (+5) 1d8+3 daño punzante  
*   **2 Dagas** (+5) 1d4+3 daño punzante  
Armas a distancia:  
*   **Short bow** (+5) 1d6+3 daño punzante Alcance: 80/320 20 flechas  
*   **2 Dagas** (+5) 1d4+3 daño punzante Alcance: 20/60  
_____________________________________________
**Habilidades:** Acrobacias +7, Athletics +1, Intimidación +3, Investigation +4, Percepción +2, Sigilo +7  
**Idiomas:** Común, Lenguaje de ladrones, Gigante. Otras competencias: Herramientas de navegación, Vehículos acuáticos
_____________________________________________
**Equipo:** 50 pies de cuerda de seda, Amuleto de la suerte, Palanca, Ropas corrientes, Pack de explorador, Herramientas de ladrón  
**Riquezas:** 80 gp  


## Brilos (Pícaro de nivel 1)
**Armadura:** 14 (Cuero)  
**Puntos de golpe:** 8 (1d8)  
**Velocidad:** 30
_____________________________________________
**Iniciativa:** +3  
**Percepción pasiva:** 13  
**Bono de competencia:** +2
_____________________________________________
|STR|DES|CON|INT|WIS|CHA|
|:---:|:---:|:---:|:---:|:---:|:---:|
|10 (+0)|17 (+3)|10 (+0)|11 (+0)|9 (-1)|11 (+0)|
_____________________________________________
*Armas c/c:*  
*   **Espada corta** (+5) 1d6+3 daño punzante  
*   **2 Dagas**(+5) 1d4+3 daño punzante  
*Armas a distancia:*  
*   **Short bow** (+5) 1d6+3 daño punzante Alcance: 80/320 20 flechas  
*   **2 Dagas** (+5) 1d4+3 daño punzante Alcance: 20/60  
_____________________________________________
**Habilidades:** Acrobacias +5, Perspicacia +4, Percepción +3, Religion +2, Juego de manos +5, Sigilo +5  
**Idiomas:** Común, Lenguaje de ladrones, Silvano. Otras competencias: Herramientas de ladrón, Ajedrez de dragón
_____________________________________________
**Equipo:** Palanca, Ropas oscuras, pack de allanador, Herramientas de ladrón  
**Riquezas:** 155 gp


## Folen (Pícaro de nivel 1)
**Armadura:** 15 (Cuero tachonado)  
**Puntos de golpe:** 17 (2d8)  
**Velocidad:** 30
_____________________________________________
**Iniciativa:** +3  
**Percepción pasiva:** 13  
**Bono de competencia:** +2
_____________________________________________
|STR|DES|CON|INT|WIS|CHA|
|:---:|:---:|:---:|:---:|:---:|:---:|
|10 (+0)|17 (+3)|10 (+0)|11 (+0)|9 (-1)|11 (+0)|
_____________________________________________
*Armas c/c:*  
*   **Estoque** (+5) 1d8+3 daño punzante  
*   **2 Dagas** (+5) 1d4+3 daño punzante  
*Armas a distancia:*  
*   **Short bow** (+5) 1d6+3 daño punzante Alcance: 80/320 20 flechas  
*   **2 Dagas** (+5) 1d4+3 daño punzante Alcance: 20/60
_____________________________________________
**Habilidades:** Perspicacia +4, Intimidación +4, Percepción +3, Interpretación +4, Persuasion +4, Sigilo +7  
**Idiomas:** Común, Lenguaje de ladrones, Enano Otras competencias: Herramientas de ladrón, Three-Dragon Ante
_____________________________________________
**Equipo:** Palanca, Ropas oscuras, Pack de explorador, Herramientas de ladrón  
**Riquezas:** 92 gp






# BESTIA FUNDIDORA
![large](./images/monsters/hellhound.jpg)
Estos seres están cubiertos por una dura piel metálica de la cabeza a los pies. Sus apéndices terminan en gruesas pezuñas que sueltan chispas al chocar contra el suelo. Un par de cuernos retorcidos bajan desde los lados de su cráneo casi hasta tocar su boca, y su espalda está coronada por espinas.  
**Armadura:** 12  
**Puntos de golpe:** 12 (Hit dice: 2d8+2)  
**Velocidad:** 40 **Size:** Medium  
**Iniciativa:** +4
_____________________________________________
**Skills** Atletismo +3  
**Sentidos** Infravisión 60 ft., Percepción pasiva 12  
**Proficiency bonus:** +2  
**Idiomas** N/A  
**Desafío** 1/2 (100 XP)  
_____________________________________________
|FUE|DES|CON|INT|SAB|CAR|
|:---:|:---:|:---:|:---:|:---:|:---:|
|12 (+1)|10 (+0)|14 (+2)|2 (-4)|12 (+1)|4 (-3)|
_____________________________________________
### COMBATE
**2 garras** (+2) 2d4+1 daño penetrante  
Las bestias fundidoras se esconden bajo el suelo, para después emboscar a las criaturas que sienten caminando cerca. Trabajan en grupos para derribar a sus enemigos y atacar usando sus afilados apéndices  
**Cavador:**Una fundidora puede atravesar Roca sólida a una velocidad de 5 pies. No deja un túnel utilizable a menos que así lo decida.  
**Mente colmena:** Las bestias fundidoras están en constante comunicación con cualquier otra en un rango de 30 pies. Toda la bestia fundidora dentro de los 30 pies de al menos otra bestia fundidora actúa en el mismo orden de iniciativa (hacer una sola tirada de iniciativa para todo el grupo).  
Una bestia fundidora recibe un bono de moral de +1 en los tiradas de salvación de Sabiduría por cada 3 otras bestia fundidora en un rango de 30 pies. Sin embargo, si una bestia falla una prueba de Sabiduría contra cualquier cosa que cause una sacudida, miedo, o pánico, todas los demás bestia fundidoras en el grupo sufren el mismo efecto.  
**Visión en la oscuridad:** Una bestia fundidora puede ver en luz tenue a 60 pies de ella como si fuera luz brillante, y en la oscuridad como si fuera luz tenue. No pueden distinguir el color en la oscuridad, solo tonos de gris.</tw-passagedata><tw-passagedata pid="33" name="Fichas de personajes" tags="lugares @fichas" position="379,845" size="100,100">
# PÍCARO (Wilbur)
![large](./images/fichas/wilbur-es-5.jpg)

# MAGO (Yonsee)
![large](./images/fichas/yonsee-es-5.jpg)

# GUERRERO (Monak)
![large](./images/fichas/monak-es-5.jpg)

# EXPLORADOR SEMIELFO (Raghar)
![large](./images/fichas/raghar-es-5.jpg)

# HECHICERO MEDIANO (Sr Pirs)
![large](./images/fichas/srpris-es-5.jpg)

# CLÉRIGO ELFO (Erendur)
![large](./images/fichas/erundur-es-5.jpg)</tw-passagedata></tw-storydata>

<script title="Twine engine code" data-main="harlowe">"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var _slicedToArray=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){/**
 * @license almond 0.3.3 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, http://github.com/requirejs/almond/LICENSE
 */
var requirejs,require,define;!function(e){function t(e,t){return v.call(e,t)}function n(e,t){var n,r,o,i,a,s,u,c,l,f,p,d,h=t&&t.split("/"),g=y.map,m=g&&g["*"]||{};if(e){for(e=e.split("/"),a=e.length-1,y.nodeIdCompat&&w.test(e[a])&&(e[a]=e[a].replace(w,"")),"."===e[0].charAt(0)&&h&&(d=h.slice(0,h.length-1),e=d.concat(e)),l=0;l<e.length;l++)if(p=e[l],"."===p)e.splice(l,1),l-=1;else if(".."===p){if(0===l||1===l&&".."===e[2]||".."===e[l-1])continue;l>0&&(e.splice(l-1,2),l-=2)}e=e.join("/")}if((h||m)&&g){for(n=e.split("/"),l=n.length;l>0;l-=1){if(r=n.slice(0,l).join("/"),h)for(f=h.length;f>0;f-=1)if(o=g[h.slice(0,f).join("/")],o&&(o=o[r])){i=o,s=l;break}if(i)break;!u&&m&&m[r]&&(u=m[r],c=l)}!i&&u&&(i=u,s=c),i&&(n.splice(0,s,i),e=n.join("/"))}return e}function r(t,n){return function(){var r=b.call(arguments,0);return"string"!=typeof r[0]&&1===r.length&&r.push(null),f.apply(e,r.concat([t,n]))}}function o(e){return function(t){return n(t,e)}}function i(e){return function(t){h[e]=t}}function a(n){if(t(g,n)){var r=g[n];delete g[n],m[n]=!0,l.apply(e,r)}if(!t(h,n)&&!t(m,n))throw new Error("No "+n);return h[n]}function s(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function u(e){return e?s(e):[]}function c(e){return function(){return y&&y.config&&y.config[e]||{}}}var l,f,p,d,h={},g={},y={},m={},v=Object.prototype.hasOwnProperty,b=[].slice,w=/\.js$/;p=function(e,t){var r,i=s(e),u=i[0],c=t[1];return e=i[1],u&&(u=n(u,c),r=a(u)),u?e=r&&r.normalize?r.normalize(e,o(c)):n(e,c):(e=n(e,c),i=s(e),u=i[0],e=i[1],u&&(r=a(u))),{f:u?u+"!"+e:e,n:e,pr:u,p:r}},d={require:function(e){return r(e)},exports:function(e){var t=h[e];return"undefined"!=typeof t?t:h[e]={}},module:function(e){return{id:e,uri:"",exports:h[e],config:c(e)}}},l=function(n,o,s,c){var l,f,y,v,b,w,x,T=[],O="undefined"==typeof s?"undefined":_typeof(s);if(c=c||n,w=u(c),"undefined"===O||"function"===O){for(o=!o.length&&s.length?["require","exports","module"]:o,b=0;b<o.length;b+=1)if(v=p(o[b],w),f=v.f,"require"===f)T[b]=d.require(n);else if("exports"===f)T[b]=d.exports(n),x=!0;else if("module"===f)l=T[b]=d.module(n);else if(t(h,f)||t(g,f)||t(m,f))T[b]=a(f);else{if(!v.p)throw new Error(n+" missing "+f);v.p.load(v.n,r(c,!0),i(f),{}),T[b]=h[f]}y=s?s.apply(h[n],T):void 0,n&&(l&&l.exports!==e&&l.exports!==h[n]?h[n]=l.exports:y===e&&x||(h[n]=y))}else n&&(h[n]=s)},requirejs=require=f=function(t,n,r,o,i){if("string"==typeof t)return d[t]?d[t](n):a(p(t,u(n)).f);if(!t.splice){if(y=t,y.deps&&f(y.deps,y.callback),!n)return;n.splice?(t=n,n=r,r=null):t=e}return n=n||function(){},"function"==typeof r&&(r=o,o=i),o?l(e,t,n,r):setTimeout(function(){l(e,t,n,r)},4),f},f.config=function(e){return f(e)},requirejs._defined=h,define=function(e,n,r){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");n.splice||(r=n,n=[]),t(h,e)||t(g,e)||(g[e]=[e,n,r])},define.amd={jQuery:!0}}(),define("almond",function(){}),function(e,t){"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(e,t){t=t||te;var n=t.createElement("script");n.text=e,t.head.appendChild(n).parentNode.removeChild(n)}function r(e){var t=!!e&&"length"in e&&e.length,n=he.type(e);return"function"===n||he.isWindow(e)?!1:"array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e}function o(e,t,n){return he.isFunction(t)?he.grep(e,function(e,r){return!!t.call(e,r,e)!==n}):t.nodeType?he.grep(e,function(e){return e===t!==n}):"string"!=typeof t?he.grep(e,function(e){return ae.call(t,e)>-1!==n}):je.test(t)?he.filter(t,e,n):(t=he.filter(t,e),he.grep(e,function(e){return ae.call(t,e)>-1!==n&&1===e.nodeType}))}function i(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function a(e){var t={};return he.each(e.match(Ne)||[],function(e,n){t[n]=!0}),t}function s(e){return e}function u(e){throw e}function c(e,t,n){var r;try{e&&he.isFunction(r=e.promise)?r.call(e).done(t).fail(n):e&&he.isFunction(r=e.then)?r.call(e,t,n):t.call(void 0,e)}catch(e){n.call(void 0,e)}}function l(){te.removeEventListener("DOMContentLoaded",l),e.removeEventListener("load",l),he.ready()}function f(){this.expando=he.expando+f.uid++}function p(e){return"true"===e?!0:"false"===e?!1:"null"===e?null:e===+e+""?+e:Le.test(e)?JSON.parse(e):e}function d(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(qe,"-$&").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n=p(n)}catch(e){}De.set(e,t,n)}else n=void 0;return n}function h(e,t,n,r){var o,i=1,a=20,s=r?function(){return r.cur()}:function(){return he.css(e,t,"")},u=s(),c=n&&n[3]||(he.cssNumber[t]?"":"px"),l=(he.cssNumber[t]||"px"!==c&&+u)&&He.exec(he.css(e,t));if(l&&l[3]!==c){c=c||l[3],n=n||[],l=+u||1;do i=i||".5",l/=i,he.style(e,t,l+c);while(i!==(i=s()/u)&&1!==i&&--a)}return n&&(l=+l||+u||0,o=n[1]?l+(n[1]+1)*n[2]:+n[2],r&&(r.unit=c,r.start=l,r.end=o)),o}function g(e){var t,n=e.ownerDocument,r=e.nodeName,o=Be[r];return o?o:(t=n.body.appendChild(n.createElement(r)),o=he.css(t,"display"),t.parentNode.removeChild(t),"none"===o&&(o="block"),Be[r]=o,o)}function y(e,t){for(var n,r,o=[],i=0,a=e.length;a>i;i++)r=e[i],r.style&&(n=r.style.display,t?("none"===n&&(o[i]=Fe.get(r,"display")||null,o[i]||(r.style.display="")),""===r.style.display&&ze(r)&&(o[i]=g(r))):"none"!==n&&(o[i]="none",Fe.set(r,"display",n)));for(i=0;a>i;i++)null!=o[i]&&(e[i].style.display=o[i]);return e}function m(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&he.nodeName(e,t)?he.merge([e],n):n}function v(e,t){for(var n=0,r=e.length;r>n;n++)Fe.set(e[n],"globalEval",!t||Fe.get(t[n],"globalEval"))}function b(e,t,n,r,o){for(var i,a,s,u,c,l,f=t.createDocumentFragment(),p=[],d=0,h=e.length;h>d;d++)if(i=e[d],i||0===i)if("object"===he.type(i))he.merge(p,i.nodeType?[i]:i);else if(Je.test(i)){for(a=a||f.appendChild(t.createElement("div")),s=(Ue.exec(i)||["",""])[1].toLowerCase(),u=Xe[s]||Xe._default,a.innerHTML=u[1]+he.htmlPrefilter(i)+u[2],l=u[0];l--;)a=a.lastChild;he.merge(p,a.childNodes),a=f.firstChild,a.textContent=""}else p.push(t.createTextNode(i));for(f.textContent="",d=0;i=p[d++];)if(r&&he.inArray(i,r)>-1)o&&o.push(i);else if(c=he.contains(i.ownerDocument,i),a=m(f.appendChild(i),"script"),c&&v(a),n)for(l=0;i=a[l++];)Ge.test(i.type||"")&&n.push(i);return f}function w(){return!0}function x(){return!1}function T(){try{return te.activeElement}catch(e){}}function O(e,t,n,r,o,i){var a,s;if("object"===("undefined"==typeof t?"undefined":_typeof(t))){"string"!=typeof n&&(r=r||n,n=void 0);for(s in t)O(e,s,n,r,t[s],i);return e}if(null==r&&null==o?(o=n,r=n=void 0):null==o&&("string"==typeof n?(o=r,r=void 0):(o=r,r=n,n=void 0)),o===!1)o=x;else if(!o)return e;return 1===i&&(a=o,o=function(e){return he().off(e),a.apply(this,arguments)},o.guid=a.guid||(a.guid=he.guid++)),e.each(function(){he.event.add(this,t,o,r,n)})}function j(e,t){return he.nodeName(e,"table")&&he.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e:e}function S(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function k(e){var t=rt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function C(e,t){var n,r,o,i,a,s,u,c;if(1===t.nodeType){if(Fe.hasData(e)&&(i=Fe.access(e),a=Fe.set(t,i),c=i.events)){delete a.handle,a.events={};for(o in c)for(n=0,r=c[o].length;r>n;n++)he.event.add(t,o,c[o][n])}De.hasData(e)&&(s=De.access(e),u=he.extend({},s),De.set(t,u))}}function A(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Ve.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function E(e,t,r,o){t=oe.apply([],t);var i,a,s,u,c,l,f=0,p=e.length,d=p-1,h=t[0],g=he.isFunction(h);if(g||p>1&&"string"==typeof h&&!pe.checkClone&&nt.test(h))return e.each(function(n){var i=e.eq(n);g&&(t[0]=h.call(this,n,i.html())),E(i,t,r,o)});if(p&&(i=b(t,e[0].ownerDocument,!1,e,o),a=i.firstChild,1===i.childNodes.length&&(i=a),a||o)){for(s=he.map(m(i,"script"),S),u=s.length;p>f;f++)c=i,f!==d&&(c=he.clone(c,!0,!0),u&&he.merge(s,m(c,"script"))),r.call(e[f],c,f);if(u)for(l=s[s.length-1].ownerDocument,he.map(s,k),f=0;u>f;f++)c=s[f],Ge.test(c.type||"")&&!Fe.access(c,"globalEval")&&he.contains(l,c)&&(c.src?he._evalUrl&&he._evalUrl(c.src):n(c.textContent.replace(ot,""),l))}return e}function N(e,t,n){for(var r,o=t?he.filter(t,e):e,i=0;null!=(r=o[i]);i++)n||1!==r.nodeType||he.cleanData(m(r)),r.parentNode&&(n&&he.contains(r.ownerDocument,r)&&v(m(r,"script")),r.parentNode.removeChild(r));return e}function P(e,t,n){var r,o,i,a,s=e.style;return n=n||st(e),n&&(a=n.getPropertyValue(t)||n[t],""!==a||he.contains(e.ownerDocument,e)||(a=he.style(e,t)),!pe.pixelMarginRight()&&at.test(a)&&it.test(t)&&(r=s.width,o=s.minWidth,i=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=o,s.maxWidth=i)),void 0!==a?a+"":a}function I(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function _(e){if(e in pt)return e;for(var t=e[0].toUpperCase()+e.slice(1),n=ft.length;n--;)if(e=ft[n]+t,e in pt)return e}function M(e,t,n){var r=He.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function F(e,t,n,r,o){var i,a=0;for(i=n===(r?"border":"content")?4:"width"===t?1:0;4>i;i+=2)"margin"===n&&(a+=he.css(e,n+$e[i],!0,o)),r?("content"===n&&(a-=he.css(e,"padding"+$e[i],!0,o)),"margin"!==n&&(a-=he.css(e,"border"+$e[i]+"Width",!0,o))):(a+=he.css(e,"padding"+$e[i],!0,o),"padding"!==n&&(a+=he.css(e,"border"+$e[i]+"Width",!0,o)));return a}function D(e,t,n){var r,o=!0,i=st(e),a="border-box"===he.css(e,"boxSizing",!1,i);if(e.getClientRects().length&&(r=e.getBoundingClientRect()[t]),0>=r||null==r){if(r=P(e,t,i),(0>r||null==r)&&(r=e.style[t]),at.test(r))return r;o=a&&(pe.boxSizingReliable()||r===e.style[t]),r=parseFloat(r)||0}return r+F(e,t,n||(a?"border":"content"),o,i)+"px"}function L(e,t,n,r,o){return new L.prototype.init(e,t,n,r,o)}function q(){ht&&(e.requestAnimationFrame(q),he.fx.tick())}function R(){return e.setTimeout(function(){dt=void 0}),dt=he.now()}function H(e,t){var n,r=0,o={height:e};for(t=t?1:0;4>r;r+=2-t)n=$e[r],o["margin"+n]=o["padding"+n]=e;return t&&(o.opacity=o.width=e),o}function $(e,t,n){for(var r,o=(B.tweeners[t]||[]).concat(B.tweeners["*"]),i=0,a=o.length;a>i;i++)if(r=o[i].call(n,t,e))return r}function z(e,t,n){var r,o,i,a,s,u,c,l,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ze(e),m=Fe.get(e,"fxshow");n.queue||(a=he._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,he.queue(e,"fx").length||a.empty.fire()})}));for(r in t)if(o=t[r],gt.test(o)){if(delete t[r],i=i||"toggle"===o,o===(g?"hide":"show")){if("show"!==o||!m||void 0===m[r])continue;g=!0}d[r]=m&&m[r]||he.style(e,r)}if(u=!he.isEmptyObject(t),u||!he.isEmptyObject(d)){f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],c=m&&m.display,null==c&&(c=Fe.get(e,"display")),l=he.css(e,"display"),"none"===l&&(c?l=c:(y([e],!0),c=e.style.display||c,l=he.css(e,"display"),y([e]))),("inline"===l||"inline-block"===l&&null!=c)&&"none"===he.css(e,"float")&&(u||(p.done(function(){h.display=c}),null==c&&(l=h.display,c="none"===l?"":l)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1;for(r in d)u||(m?"hidden"in m&&(g=m.hidden):m=Fe.access(e,"fxshow",{display:c}),i&&(m.hidden=!g),g&&y([e],!0),p.done(function(){g||y([e]),Fe.remove(e,"fxshow");for(r in d)he.style(e,r,d[r])})),u=$(g?m[r]:0,r,p),r in m||(m[r]=u.start,g&&(u.end=u.start,u.start=0))}}function W(e,t){var n,r,o,i,a;for(n in e)if(r=he.camelCase(n),o=t[r],i=e[n],he.isArray(i)&&(o=i[1],i=e[n]=i[0]),n!==r&&(e[r]=i,delete e[n]),a=he.cssHooks[r],a&&"expand"in a){i=a.expand(i),delete e[r];for(n in i)n in e||(e[n]=i[n],t[n]=o)}else t[r]=o}function B(e,t,n){var r,o,i=0,a=B.prefilters.length,s=he.Deferred().always(function(){delete u.elem}),u=function(){if(o)return!1;for(var t=dt||R(),n=Math.max(0,c.startTime+c.duration-t),r=n/c.duration||0,i=1-r,a=0,u=c.tweens.length;u>a;a++)c.tweens[a].run(i);return s.notifyWith(e,[c,i,n]),1>i&&u?n:(s.resolveWith(e,[c]),!1)},c=s.promise({elem:e,props:he.extend({},t),opts:he.extend(!0,{specialEasing:{},easing:he.easing._default},n),originalProperties:t,originalOptions:n,startTime:dt||R(),duration:n.duration,tweens:[],createTween:function(t,n){var r=he.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(r),r},stop:function(t){var n=0,r=t?c.tweens.length:0;if(o)return this;for(o=!0;r>n;n++)c.tweens[n].run(1);return t?(s.notifyWith(e,[c,1,0]),s.resolveWith(e,[c,t])):s.rejectWith(e,[c,t]),this}}),l=c.props;for(W(l,c.opts.specialEasing);a>i;i++)if(r=B.prefilters[i].call(c,e,l,c.opts))return he.isFunction(r.stop)&&(he._queueHooks(c.elem,c.opts.queue).stop=he.proxy(r.stop,r)),r;return he.map(l,$,c),he.isFunction(c.opts.start)&&c.opts.start.call(e,c),he.fx.timer(he.extend(u,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function V(e){var t=e.match(Ne)||[];return t.join(" ")}function U(e){return e.getAttribute&&e.getAttribute("class")||""}function G(e,t,n,r){var o;if(he.isArray(t))he.each(t,function(t,o){n||kt.test(e)?r(e,o):G(e+"["+("object"===("undefined"==typeof o?"undefined":_typeof(o))&&null!=o?t:"")+"]",o,n,r)});else if(n||"object"!==he.type(t))r(e,t);else for(o in t)G(e+"["+o+"]",t[o],n,r)}function X(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,o=0,i=t.toLowerCase().match(Ne)||[];if(he.isFunction(n))for(;r=i[o++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function J(e,t,n,r){function o(s){var u;return i[s]=!0,he.each(e[s]||[],function(e,s){var c=s(t,n,r);return"string"!=typeof c||a||i[c]?a?!(u=c):void 0:(t.dataTypes.unshift(c),o(c),!1)}),u}var i={},a=e===qt;return o(t.dataTypes[0])||!i["*"]&&o("*")}function Y(e,t){var n,r,o=he.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((o[n]?e:r||(r={}))[n]=t[n]);return r&&he.extend(!0,e,r),e}function Q(e,t,n){for(var r,o,i,a,s=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(o in s)if(s[o]&&s[o].test(r)){u.unshift(o);break}if(u[0]in n)i=u[0];else{for(o in n){if(!u[0]||e.converters[o+" "+u[0]]){i=o;break}a||(a=o)}i=i||a}return i?(i!==u[0]&&u.unshift(i),n[i]):void 0}function Z(e,t,n,r){var o,i,a,s,u,c={},l=e.dataTypes.slice();if(l[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(i=l.shift();i;)if(e.responseFields[i]&&(n[e.responseFields[i]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=i,i=l.shift())if("*"===i)i=u;else if("*"!==u&&u!==i){if(a=c[u+" "+i]||c["* "+i],!a)for(o in c)if(s=o.split(" "),s[1]===i&&(a=c[u+" "+s[0]]||c["* "+s[0]])){a===!0?a=c[o]:c[o]!==!0&&(i=s[0],l.unshift(s[1]));break}if(a!==!0)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+i}}}return{state:"success",data:t}}function K(e){return he.isWindow(e)?e:9===e.nodeType&&e.defaultView}var ee=[],te=e.document,ne=Object.getPrototypeOf,re=ee.slice,oe=ee.concat,ie=ee.push,ae=ee.indexOf,se={},ue=se.toString,ce=se.hasOwnProperty,le=ce.toString,fe=le.call(Object),pe={},de="3.1.1",he=function e(t,n){return new e.fn.init(t,n)},ge=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ye=/^-ms-/,me=/-([a-z])/g,ve=function(e,t){return t.toUpperCase()};he.fn=he.prototype={jquery:de,constructor:he,length:0,toArray:function(){return re.call(this)},get:function(e){return null==e?re.call(this):0>e?this[e+this.length]:this[e]},pushStack:function(e){var t=he.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return he.each(this,e)},map:function(e){return this.pushStack(he.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(re.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:ie,sort:ee.sort,splice:ee.splice},he.extend=he.fn.extend=function(){var e,t,n,r,o,i,a=arguments[0]||{},s=1,u=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"===("undefined"==typeof a?"undefined":_typeof(a))||he.isFunction(a)||(a={}),s===u&&(a=this,s--);u>s;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],r=e[t],a!==r&&(c&&r&&(he.isPlainObject(r)||(o=he.isArray(r)))?(o?(o=!1,i=n&&he.isArray(n)?n:[]):i=n&&he.isPlainObject(n)?n:{},a[t]=he.extend(c,i,r)):void 0!==r&&(a[t]=r));return a},he.extend({expando:"jQuery"+(de+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===he.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){var t=he.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},isPlainObject:function(e){var t,n;return e&&"[object Object]"===ue.call(e)?(t=ne(e))?(n=ce.call(t,"constructor")&&t.constructor,"function"==typeof n&&le.call(n)===fe):!0:!1},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"===("undefined"==typeof e?"undefined":_typeof(e))||"function"==typeof e?se[ue.call(e)]||"object":"undefined"==typeof e?"undefined":_typeof(e)},globalEval:function(e){n(e)},camelCase:function(e){return e.replace(ye,"ms-").replace(me,ve)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var n,o=0;if(r(e))for(n=e.length;n>o&&t.call(e[o],o,e[o])!==!1;o++);else for(o in e)if(t.call(e[o],o,e[o])===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(ge,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(r(Object(e))?he.merge(n,"string"==typeof e?[e]:e):ie.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:ae.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,o=e.length;n>r;r++)e[o++]=t[r];return e.length=o,e},grep:function(e,t,n){for(var r,o=[],i=0,a=e.length,s=!n;a>i;i++)r=!t(e[i],i),r!==s&&o.push(e[i]);return o},map:function(e,t,n){var o,i,a=0,s=[];if(r(e))for(o=e.length;o>a;a++)i=t(e[a],a,n),null!=i&&s.push(i);else for(a in e)i=t(e[a],a,n),null!=i&&s.push(i);return oe.apply([],s)},guid:1,proxy:function e(t,n){var r,o,e;return"string"==typeof n&&(r=t[n],n=t,t=r),he.isFunction(t)?(o=re.call(arguments,2),e=function(){return t.apply(n||this,o.concat(re.call(arguments)))},e.guid=t.guid=t.guid||he.guid++,e):void 0},now:Date.now,support:pe}),"function"==typeof Symbol&&(he.fn[Symbol.iterator]=ee[Symbol.iterator]),he.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){se["[object "+t+"]"]=t.toLowerCase()});var be=function(e){function t(e,t,n,r){var o,i,a,s,u,c,l,p=t&&t.ownerDocument,h=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==h&&9!==h&&11!==h)return n;if(!r&&((t?t.ownerDocument||t:$)!==_&&I(t),t=t||_,F)){if(11!==h&&(u=me.exec(e)))if(o=u[1]){if(9===h){if(!(a=t.getElementById(o)))return n;if(a.id===o)return n.push(a),n}else if(p&&(a=p.getElementById(o))&&R(t,a)&&a.id===o)return n.push(a),n}else{if(u[2])return Z.apply(n,t.getElementsByTagName(e)),n;if((o=u[3])&&T.getElementsByClassName&&t.getElementsByClassName)return Z.apply(n,t.getElementsByClassName(o)),n}if(!(!T.qsa||U[e+" "]||D&&D.test(e))){if(1!==h)p=t,l=e;else if("object"!==t.nodeName.toLowerCase()){for((s=t.getAttribute("id"))?s=s.replace(xe,Te):t.setAttribute("id",s=H),c=k(e),i=c.length;i--;)c[i]="#"+s+" "+d(c[i]);l=c.join(","),p=ve.test(e)&&f(t.parentNode)||t}if(l)try{return Z.apply(n,p.querySelectorAll(l)),n}catch(e){}finally{s===H&&t.removeAttribute("id")}}}return A(e.replace(se,"$1"),t,n,r)}function n(){function e(n,r){return t.push(n+" ")>O.cacheLength&&delete e[t.shift()],e[n+" "]=r}var t=[];return e}function r(e){return e[H]=!0,e}function o(e){var t=_.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function i(e,t){for(var n=e.split("|"),r=n.length;r--;)O.attrHandle[n[r]]=t}function a(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function s(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function u(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function c(e){return function(t){return"form"in t?t.parentNode&&t.disabled===!1?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&je(t)===e:t.disabled===e:"label"in t?t.disabled===e:!1}}function l(e){return r(function(t){return t=+t,r(function(n,r){for(var o,i=e([],n.length,t),a=i.length;a--;)n[o=i[a]]&&(n[o]=!(r[o]=n[o]))})})}function f(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function p(){}function d(e){for(var t=0,n=e.length,r="";n>t;t++)r+=e[t].value;return r}function h(e,t,n){var r=t.dir,o=t.next,i=o||r,a=n&&"parentNode"===i,s=W++;return t.first?function(t,n,o){for(;t=t[r];)if(1===t.nodeType||a)return e(t,n,o);return!1}:function(t,n,u){var c,l,f,p=[z,s];if(u){for(;t=t[r];)if((1===t.nodeType||a)&&e(t,n,u))return!0}else for(;t=t[r];)if(1===t.nodeType||a)if(f=t[H]||(t[H]={}),l=f[t.uniqueID]||(f[t.uniqueID]={}),o&&o===t.nodeName.toLowerCase())t=t[r]||t;else{if((c=l[i])&&c[0]===z&&c[1]===s)return p[2]=c[2];if(l[i]=p,p[2]=e(t,n,u))return!0}return!1}}function g(e){return e.length>1?function(t,n,r){for(var o=e.length;o--;)if(!e[o](t,n,r))return!1;return!0}:e[0]}function y(e,n,r){for(var o=0,i=n.length;i>o;o++)t(e,n[o],r);return r}function m(e,t,n,r,o){for(var i,a=[],s=0,u=e.length,c=null!=t;u>s;s++)(i=e[s])&&(!n||n(i,r,o))&&(a.push(i),c&&t.push(s));return a}function v(e,t,n,o,i,a){return o&&!o[H]&&(o=v(o)),i&&!i[H]&&(i=v(i,a)),r(function(r,a,s,u){var c,l,f,p=[],d=[],h=a.length,g=r||y(t||"*",s.nodeType?[s]:s,[]),v=!e||!r&&t?g:m(g,p,e,s,u),b=n?i||(r?e:h||o)?[]:a:v;if(n&&n(v,b,s,u),o)for(c=m(b,d),o(c,[],s,u),l=c.length;l--;)(f=c[l])&&(b[d[l]]=!(v[d[l]]=f));if(r){if(i||e){if(i){for(c=[],l=b.length;l--;)(f=b[l])&&c.push(v[l]=f);i(null,b=[],c,u)}for(l=b.length;l--;)(f=b[l])&&(c=i?ee(r,f):p[l])>-1&&(r[c]=!(a[c]=f))}}else b=m(b===a?b.splice(h,b.length):b),i?i(null,a,b,u):Z.apply(a,b)})}function b(e){for(var t,n,r,o=e.length,i=O.relative[e[0].type],a=i||O.relative[" "],s=i?1:0,u=h(function(e){return e===t},a,!0),c=h(function(e){return ee(t,e)>-1},a,!0),l=[function(e,n,r){var o=!i&&(r||n!==E)||((t=n).nodeType?u(e,n,r):c(e,n,r));return t=null,o}];o>s;s++)if(n=O.relative[e[s].type])l=[h(g(l),n)];else{if(n=O.filter[e[s].type].apply(null,e[s].matches),n[H]){for(r=++s;o>r&&!O.relative[e[r].type];r++);return v(s>1&&g(l),s>1&&d(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(se,"$1"),n,r>s&&b(e.slice(s,r)),o>r&&b(e=e.slice(r)),o>r&&d(e))}l.push(n)}return g(l)}function w(e,n){var o=n.length>0,i=e.length>0,a=function(r,a,s,u,c){var l,f,p,d=0,h="0",g=r&&[],y=[],v=E,b=r||i&&O.find.TAG("*",c),w=z+=null==v?1:Math.random()||.1,x=b.length;for(c&&(E=a===_||a||c);h!==x&&null!=(l=b[h]);h++){if(i&&l){for(f=0,a||l.ownerDocument===_||(I(l),s=!F);p=e[f++];)if(p(l,a||_,s)){u.push(l);break}c&&(z=w)}o&&((l=!p&&l)&&d--,r&&g.push(l))}if(d+=h,o&&h!==d){for(f=0;p=n[f++];)p(g,y,a,s);if(r){if(d>0)for(;h--;)g[h]||y[h]||(y[h]=Y.call(u));y=m(y)}Z.apply(u,y),c&&!r&&y.length>0&&d+n.length>1&&t.uniqueSort(u)}return c&&(z=w,E=v),g};return o?r(a):a}var x,T,O,j,S,k,C,A,E,N,P,I,_,M,F,D,L,q,R,H="sizzle"+1*new Date,$=e.document,z=0,W=0,B=n(),V=n(),U=n(),G=function(e,t){return e===t&&(P=!0),0},X={}.hasOwnProperty,J=[],Y=J.pop,Q=J.push,Z=J.push,K=J.slice,ee=function(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ne="[\\x20\\t\\r\\n\\f]",re="(?:\\\\.|[\\w-]|[^\x00-\\xa0])+",oe="\\["+ne+"*("+re+")(?:"+ne+"*([*^$|!~]?=)"+ne+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+re+"))|)"+ne+"*\\]",ie=":("+re+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+oe+")*)|.*)\\)|)",ae=new RegExp(ne+"+","g"),se=new RegExp("^"+ne+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ne+"+$","g"),ue=new RegExp("^"+ne+"*,"+ne+"*"),ce=new RegExp("^"+ne+"*([>+~]|"+ne+")"+ne+"*"),le=new RegExp("="+ne+"*([^\\]'\"]*?)"+ne+"*\\]","g"),fe=new RegExp(ie),pe=new RegExp("^"+re+"$"),de={ID:new RegExp("^#("+re+")"),CLASS:new RegExp("^\\.("+re+")"),TAG:new RegExp("^("+re+"|[*])"),ATTR:new RegExp("^"+oe),PSEUDO:new RegExp("^"+ie),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ne+"*(even|odd|(([+-]|)(\\d*)n|)"+ne+"*(?:([+-]|)"+ne+"*(\\d+)|))"+ne+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ne+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ne+"*((?:-\\d)?\\d*)"+ne+"*\\)|)(?=[^-]|$)","i")},he=/^(?:input|select|textarea|button)$/i,ge=/^h\d$/i,ye=/^[^{]+\{\s*\[native \w/,me=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ve=/[+~]/,be=new RegExp("\\\\([\\da-f]{1,6}"+ne+"?|("+ne+")|.)","ig"),we=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},xe=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Te=function(e,t){return t?"\x00"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},Oe=function(){I()},je=h(function(e){return e.disabled===!0&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{Z.apply(J=K.call($.childNodes),$.childNodes),J[$.childNodes.length].nodeType}catch(e){Z={apply:J.length?function(e,t){Q.apply(e,K.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}T=t.support={},S=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},I=t.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:$;return r!==_&&9===r.nodeType&&r.documentElement?(_=r,M=_.documentElement,F=!S(_),$!==_&&(n=_.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",Oe,!1):n.attachEvent&&n.attachEvent("onunload",Oe)),T.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),T.getElementsByTagName=o(function(e){return e.appendChild(_.createComment("")),!e.getElementsByTagName("*").length}),T.getElementsByClassName=ye.test(_.getElementsByClassName),T.getById=o(function(e){return M.appendChild(e).id=H,!_.getElementsByName||!_.getElementsByName(H).length}),T.getById?(O.filter.ID=function(e){var t=e.replace(be,we);return function(e){return e.getAttribute("id")===t}},O.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&F){var n=t.getElementById(e);return n?[n]:[]}}):(O.filter.ID=function(e){var t=e.replace(be,we);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},O.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&F){var n,r,o,i=t.getElementById(e);if(i){if(n=i.getAttributeNode("id"),n&&n.value===e)return[i];for(o=t.getElementsByName(e),r=0;i=o[r++];)if(n=i.getAttributeNode("id"),n&&n.value===e)return[i]}return[]}}),O.find.TAG=T.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):T.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],o=0,i=t.getElementsByTagName(e);if("*"===e){for(;n=i[o++];)1===n.nodeType&&r.push(n);return r}return i},O.find.CLASS=T.getElementsByClassName&&function(e,t){return"undefined"!=typeof t.getElementsByClassName&&F?t.getElementsByClassName(e):void 0},L=[],D=[],(T.qsa=ye.test(_.querySelectorAll))&&(o(function(e){M.appendChild(e).innerHTML="<a id='"+H+"'></a><select id='"+H+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&D.push("[*^$]="+ne+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||D.push("\\["+ne+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+H+"-]").length||D.push("~="),e.querySelectorAll(":checked").length||D.push(":checked"),e.querySelectorAll("a#"+H+"+*").length||D.push(".#.+[+~]")}),o(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=_.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&D.push("name"+ne+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&D.push(":enabled",":disabled"),M.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&D.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),D.push(",.*:")})),(T.matchesSelector=ye.test(q=M.matches||M.webkitMatchesSelector||M.mozMatchesSelector||M.oMatchesSelector||M.msMatchesSelector))&&o(function(e){T.disconnectedMatch=q.call(e,"*"),q.call(e,"[s!='']:x"),L.push("!=",ie)}),D=D.length&&new RegExp(D.join("|")),L=L.length&&new RegExp(L.join("|")),t=ye.test(M.compareDocumentPosition),R=t||ye.test(M.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},G=t?function(e,t){if(e===t)return P=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n?n:(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!T.sortDetached&&t.compareDocumentPosition(e)===n?e===_||e.ownerDocument===$&&R($,e)?-1:t===_||t.ownerDocument===$&&R($,t)?1:N?ee(N,e)-ee(N,t):0:4&n?-1:1)}:function(e,t){if(e===t)return P=!0,0;var n,r=0,o=e.parentNode,i=t.parentNode,s=[e],u=[t];if(!o||!i)return e===_?-1:t===_?1:o?-1:i?1:N?ee(N,e)-ee(N,t):0;if(o===i)return a(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)u.unshift(n);for(;s[r]===u[r];)r++;return r?a(s[r],u[r]):s[r]===$?-1:u[r]===$?1:0},_):_},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==_&&I(e),n=n.replace(le,"='$1']"),!(!T.matchesSelector||!F||U[n+" "]||L&&L.test(n)||D&&D.test(n)))try{var r=q.call(e,n);if(r||T.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){}return t(n,_,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==_&&I(e),R(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==_&&I(e);var n=O.attrHandle[t.toLowerCase()],r=n&&X.call(O.attrHandle,t.toLowerCase())?n(e,t,!F):void 0;return void 0!==r?r:T.attributes||!F?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},t.escape=function(e){return(e+"").replace(xe,Te)},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],r=0,o=0;if(P=!T.detectDuplicates,N=!T.sortStable&&e.slice(0),e.sort(G),P){for(;t=e[o++];)t===e[o]&&(r=n.push(o));for(;r--;)e.splice(n[r],1)}return N=null,e},j=t.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=j(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[r++];)n+=j(t);return n},O=t.selectors={cacheLength:50,createPseudo:r,match:de,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(be,we),e[3]=(e[3]||e[4]||e[5]||"").replace(be,we),
"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return de.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&fe.test(n)&&(t=k(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(be,we).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=B[e+" "];return t||(t=new RegExp("(^|"+ne+")"+e+"("+ne+"|$)"))&&B(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,r){return function(o){var i=t.attr(o,e);return null==i?"!="===n:n?(i+="","="===n?i===r:"!="===n?i!==r:"^="===n?r&&0===i.indexOf(r):"*="===n?r&&i.indexOf(r)>-1:"$="===n?r&&i.slice(-r.length)===r:"~="===n?(" "+i.replace(ae," ")+" ").indexOf(r)>-1:"|="===n?i===r||i.slice(0,r.length+1)===r+"-":!1):!0}},CHILD:function(e,t,n,r,o){var i="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===o?function(e){return!!e.parentNode}:function(t,n,u){var c,l,f,p,d,h,g=i!==a?"nextSibling":"previousSibling",y=t.parentNode,m=s&&t.nodeName.toLowerCase(),v=!u&&!s,b=!1;if(y){if(i){for(;g;){for(p=t;p=p[g];)if(s?p.nodeName.toLowerCase()===m:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?y.firstChild:y.lastChild],a&&v){for(p=y,f=p[H]||(p[H]={}),l=f[p.uniqueID]||(f[p.uniqueID]={}),c=l[e]||[],d=c[0]===z&&c[1],b=d&&c[2],p=d&&y.childNodes[d];p=++d&&p&&p[g]||(b=d=0)||h.pop();)if(1===p.nodeType&&++b&&p===t){l[e]=[z,d,b];break}}else if(v&&(p=t,f=p[H]||(p[H]={}),l=f[p.uniqueID]||(f[p.uniqueID]={}),c=l[e]||[],d=c[0]===z&&c[1],b=d),b===!1)for(;(p=++d&&p&&p[g]||(b=d=0)||h.pop())&&((s?p.nodeName.toLowerCase()!==m:1!==p.nodeType)||!++b||(v&&(f=p[H]||(p[H]={}),l=f[p.uniqueID]||(f[p.uniqueID]={}),l[e]=[z,b]),p!==t)););return b-=o,b===r||b%r===0&&b/r>=0}}},PSEUDO:function(e,n){var o,i=O.pseudos[e]||O.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return i[H]?i(n):i.length>1?(o=[e,e,"",n],O.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,t){for(var r,o=i(e,n),a=o.length;a--;)r=ee(e,o[a]),e[r]=!(t[r]=o[a])}):function(e){return i(e,0,o)}):i}},pseudos:{not:r(function(e){var t=[],n=[],o=C(e.replace(se,"$1"));return o[H]?r(function(e,t,n,r){for(var i,a=o(e,null,r,[]),s=e.length;s--;)(i=a[s])&&(e[s]=!(t[s]=i))}):function(e,r,i){return t[0]=e,o(t,null,i,n),t[0]=null,!n.pop()}}),has:r(function(e){return function(n){return t(e,n).length>0}}),contains:r(function(e){return e=e.replace(be,we),function(t){return(t.textContent||t.innerText||j(t)).indexOf(e)>-1}}),lang:r(function(e){return pe.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(be,we).toLowerCase(),function(t){var n;do if(n=F?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===M},focus:function(e){return e===_.activeElement&&(!_.hasFocus||_.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:c(!1),disabled:c(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!O.pseudos.empty(e)},header:function(e){return ge.test(e.nodeName)},input:function(e){return he.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:l(function(){return[0]}),last:l(function(e,t){return[t-1]}),eq:l(function(e,t,n){return[0>n?n+t:n]}),even:l(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:l(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:l(function(e,t,n){for(var r=0>n?n+t:n;--r>=0;)e.push(r);return e}),gt:l(function(e,t,n){for(var r=0>n?n+t:n;++r<t;)e.push(r);return e})}},O.pseudos.nth=O.pseudos.eq;for(x in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})O.pseudos[x]=s(x);for(x in{submit:!0,reset:!0})O.pseudos[x]=u(x);return p.prototype=O.filters=O.pseudos,O.setFilters=new p,k=t.tokenize=function(e,n){var r,o,i,a,s,u,c,l=V[e+" "];if(l)return n?0:l.slice(0);for(s=e,u=[],c=O.preFilter;s;){(!r||(o=ue.exec(s)))&&(o&&(s=s.slice(o[0].length)||s),u.push(i=[])),r=!1,(o=ce.exec(s))&&(r=o.shift(),i.push({value:r,type:o[0].replace(se," ")}),s=s.slice(r.length));for(a in O.filter)!(o=de[a].exec(s))||c[a]&&!(o=c[a](o))||(r=o.shift(),i.push({value:r,type:a,matches:o}),s=s.slice(r.length));if(!r)break}return n?s.length:s?t.error(e):V(e,u).slice(0)},C=t.compile=function(e,t){var n,r=[],o=[],i=U[e+" "];if(!i){for(t||(t=k(e)),n=t.length;n--;)i=b(t[n]),i[H]?r.push(i):o.push(i);i=U(e,w(o,r)),i.selector=e}return i},A=t.select=function(e,t,n,r){var o,i,a,s,u,c="function"==typeof e&&e,l=!r&&k(e=c.selector||e);if(n=n||[],1===l.length){if(i=l[0]=l[0].slice(0),i.length>2&&"ID"===(a=i[0]).type&&9===t.nodeType&&F&&O.relative[i[1].type]){if(t=(O.find.ID(a.matches[0].replace(be,we),t)||[])[0],!t)return n;c&&(t=t.parentNode),e=e.slice(i.shift().value.length)}for(o=de.needsContext.test(e)?0:i.length;o--&&(a=i[o],!O.relative[s=a.type]);)if((u=O.find[s])&&(r=u(a.matches[0].replace(be,we),ve.test(i[0].type)&&f(t.parentNode)||t))){if(i.splice(o,1),e=r.length&&d(i),!e)return Z.apply(n,r),n;break}}return(c||C(e,l))(r,t,!F,n,!t||ve.test(e)&&f(t.parentNode)||t),n},T.sortStable=H.split("").sort(G).join("")===H,T.detectDuplicates=!!P,I(),T.sortDetached=o(function(e){return 1&e.compareDocumentPosition(_.createElement("fieldset"))}),o(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||i("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),T.attributes&&o(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||i("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),o(function(e){return null==e.getAttribute("disabled")})||i(te,function(e,t,n){var r;return n?void 0:e[t]===!0?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),t}(e);he.find=be,he.expr=be.selectors,he.expr[":"]=he.expr.pseudos,he.uniqueSort=he.unique=be.uniqueSort,he.text=be.getText,he.isXMLDoc=be.isXML,he.contains=be.contains,he.escapeSelector=be.escape;var we=function(e,t,n){for(var r=[],o=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&he(e).is(n))break;r.push(e)}return r},xe=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},Te=he.expr.match.needsContext,Oe=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,je=/^.[^:#\[\.,]*$/;he.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?he.find.matchesSelector(r,e)?[r]:[]:he.find.matches(e,he.grep(t,function(e){return 1===e.nodeType}))},he.fn.extend({find:function(e){var t,n,r=this.length,o=this;if("string"!=typeof e)return this.pushStack(he(e).filter(function(){for(t=0;r>t;t++)if(he.contains(o[t],this))return!0}));for(n=this.pushStack([]),t=0;r>t;t++)he.find(e,o[t],n);return r>1?he.uniqueSort(n):n},filter:function(e){return this.pushStack(o(this,e||[],!1))},not:function(e){return this.pushStack(o(this,e||[],!0))},is:function(e){return!!o(this,"string"==typeof e&&Te.test(e)?he(e):e||[],!1).length}});var Se,ke=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,Ce=he.fn.init=function(e,t,n){var r,o;if(!e)return this;if(n=n||Se,"string"==typeof e){if(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:ke.exec(e),!r||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof he?t[0]:t,he.merge(this,he.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:te,!0)),Oe.test(r[1])&&he.isPlainObject(t))for(r in t)he.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return o=te.getElementById(r[2]),o&&(this[0]=o,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):he.isFunction(e)?void 0!==n.ready?n.ready(e):e(he):he.makeArray(e,this)};Ce.prototype=he.fn,Se=he(te);var Ae=/^(?:parents|prev(?:Until|All))/,Ee={children:!0,contents:!0,next:!0,prev:!0};he.fn.extend({has:function(e){var t=he(e,this),n=t.length;return this.filter(function(){for(var e=0;n>e;e++)if(he.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,o=this.length,i=[],a="string"!=typeof e&&he(e);if(!Te.test(e))for(;o>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&he.find.matchesSelector(n,e))){i.push(n);break}return this.pushStack(i.length>1?he.uniqueSort(i):i)},index:function(e){return e?"string"==typeof e?ae.call(he(e),this[0]):ae.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(he.uniqueSort(he.merge(this.get(),he(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),he.each({parent:function e(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(e){return we(e,"parentNode")},parentsUntil:function(e,t,n){return we(e,"parentNode",n)},next:function(e){return i(e,"nextSibling")},prev:function(e){return i(e,"previousSibling")},nextAll:function(e){return we(e,"nextSibling")},prevAll:function(e){return we(e,"previousSibling")},nextUntil:function(e,t,n){return we(e,"nextSibling",n)},prevUntil:function(e,t,n){return we(e,"previousSibling",n)},siblings:function(e){return xe((e.parentNode||{}).firstChild,e)},children:function(e){return xe(e.firstChild)},contents:function(e){return e.contentDocument||he.merge([],e.childNodes)}},function(e,t){he.fn[e]=function(n,r){var o=he.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(o=he.filter(r,o)),this.length>1&&(Ee[e]||he.uniqueSort(o),Ae.test(e)&&o.reverse()),this.pushStack(o)}});var Ne=/[^\x20\t\r\n\f]+/g;he.Callbacks=function(e){e="string"==typeof e?a(e):he.extend({},e);var t,n,r,o,i=[],s=[],u=-1,c=function(){for(o=e.once,r=t=!0;s.length;u=-1)for(n=s.shift();++u<i.length;)i[u].apply(n[0],n[1])===!1&&e.stopOnFalse&&(u=i.length,n=!1);e.memory||(n=!1),t=!1,o&&(i=n?[]:"")},l={add:function(){return i&&(n&&!t&&(u=i.length-1,s.push(n)),function t(n){he.each(n,function(n,r){he.isFunction(r)?e.unique&&l.has(r)||i.push(r):r&&r.length&&"string"!==he.type(r)&&t(r)})}(arguments),n&&!t&&c()),this},remove:function(){return he.each(arguments,function(e,t){for(var n;(n=he.inArray(t,i,n))>-1;)i.splice(n,1),u>=n&&u--}),this},has:function(e){return e?he.inArray(e,i)>-1:i.length>0},empty:function(){return i&&(i=[]),this},disable:function(){return o=s=[],i=n="",this},disabled:function(){return!i},lock:function(){return o=s=[],n||t||(i=n=""),this},locked:function(){return!!o},fireWith:function(e,n){return o||(n=n||[],n=[e,n.slice?n.slice():n],s.push(n),t||c()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!r}};return l},he.extend({Deferred:function(t){var n=[["notify","progress",he.Callbacks("memory"),he.Callbacks("memory"),2],["resolve","done",he.Callbacks("once memory"),he.Callbacks("once memory"),0,"resolved"],["reject","fail",he.Callbacks("once memory"),he.Callbacks("once memory"),1,"rejected"]],r="pending",o={state:function(){return r},always:function(){return i.done(arguments).fail(arguments),this},catch:function(e){return o.then(null,e)},pipe:function(){var e=arguments;return he.Deferred(function(t){he.each(n,function(n,r){var o=he.isFunction(e[r[4]])&&e[r[4]];i[r[1]](function(){var e=o&&o.apply(this,arguments);e&&he.isFunction(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[r[0]+"With"](this,o?[e]:arguments)})}),e=null}).promise()},then:function(t,r,o){function i(t,n,r,o){return function(){var c=this,l=arguments,f=function(){var e,f;if(!(a>t)){if(e=r.apply(c,l),e===n.promise())throw new TypeError("Thenable self-resolution");f=e&&("object"===("undefined"==typeof e?"undefined":_typeof(e))||"function"==typeof e)&&e.then,he.isFunction(f)?o?f.call(e,i(a,n,s,o),i(a,n,u,o)):(a++,f.call(e,i(a,n,s,o),i(a,n,u,o),i(a,n,s,n.notifyWith))):(r!==s&&(c=void 0,l=[e]),(o||n.resolveWith)(c,l))}},p=o?f:function(){try{f()}catch(e){he.Deferred.exceptionHook&&he.Deferred.exceptionHook(e,p.stackTrace),t+1>=a&&(r!==u&&(c=void 0,l=[e]),n.rejectWith(c,l))}};t?p():(he.Deferred.getStackHook&&(p.stackTrace=he.Deferred.getStackHook()),e.setTimeout(p))}}var a=0;return he.Deferred(function(e){n[0][3].add(i(0,e,he.isFunction(o)?o:s,e.notifyWith)),n[1][3].add(i(0,e,he.isFunction(t)?t:s)),n[2][3].add(i(0,e,he.isFunction(r)?r:u))}).promise()},promise:function(e){return null!=e?he.extend(e,o):o}},i={};return he.each(n,function(e,t){var a=t[2],s=t[5];o[t[1]]=a.add,s&&a.add(function(){r=s},n[3-e][2].disable,n[0][2].lock),a.add(t[3].fire),i[t[0]]=function(){return i[t[0]+"With"](this===i?void 0:this,arguments),this},i[t[0]+"With"]=a.fireWith}),o.promise(i),t&&t.call(i,i),i},when:function(e){var t=arguments.length,n=t,r=Array(n),o=re.call(arguments),i=he.Deferred(),a=function(e){return function(n){r[e]=this,o[e]=arguments.length>1?re.call(arguments):n,--t||i.resolveWith(r,o)}};if(1>=t&&(c(e,i.done(a(n)).resolve,i.reject),"pending"===i.state()||he.isFunction(o[n]&&o[n].then)))return i.then();for(;n--;)c(o[n],a(n),i.reject);return i.promise()}});var Pe=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;he.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&Pe.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},he.readyException=function(t){e.setTimeout(function(){throw t})};var Ie=he.Deferred();he.fn.ready=function(e){return Ie.then(e).catch(function(e){he.readyException(e)}),this},he.extend({isReady:!1,readyWait:1,holdReady:function(e){e?he.readyWait++:he.ready(!0)},ready:function(e){(e===!0?--he.readyWait:he.isReady)||(he.isReady=!0,e!==!0&&--he.readyWait>0||Ie.resolveWith(te,[he]))}}),he.ready.then=Ie.then,"complete"===te.readyState||"loading"!==te.readyState&&!te.documentElement.doScroll?e.setTimeout(he.ready):(te.addEventListener("DOMContentLoaded",l),e.addEventListener("load",l));var _e=function e(t,n,r,o,i,a,s){var u=0,c=t.length,l=null==r;if("object"===he.type(r)){i=!0;for(u in r)e(t,n,u,r[u],!0,a,s)}else if(void 0!==o&&(i=!0,he.isFunction(o)||(s=!0),l&&(s?(n.call(t,o),n=null):(l=n,n=function(e,t,n){return l.call(he(e),n)})),n))for(;c>u;u++)n(t[u],r,s?o:o.call(t[u],u,n(t[u],r)));return i?t:l?n.call(t):c?n(t[0],r):a},Me=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};f.uid=1,f.prototype={cache:function(e){var t=e[this.expando];return t||(t={},Me(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,o=this.cache(e);if("string"==typeof t)o[he.camelCase(t)]=n;else for(r in t)o[he.camelCase(r)]=t[r];return o},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][he.camelCase(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){he.isArray(t)?t=t.map(he.camelCase):(t=he.camelCase(t),t=t in r?[t]:t.match(Ne)||[]),n=t.length;for(;n--;)delete r[t[n]]}(void 0===t||he.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!he.isEmptyObject(t)}};var Fe=new f,De=new f,Le=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,qe=/[A-Z]/g;he.extend({hasData:function(e){return De.hasData(e)||Fe.hasData(e)},data:function(e,t,n){return De.access(e,t,n)},removeData:function(e,t){De.remove(e,t)},_data:function(e,t,n){return Fe.access(e,t,n)},_removeData:function(e,t){Fe.remove(e,t)}}),he.fn.extend({data:function e(t,n){var r,o,e,i=this[0],a=i&&i.attributes;if(void 0===t){if(this.length&&(e=De.get(i),1===i.nodeType&&!Fe.get(i,"hasDataAttrs"))){for(r=a.length;r--;)a[r]&&(o=a[r].name,0===o.indexOf("data-")&&(o=he.camelCase(o.slice(5)),d(i,o,e[o])));Fe.set(i,"hasDataAttrs",!0)}return e}return"object"===("undefined"==typeof t?"undefined":_typeof(t))?this.each(function(){De.set(this,t)}):_e(this,function(e){var n;if(i&&void 0===e){if(n=De.get(i,t),void 0!==n)return n;if(n=d(i,t),void 0!==n)return n}else this.each(function(){De.set(this,t,e)})},null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){De.remove(this,e)})}}),he.extend({queue:function e(t,n,r){var e;return t?(n=(n||"fx")+"queue",e=Fe.get(t,n),r&&(!e||he.isArray(r)?e=Fe.access(t,n,he.makeArray(r)):e.push(r)),e||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=he.queue(e,t),r=n.length,o=n.shift(),i=he._queueHooks(e,t),a=function(){he.dequeue(e,t)};"inprogress"===o&&(o=n.shift(),r--),o&&("fx"===t&&n.unshift("inprogress"),delete i.stop,o.call(e,a,i)),!r&&i&&i.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Fe.get(e,n)||Fe.access(e,n,{empty:he.Callbacks("once memory").add(function(){Fe.remove(e,[t+"queue",n])})})}}),he.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?he.queue(this[0],e):void 0===t?this:this.each(function(){var n=he.queue(this,e,t);he._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&he.dequeue(this,e)})},dequeue:function(e){return this.each(function(){he.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,o=he.Deferred(),i=this,a=this.length,s=function(){--r||o.resolveWith(i,[i])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)n=Fe.get(i[a],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(s));return s(),o.promise(t)}});var Re=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,He=new RegExp("^(?:([+-])=|)("+Re+")([a-z%]*)$","i"),$e=["Top","Right","Bottom","Left"],ze=function(e,t){return e=t||e,"none"===e.style.display||""===e.style.display&&he.contains(e.ownerDocument,e)&&"none"===he.css(e,"display")},We=function(e,t,n,r){var o,i,a={};for(i in t)a[i]=e.style[i],e.style[i]=t[i];o=n.apply(e,r||[]);for(i in t)e.style[i]=a[i];return o},Be={};he.fn.extend({show:function(){return y(this,!0)},hide:function(){return y(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ze(this)?he(this).show():he(this).hide()})}});var Ve=/^(?:checkbox|radio)$/i,Ue=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Ge=/^$|\/(?:java|ecma)script/i,Xe={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Xe.optgroup=Xe.option,Xe.tbody=Xe.tfoot=Xe.colgroup=Xe.caption=Xe.thead,Xe.th=Xe.td;var Je=/<|&#?\w+;/;!function(){var e=te.createDocumentFragment(),t=e.appendChild(te.createElement("div")),n=te.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),pe.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",pe.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var Ye=te.documentElement,Qe=/^key/,Ze=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Ke=/^([^.]*)(?:\.(.+)|)/;he.event={global:{},add:function(e,t,n,r,o){var i,a,s,u,c,l,f,p,d,h,g,y=Fe.get(e);if(y)for(n.handler&&(i=n,n=i.handler,o=i.selector),o&&he.find.matchesSelector(Ye,o),n.guid||(n.guid=he.guid++),(u=y.events)||(u=y.events={}),(a=y.handle)||(a=y.handle=function(t){return"undefined"!=typeof he&&he.event.triggered!==t.type?he.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(Ne)||[""],c=t.length;c--;)s=Ke.exec(t[c])||[],d=g=s[1],h=(s[2]||"").split(".").sort(),d&&(f=he.event.special[d]||{},d=(o?f.delegateType:f.bindType)||d,f=he.event.special[d]||{},l=he.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:o,needsContext:o&&he.expr.match.needsContext.test(o),namespace:h.join(".")},i),(p=u[d])||(p=u[d]=[],p.delegateCount=0,f.setup&&f.setup.call(e,r,h,a)!==!1||e.addEventListener&&e.addEventListener(d,a)),f.add&&(f.add.call(e,l),l.handler.guid||(l.handler.guid=n.guid)),o?p.splice(p.delegateCount++,0,l):p.push(l),he.event.global[d]=!0)},remove:function(e,t,n,r,o){var i,a,s,u,c,l,f,p,d,h,g,y=Fe.hasData(e)&&Fe.get(e);if(y&&(u=y.events)){for(t=(t||"").match(Ne)||[""],c=t.length;c--;)if(s=Ke.exec(t[c])||[],d=g=s[1],h=(s[2]||"").split(".").sort(),d){for(f=he.event.special[d]||{},d=(r?f.delegateType:f.bindType)||d,p=u[d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=i=p.length;i--;)l=p[i],!o&&g!==l.origType||n&&n.guid!==l.guid||s&&!s.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(p.splice(i,1),l.selector&&p.delegateCount--,f.remove&&f.remove.call(e,l));a&&!p.length&&(f.teardown&&f.teardown.call(e,h,y.handle)!==!1||he.removeEvent(e,d,y.handle),delete u[d])}else for(d in u)he.event.remove(e,d+t[c],n,r,!0);he.isEmptyObject(u)&&Fe.remove(e,"handle events")}},dispatch:function(e){var t,n,r,o,i,a,s=he.event.fix(e),u=new Array(arguments.length),c=(Fe.get(this,"events")||{})[s.type]||[],l=he.event.special[s.type]||{};for(u[0]=s,t=1;t<arguments.length;t++)u[t]=arguments[t];if(s.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,s)!==!1){for(a=he.event.handlers.call(this,s,c),t=0;(o=a[t++])&&!s.isPropagationStopped();)for(s.currentTarget=o.elem,n=0;(i=o.handlers[n++])&&!s.isImmediatePropagationStopped();)(!s.rnamespace||s.rnamespace.test(i.namespace))&&(s.handleObj=i,s.data=i.data,r=((he.event.special[i.origType]||{}).handle||i.handler).apply(o.elem,u),void 0!==r&&(s.result=r)===!1&&(s.preventDefault(),s.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,s),s.result}},handlers:function(e,t){var n,r,o,i,a,s=[],u=t.delegateCount,c=e.target;if(u&&c.nodeType&&!("click"===e.type&&e.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==e.type||c.disabled!==!0)){for(i=[],a={},n=0;u>n;n++)r=t[n],o=r.selector+" ",void 0===a[o]&&(a[o]=r.needsContext?he(o,this).index(c)>-1:he.find(o,this,null,[c]).length),a[o]&&i.push(r);i.length&&s.push({elem:c,handlers:i})}return c=this,u<t.length&&s.push({elem:c,handlers:t.slice(u)}),s},addProp:function(e,t){Object.defineProperty(he.Event.prototype,e,{enumerable:!0,configurable:!0,get:he.isFunction(t)?function(){return this.originalEvent?t(this.originalEvent):void 0}:function(){return this.originalEvent?this.originalEvent[e]:void 0},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[he.expando]?e:new he.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==T()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===T()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&he.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return he.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},he.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},he.Event=function(e,t){return this instanceof he.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?w:x,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&he.extend(this,t),this.timeStamp=e&&e.timeStamp||he.now(),void(this[he.expando]=!0)):new he.Event(e,t)},he.Event.prototype={constructor:he.Event,isDefaultPrevented:x,isPropagationStopped:x,isImmediatePropagationStopped:x,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=w,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=w,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=w,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},he.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&Qe.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&Ze.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},he.event.addProp),he.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){he.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,o=e.relatedTarget,i=e.handleObj;return(!o||o!==r&&!he.contains(r,o))&&(e.type=i.origType,n=i.handler.apply(this,arguments),e.type=t),n}}}),he.fn.extend({on:function(e,t,n,r){return O(this,e,t,n,r)},one:function(e,t,n,r){return O(this,e,t,n,r,1)},off:function(e,t,n){var r,o;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,he(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"===("undefined"==typeof e?"undefined":_typeof(e))){for(o in e)this.off(o,t,e[o]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=void 0),n===!1&&(n=x),this.each(function(){he.event.remove(this,e,n,t)})}});var et=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,tt=/<script|<style|<link/i,nt=/checked\s*(?:[^=]|=\s*.checked.)/i,rt=/^true\/(.*)/,ot=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;he.extend({htmlPrefilter:function(e){return e.replace(et,"<$1></$2>")},clone:function e(t,n,r){var o,i,a,s,e=t.cloneNode(!0),u=he.contains(t.ownerDocument,t);if(!(pe.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||he.isXMLDoc(t)))for(s=m(e),a=m(t),o=0,i=a.length;i>o;o++)A(a[o],s[o]);if(n)if(r)for(a=a||m(t),s=s||m(e),o=0,i=a.length;i>o;o++)C(a[o],s[o]);else C(t,e);return s=m(e,"script"),s.length>0&&v(s,!u&&m(t,"script")),e},cleanData:function(e){for(var t,n,r,o=he.event.special,i=0;void 0!==(n=e[i]);i++)if(Me(n)){if(t=n[Fe.expando]){if(t.events)for(r in t.events)o[r]?he.event.remove(n,r):he.removeEvent(n,r,t.handle);n[Fe.expando]=void 0}n[De.expando]&&(n[De.expando]=void 0)}}}),he.fn.extend({detach:function(e){return N(this,e,!0)},remove:function(e){return N(this,e)},text:function(e){return _e(this,function(e){return void 0===e?he.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return E(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=j(this,e);t.appendChild(e)}})},prepend:function(){return E(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=j(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return E(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return E(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(he.cleanData(m(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return he.clone(this,e,t)})},html:function(e){return _e(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!tt.test(e)&&!Xe[(Ue.exec(e)||["",""])[1].toLowerCase()]){e=he.htmlPrefilter(e);try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(he.cleanData(m(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return E(this,arguments,function(t){var n=this.parentNode;he.inArray(this,e)<0&&(he.cleanData(m(this)),n&&n.replaceChild(t,this))},e)}}),he.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){he.fn[e]=function(e){for(var n,r=[],o=he(e),i=o.length-1,a=0;i>=a;a++)n=a===i?this:this.clone(!0),he(o[a])[t](n),ie.apply(r,n.get());return this.pushStack(r)}});var it=/^margin/,at=new RegExp("^("+Re+")(?!px)[a-z%]+$","i"),st=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)};!function(){function t(){if(s){s.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",s.innerHTML="",Ye.appendChild(a);var t=e.getComputedStyle(s);n="1%"!==t.top,i="2px"===t.marginLeft,r="4px"===t.width,s.style.marginRight="50%",o="4px"===t.marginRight,Ye.removeChild(a),s=null}}var n,r,o,i,a=te.createElement("div"),s=te.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",pe.clearCloneStyle="content-box"===s.style.backgroundClip,a.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",a.appendChild(s),he.extend(pe,{pixelPosition:function(){return t(),n},boxSizingReliable:function(){return t(),r},pixelMarginRight:function(){return t(),o},reliableMarginLeft:function(){return t(),i}}))}();var ut=/^(none|table(?!-c[ea]).+)/,ct={position:"absolute",visibility:"hidden",display:"block"},lt={letterSpacing:"0",fontWeight:"400"},ft=["Webkit","Moz","ms"],pt=te.createElement("div").style;he.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=P(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function e(t,n,r,o){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var i,a,s,u=he.camelCase(n),e=t.style;return n=he.cssProps[u]||(he.cssProps[u]=_(u)||u),s=he.cssHooks[n]||he.cssHooks[u],void 0===r?s&&"get"in s&&void 0!==(i=s.get(t,!1,o))?i:e[n]:(a="undefined"==typeof r?"undefined":_typeof(r),"string"===a&&(i=He.exec(r))&&i[1]&&(r=h(t,n,i),a="number"),null!=r&&r===r&&("number"===a&&(r+=i&&i[3]||(he.cssNumber[u]?"":"px")),pe.clearCloneStyle||""!==r||0!==n.indexOf("background")||(e[n]="inherit"),s&&"set"in s&&void 0===(r=s.set(t,r,o))||(e[n]=r)),void 0)}},css:function(e,t,n,r){var o,i,a,s=he.camelCase(t);return t=he.cssProps[s]||(he.cssProps[s]=_(s)||s),a=he.cssHooks[t]||he.cssHooks[s],a&&"get"in a&&(o=a.get(e,!0,n)),void 0===o&&(o=P(e,t,r)),"normal"===o&&t in lt&&(o=lt[t]),""===n||n?(i=parseFloat(o),n===!0||isFinite(i)?i||0:o):o}}),he.each(["height","width"],function(e,t){he.cssHooks[t]={get:function(e,n,r){return n?!ut.test(he.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?D(e,t,r):We(e,ct,function(){return D(e,t,r)}):void 0},set:function(e,n,r){var o,i=r&&st(e),a=r&&F(e,t,r,"border-box"===he.css(e,"boxSizing",!1,i),i);return a&&(o=He.exec(n))&&"px"!==(o[3]||"px")&&(e.style[t]=n,n=he.css(e,t)),M(e,n,a)}}}),he.cssHooks.marginLeft=I(pe.reliableMarginLeft,function(e,t){return t?(parseFloat(P(e,"marginLeft"))||e.getBoundingClientRect().left-We(e,{
marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px":void 0}),he.each({margin:"",padding:"",border:"Width"},function(e,t){he.cssHooks[e+t]={expand:function(n){for(var r=0,o={},i="string"==typeof n?n.split(" "):[n];4>r;r++)o[e+$e[r]+t]=i[r]||i[r-2]||i[0];return o}},it.test(e)||(he.cssHooks[e+t].set=M)}),he.fn.extend({css:function(e,t){return _e(this,function(e,t,n){var r,o,i={},a=0;if(he.isArray(t)){for(r=st(e),o=t.length;o>a;a++)i[t[a]]=he.css(e,t[a],!1,r);return i}return void 0!==n?he.style(e,t,n):he.css(e,t)},e,t,arguments.length>1)}}),he.Tween=L,L.prototype={constructor:L,init:function(e,t,n,r,o,i){this.elem=e,this.prop=n,this.easing=o||he.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=i||(he.cssNumber[n]?"":"px")},cur:function(){var e=L.propHooks[this.prop];return e&&e.get?e.get(this):L.propHooks._default.get(this)},run:function(e){var t,n=L.propHooks[this.prop];return this.pos=t=this.options.duration?he.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):L.propHooks._default.set(this),this}},L.prototype.init.prototype=L.prototype,L.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=he.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){he.fx.step[e.prop]?he.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[he.cssProps[e.prop]]&&!he.cssHooks[e.prop]?e.elem[e.prop]=e.now:he.style(e.elem,e.prop,e.now+e.unit)}}},L.propHooks.scrollTop=L.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},he.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},he.fx=L.prototype.init,he.fx.step={};var dt,ht,gt=/^(?:toggle|show|hide)$/,yt=/queueHooks$/;he.Animation=he.extend(B,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return h(n.elem,e,He.exec(t),n),n}]},tweener:function(e,t){he.isFunction(e)?(t=e,e=["*"]):e=e.match(Ne);for(var n,r=0,o=e.length;o>r;r++)n=e[r],B.tweeners[n]=B.tweeners[n]||[],B.tweeners[n].unshift(t)},prefilters:[z],prefilter:function(e,t){t?B.prefilters.unshift(e):B.prefilters.push(e)}}),he.speed=function(e,t,n){var r=e&&"object"===("undefined"==typeof e?"undefined":_typeof(e))?he.extend({},e):{complete:n||!n&&t||he.isFunction(e)&&e,duration:e,easing:n&&t||t&&!he.isFunction(t)&&t};return he.fx.off||te.hidden?r.duration=0:"number"!=typeof r.duration&&(r.duration=r.duration in he.fx.speeds?he.fx.speeds[r.duration]:he.fx.speeds._default),(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){he.isFunction(r.old)&&r.old.call(this),r.queue&&he.dequeue(this,r.queue)},r},he.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ze).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var o=he.isEmptyObject(e),i=he.speed(t,n,r),a=function(){var t=B(this,he.extend({},e),i);(o||Fe.get(this,"finish"))&&t.stop(!0)};return a.finish=a,o||i.queue===!1?this.each(a):this.queue(i.queue,a)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,o=null!=e&&e+"queueHooks",i=he.timers,a=Fe.get(this);if(o)a[o]&&a[o].stop&&r(a[o]);else for(o in a)a[o]&&a[o].stop&&yt.test(o)&&r(a[o]);for(o=i.length;o--;)i[o].elem!==this||null!=e&&i[o].queue!==e||(i[o].anim.stop(n),t=!1,i.splice(o,1));(t||!n)&&he.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=Fe.get(this),r=n[e+"queue"],o=n[e+"queueHooks"],i=he.timers,a=r?r.length:0;for(n.finish=!0,he.queue(this,e,[]),o&&o.stop&&o.stop.call(this,!0),t=i.length;t--;)i[t].elem===this&&i[t].queue===e&&(i[t].anim.stop(!0),i.splice(t,1));for(t=0;a>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),he.each(["toggle","show","hide"],function(e,t){var n=he.fn[t];he.fn[t]=function(e,r,o){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(H(t,!0),e,r,o)}}),he.each({slideDown:H("show"),slideUp:H("hide"),slideToggle:H("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){he.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),he.timers=[],he.fx.tick=function(){var e,t=0,n=he.timers;for(dt=he.now();t<n.length;t++)e=n[t],e()||n[t]!==e||n.splice(t--,1);n.length||he.fx.stop(),dt=void 0},he.fx.timer=function(e){he.timers.push(e),e()?he.fx.start():he.timers.pop()},he.fx.interval=13,he.fx.start=function(){ht||(ht=e.requestAnimationFrame?e.requestAnimationFrame(q):e.setInterval(he.fx.tick,he.fx.interval))},he.fx.stop=function(){e.cancelAnimationFrame?e.cancelAnimationFrame(ht):e.clearInterval(ht),ht=null},he.fx.speeds={slow:600,fast:200,_default:400},he.fn.delay=function(t,n){return t=he.fx?he.fx.speeds[t]||t:t,n=n||"fx",this.queue(n,function(n,r){var o=e.setTimeout(n,t);r.stop=function(){e.clearTimeout(o)}})},function(){var e=te.createElement("input"),t=te.createElement("select"),n=t.appendChild(te.createElement("option"));e.type="checkbox",pe.checkOn=""!==e.value,pe.optSelected=n.selected,e=te.createElement("input"),e.value="t",e.type="radio",pe.radioValue="t"===e.value}();var mt,vt=he.expr.attrHandle;he.fn.extend({attr:function(e,t){return _e(this,he.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){he.removeAttr(this,e)})}}),he.extend({attr:function(e,t,n){var r,o,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return"undefined"==typeof e.getAttribute?he.prop(e,t,n):(1===i&&he.isXMLDoc(e)||(o=he.attrHooks[t.toLowerCase()]||(he.expr.match.bool.test(t)?mt:void 0)),void 0!==n?null===n?void he.removeAttr(e,t):o&&"set"in o&&void 0!==(r=o.set(e,n,t))?r:(e.setAttribute(t,n+""),n):o&&"get"in o&&null!==(r=o.get(e,t))?r:(r=he.find.attr(e,t),null==r?void 0:r))},attrHooks:{type:{set:function(e,t){if(!pe.radioValue&&"radio"===t&&he.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,o=t&&t.match(Ne);if(o&&1===e.nodeType)for(;n=o[r++];)e.removeAttribute(n)}}),mt={set:function(e,t,n){return t===!1?he.removeAttr(e,n):e.setAttribute(n,n),n}},he.each(he.expr.match.bool.source.match(/\w+/g),function(e,t){var n=vt[t]||he.find.attr;vt[t]=function(e,t,r){var o,i,a=t.toLowerCase();return r||(i=vt[a],vt[a]=o,o=null!=n(e,t,r)?a:null,vt[a]=i),o}});var bt=/^(?:input|select|textarea|button)$/i,wt=/^(?:a|area)$/i;he.fn.extend({prop:function(e,t){return _e(this,he.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[he.propFix[e]||e]})}}),he.extend({prop:function(e,t,n){var r,o,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return 1===i&&he.isXMLDoc(e)||(t=he.propFix[t]||t,o=he.propHooks[t]),void 0!==n?o&&"set"in o&&void 0!==(r=o.set(e,n,t))?r:e[t]=n:o&&"get"in o&&null!==(r=o.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=he.find.attr(e,"tabindex");return t?parseInt(t,10):bt.test(e.nodeName)||wt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),pe.optSelected||(he.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),he.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){he.propFix[this.toLowerCase()]=this}),he.fn.extend({addClass:function(e){var t,n,r,o,i,a,s,u=0;if(he.isFunction(e))return this.each(function(t){he(this).addClass(e.call(this,t,U(this)))});if("string"==typeof e&&e)for(t=e.match(Ne)||[];n=this[u++];)if(o=U(n),r=1===n.nodeType&&" "+V(o)+" "){for(a=0;i=t[a++];)r.indexOf(" "+i+" ")<0&&(r+=i+" ");s=V(r),o!==s&&n.setAttribute("class",s)}return this},removeClass:function(e){var t,n,r,o,i,a,s,u=0;if(he.isFunction(e))return this.each(function(t){he(this).removeClass(e.call(this,t,U(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(Ne)||[];n=this[u++];)if(o=U(n),r=1===n.nodeType&&" "+V(o)+" "){for(a=0;i=t[a++];)for(;r.indexOf(" "+i+" ")>-1;)r=r.replace(" "+i+" "," ");s=V(r),o!==s&&n.setAttribute("class",s)}return this},toggleClass:function(e,t){var n="undefined"==typeof e?"undefined":_typeof(e);return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):this.each(he.isFunction(e)?function(n){he(this).toggleClass(e.call(this,n,U(this),t),t)}:function(){var t,r,o,i;if("string"===n)for(r=0,o=he(this),i=e.match(Ne)||[];t=i[r++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else(void 0===e||"boolean"===n)&&(t=U(this),t&&Fe.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||e===!1?"":Fe.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+V(U(n))+" ").indexOf(t)>-1)return!0;return!1}});var xt=/\r/g;he.fn.extend({val:function(e){var t,n,r,o=this[0];{if(arguments.length)return r=he.isFunction(e),this.each(function(n){var o;1===this.nodeType&&(o=r?e.call(this,n,he(this).val()):e,null==o?o="":"number"==typeof o?o+="":he.isArray(o)&&(o=he.map(o,function(e){return null==e?"":e+""})),t=he.valHooks[this.type]||he.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))});if(o)return t=he.valHooks[o.type]||he.valHooks[o.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(o,"value"))?n:(n=o.value,"string"==typeof n?n.replace(xt,""):null==n?"":n)}}}),he.extend({valHooks:{option:{get:function(e){var t=he.find.attr(e,"value");return null!=t?t:V(he.text(e))}},select:{get:function(e){var t,n,r,o=e.options,i=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?i+1:o.length;for(r=0>i?u:a?i:0;u>r;r++)if(n=o[r],!(!n.selected&&r!==i||n.disabled||n.parentNode.disabled&&he.nodeName(n.parentNode,"optgroup"))){if(t=he(n).val(),a)return t;s.push(t)}return s},set:function(e,t){for(var n,r,o=e.options,i=he.makeArray(t),a=o.length;a--;)r=o[a],(r.selected=he.inArray(he.valHooks.option.get(r),i)>-1)&&(n=!0);return n||(e.selectedIndex=-1),i}}}}),he.each(["radio","checkbox"],function(){he.valHooks[this]={set:function(e,t){return he.isArray(t)?e.checked=he.inArray(he(e).val(),t)>-1:void 0}},pe.checkOn||(he.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Tt=/^(?:focusinfocus|focusoutblur)$/;he.extend(he.event,{trigger:function(t,n,r,o){var i,a,s,u,c,l,f,p=[r||te],d=ce.call(t,"type")?t.type:t,h=ce.call(t,"namespace")?t.namespace.split("."):[];if(a=s=r=r||te,3!==r.nodeType&&8!==r.nodeType&&!Tt.test(d+he.event.triggered)&&(d.indexOf(".")>-1&&(h=d.split("."),d=h.shift(),h.sort()),c=d.indexOf(":")<0&&"on"+d,t=t[he.expando]?t:new he.Event(d,"object"===("undefined"==typeof t?"undefined":_typeof(t))&&t),t.isTrigger=o?2:3,t.namespace=h.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),n=null==n?[t]:he.makeArray(n,[t]),f=he.event.special[d]||{},o||!f.trigger||f.trigger.apply(r,n)!==!1)){if(!o&&!f.noBubble&&!he.isWindow(r)){for(u=f.delegateType||d,Tt.test(u+d)||(a=a.parentNode);a;a=a.parentNode)p.push(a),s=a;s===(r.ownerDocument||te)&&p.push(s.defaultView||s.parentWindow||e)}for(i=0;(a=p[i++])&&!t.isPropagationStopped();)t.type=i>1?u:f.bindType||d,l=(Fe.get(a,"events")||{})[t.type]&&Fe.get(a,"handle"),l&&l.apply(a,n),l=c&&a[c],l&&l.apply&&Me(a)&&(t.result=l.apply(a,n),t.result===!1&&t.preventDefault());return t.type=d,o||t.isDefaultPrevented()||f._default&&f._default.apply(p.pop(),n)!==!1||!Me(r)||c&&he.isFunction(r[d])&&!he.isWindow(r)&&(s=r[c],s&&(r[c]=null),he.event.triggered=d,r[d](),he.event.triggered=void 0,s&&(r[c]=s)),t.result}},simulate:function(e,t,n){var r=he.extend(new he.Event,n,{type:e,isSimulated:!0});he.event.trigger(r,null,t)}}),he.fn.extend({trigger:function(e,t){return this.each(function(){he.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?he.event.trigger(e,t,n,!0):void 0}}),he.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){he.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),he.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),pe.focusin="onfocusin"in e,pe.focusin||he.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){he.event.simulate(t,e.target,he.event.fix(e))};he.event.special[t]={setup:function(){var r=this.ownerDocument||this,o=Fe.access(r,t);o||r.addEventListener(e,n,!0),Fe.access(r,t,(o||0)+1)},teardown:function(){var r=this.ownerDocument||this,o=Fe.access(r,t)-1;o?Fe.access(r,t,o):(r.removeEventListener(e,n,!0),Fe.remove(r,t))}}});var Ot=e.location,jt=he.now(),St=/\?/;he.parseXML=function(t){var n;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){n=void 0}return(!n||n.getElementsByTagName("parsererror").length)&&he.error("Invalid XML: "+t),n};var kt=/\[\]$/,Ct=/\r?\n/g,At=/^(?:submit|button|image|reset|file)$/i,Et=/^(?:input|select|textarea|keygen)/i;he.param=function(e,t){var n,r=[],o=function(e,t){var n=he.isFunction(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(he.isArray(e)||e.jquery&&!he.isPlainObject(e))he.each(e,function(){o(this.name,this.value)});else for(n in e)G(n,e[n],t,o);return r.join("&")},he.fn.extend({serialize:function(){return he.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=he.prop(this,"elements");return e?he.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!he(this).is(":disabled")&&Et.test(this.nodeName)&&!At.test(e)&&(this.checked||!Ve.test(e))}).map(function(e,t){var n=he(this).val();return null==n?null:he.isArray(n)?he.map(n,function(e){return{name:t.name,value:e.replace(Ct,"\r\n")}}):{name:t.name,value:n.replace(Ct,"\r\n")}}).get()}});var Nt=/%20/g,Pt=/#.*$/,It=/([?&])_=[^&]*/,_t=/^(.*?):[ \t]*([^\r\n]*)$/gm,Mt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ft=/^(?:GET|HEAD)$/,Dt=/^\/\//,Lt={},qt={},Rt="*/".concat("*"),Ht=te.createElement("a");Ht.href=Ot.href,he.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ot.href,type:"GET",isLocal:Mt.test(Ot.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Rt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":he.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Y(Y(e,he.ajaxSettings),t):Y(he.ajaxSettings,e)},ajaxPrefilter:X(Lt),ajaxTransport:X(qt),ajax:function(t,n){function r(t,n,r,s){var c,p,d,w,x,T=n;l||(l=!0,u&&e.clearTimeout(u),o=void 0,a=s||"",O.readyState=t>0?4:0,c=t>=200&&300>t||304===t,r&&(w=Q(h,O,r)),w=Z(h,w,O,c),c?(h.ifModified&&(x=O.getResponseHeader("Last-Modified"),x&&(he.lastModified[i]=x),x=O.getResponseHeader("etag"),x&&(he.etag[i]=x)),204===t||"HEAD"===h.type?T="nocontent":304===t?T="notmodified":(T=w.state,p=w.data,d=w.error,c=!d)):(d=T,(t||!T)&&(T="error",0>t&&(t=0))),O.status=t,O.statusText=(n||T)+"",c?m.resolveWith(g,[p,T,O]):m.rejectWith(g,[O,T,d]),O.statusCode(b),b=void 0,f&&y.trigger(c?"ajaxSuccess":"ajaxError",[O,h,c?p:d]),v.fireWith(g,[O,T]),f&&(y.trigger("ajaxComplete",[O,h]),--he.active||he.event.trigger("ajaxStop")))}"object"===("undefined"==typeof t?"undefined":_typeof(t))&&(n=t,t=void 0),n=n||{};var o,i,a,s,u,c,l,f,p,d,h=he.ajaxSetup({},n),g=h.context||h,y=h.context&&(g.nodeType||g.jquery)?he(g):he.event,m=he.Deferred(),v=he.Callbacks("once memory"),b=h.statusCode||{},w={},x={},T="canceled",O={readyState:0,getResponseHeader:function(e){var t;if(l){if(!s)for(s={};t=_t.exec(a);)s[t[1].toLowerCase()]=t[2];t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return l?a:null},setRequestHeader:function(e,t){return null==l&&(e=x[e.toLowerCase()]=x[e.toLowerCase()]||e,w[e]=t),this},overrideMimeType:function(e){return null==l&&(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(l)O.always(e[O.status]);else for(t in e)b[t]=[b[t],e[t]];return this},abort:function(e){var t=e||T;return o&&o.abort(t),r(0,t),this}};if(m.promise(O),h.url=((t||h.url||Ot.href)+"").replace(Dt,Ot.protocol+"//"),h.type=n.method||n.type||h.method||h.type,h.dataTypes=(h.dataType||"*").toLowerCase().match(Ne)||[""],null==h.crossDomain){c=te.createElement("a");try{c.href=h.url,c.href=c.href,h.crossDomain=Ht.protocol+"//"+Ht.host!=c.protocol+"//"+c.host}catch(e){h.crossDomain=!0}}if(h.data&&h.processData&&"string"!=typeof h.data&&(h.data=he.param(h.data,h.traditional)),J(Lt,h,n,O),l)return O;f=he.event&&h.global,f&&0===he.active++&&he.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!Ft.test(h.type),i=h.url.replace(Pt,""),h.hasContent?h.data&&h.processData&&0===(h.contentType||"").indexOf("application/x-www-form-urlencoded")&&(h.data=h.data.replace(Nt,"+")):(d=h.url.slice(i.length),h.data&&(i+=(St.test(i)?"&":"?")+h.data,delete h.data),h.cache===!1&&(i=i.replace(It,"$1"),d=(St.test(i)?"&":"?")+"_="+jt++ +d),h.url=i+d),h.ifModified&&(he.lastModified[i]&&O.setRequestHeader("If-Modified-Since",he.lastModified[i]),he.etag[i]&&O.setRequestHeader("If-None-Match",he.etag[i])),(h.data&&h.hasContent&&h.contentType!==!1||n.contentType)&&O.setRequestHeader("Content-Type",h.contentType),O.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+Rt+"; q=0.01":""):h.accepts["*"]);for(p in h.headers)O.setRequestHeader(p,h.headers[p]);if(h.beforeSend&&(h.beforeSend.call(g,O,h)===!1||l))return O.abort();if(T="abort",v.add(h.complete),O.done(h.success),O.fail(h.error),o=J(qt,h,n,O)){if(O.readyState=1,f&&y.trigger("ajaxSend",[O,h]),l)return O;h.async&&h.timeout>0&&(u=e.setTimeout(function(){O.abort("timeout")},h.timeout));try{l=!1,o.send(w,r)}catch(e){if(l)throw e;r(-1,e)}}else r(-1,"No Transport");return O},getJSON:function(e,t,n){return he.get(e,t,n,"json")},getScript:function(e,t){return he.get(e,void 0,t,"script")}}),he.each(["get","post"],function(e,t){he[t]=function(e,n,r,o){return he.isFunction(n)&&(o=o||r,r=n,n=void 0),he.ajax(he.extend({url:e,type:t,dataType:o,data:n,success:r},he.isPlainObject(e)&&e))}}),he._evalUrl=function(e){return he.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},he.fn.extend({wrapAll:function(e){var t;return this[0]&&(he.isFunction(e)&&(e=e.call(this[0])),t=he(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return this.each(he.isFunction(e)?function(t){he(this).wrapInner(e.call(this,t))}:function(){var t=he(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=he.isFunction(e);return this.each(function(n){he(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){he(this).replaceWith(this.childNodes)}),this}}),he.expr.pseudos.hidden=function(e){return!he.expr.pseudos.visible(e)},he.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},he.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var $t={0:200,1223:204},zt=he.ajaxSettings.xhr();pe.cors=!!zt&&"withCredentials"in zt,pe.ajax=zt=!!zt,he.ajaxTransport(function(t){var n,r;return pe.cors||zt&&!t.crossDomain?{send:function(o,i){var a,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(a in t.xhrFields)s[a]=t.xhrFields[a];t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");for(a in o)s.setRequestHeader(a,o[a]);n=function(e){return function(){n&&(n=r=s.onload=s.onerror=s.onabort=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?i(0,"error"):i(s.status,s.statusText):i($t[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),r=s.onerror=n("error"),void 0!==s.onabort?s.onabort=r:s.onreadystatechange=function(){4===s.readyState&&e.setTimeout(function(){n&&r()})},n=n("abort");try{s.send(t.hasContent&&t.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}:void 0}),he.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),he.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return he.globalEval(e),e}}}),he.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),he.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,o){t=he("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&o("error"===e.type?404:200,e.type)}),te.head.appendChild(t[0])},abort:function(){n&&n()}}}});var Wt=[],Bt=/(=)\?(?=&|$)|\?\?/;he.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Wt.pop()||he.expando+"_"+jt++;return this[e]=!0,e}}),he.ajaxPrefilter("json jsonp",function(t,n,r){var o,i,a,s=t.jsonp!==!1&&(Bt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Bt.test(t.data)&&"data");return s||"jsonp"===t.dataTypes[0]?(o=t.jsonpCallback=he.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Bt,"$1"+o):t.jsonp!==!1&&(t.url+=(St.test(t.url)?"&":"?")+t.jsonp+"="+o),t.converters["script json"]=function(){return a||he.error(o+" was not called"),a[0]},t.dataTypes[0]="json",i=e[o],e[o]=function(){a=arguments},r.always(function(){void 0===i?he(e).removeProp(o):e[o]=i,t[o]&&(t.jsonpCallback=n.jsonpCallback,Wt.push(o)),a&&he.isFunction(i)&&i(a[0]),a=i=void 0}),"script"):void 0}),pe.createHTMLDocument=function(){var e=te.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),he.parseHTML=function(e,t,n){if("string"!=typeof e)return[];"boolean"==typeof t&&(n=t,t=!1);var r,o,i;return t||(pe.createHTMLDocument?(t=te.implementation.createHTMLDocument(""),r=t.createElement("base"),r.href=te.location.href,t.head.appendChild(r)):t=te),o=Oe.exec(e),i=!n&&[],o?[t.createElement(o[1])]:(o=b([e],t,i),i&&i.length&&he(i).remove(),he.merge([],o.childNodes))},he.fn.load=function(e,t,n){var r,o,i,a=this,s=e.indexOf(" ");return s>-1&&(r=V(e.slice(s)),e=e.slice(0,s)),he.isFunction(t)?(n=t,t=void 0):t&&"object"===("undefined"==typeof t?"undefined":_typeof(t))&&(o="POST"),a.length>0&&he.ajax({url:e,type:o||"GET",dataType:"html",data:t}).done(function(e){i=arguments,a.html(r?he("<div>").append(he.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,i||[e.responseText,t,e])})}),this},he.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){he.fn[t]=function(e){return this.on(t,e)}}),he.expr.pseudos.animated=function(e){return he.grep(he.timers,function(t){return e===t.elem}).length},he.offset={setOffset:function(e,t,n){var r,o,i,a,s,u,c,l=he.css(e,"position"),f=he(e),p={};"static"===l&&(e.style.position="relative"),s=f.offset(),i=he.css(e,"top"),u=he.css(e,"left"),c=("absolute"===l||"fixed"===l)&&(i+u).indexOf("auto")>-1,c?(r=f.position(),a=r.top,o=r.left):(a=parseFloat(i)||0,o=parseFloat(u)||0),he.isFunction(t)&&(t=t.call(e,n,he.extend({},s))),null!=t.top&&(p.top=t.top-s.top+a),null!=t.left&&(p.left=t.left-s.left+o),"using"in t?t.using.call(e,p):f.css(p)}},he.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){he.offset.setOffset(this,e,t)});var t,n,r,o,i=this[0];if(i)return i.getClientRects().length?(r=i.getBoundingClientRect(),r.width||r.height?(o=i.ownerDocument,n=K(o),t=o.documentElement,{top:r.top+n.pageYOffset-t.clientTop,left:r.left+n.pageXOffset-t.clientLeft}):r):{top:0,left:0}},position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===he.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),he.nodeName(e[0],"html")||(r=e.offset()),r={top:r.top+he.css(e[0],"borderTopWidth",!0),left:r.left+he.css(e[0],"borderLeftWidth",!0)}),{top:t.top-r.top-he.css(n,"marginTop",!0),left:t.left-r.left-he.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===he.css(e,"position");)e=e.offsetParent;return e||Ye})}}),he.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;he.fn[e]=function(r){return _e(this,function(e,r,o){var i=K(e);return void 0===o?i?i[t]:e[r]:void(i?i.scrollTo(n?i.pageXOffset:o,n?o:i.pageYOffset):e[r]=o)},e,r,arguments.length)}}),he.each(["top","left"],function(e,t){he.cssHooks[t]=I(pe.pixelPosition,function(e,n){return n?(n=P(e,t),at.test(n)?he(e).position()[t]+"px":n):void 0})}),he.each({Height:"height",Width:"width"},function(e,t){he.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){he.fn[r]=function(o,i){var a=arguments.length&&(n||"boolean"!=typeof o),s=n||(o===!0||i===!0?"margin":"border");return _e(this,function(t,n,o){var i;return he.isWindow(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):void 0===o?he.css(t,n,s):he.style(t,n,o,s)},t,a?o:void 0,a)}})}),he.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),he.parseJSON=JSON.parse,"function"==typeof define&&define.amd&&define("jquery",[],function(){return he});var Vt=e.jQuery,Ut=e.$;return he.noConflict=function(t){return e.$===he&&(e.$=Ut),t&&e.jQuery===he&&(e.jQuery=Vt),he},t||(e.jQuery=e.$=he),he}),/*!
  * https://github.com/paulmillr/es6-shim
  * @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
  *   and contributors,  MIT License
  * es6-shim: v0.35.1
  * see https://github.com/paulmillr/es6-shim/blob/0.35.1/LICENSE
  * Details and documentation:
  * https://github.com/paulmillr/es6-shim/
  */
function(e,t){"function"==typeof define&&define.amd?define("es6-shim",t):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=t():e.returnExports=t()}(this,function(){var e,t=Function.call.bind(Function.apply),n=Function.call.bind(Function.call),r=Array.isArray,o=Object.keys,i=function(e){return function(){return!t(e,this,arguments)}},a=function(e){try{return e(),!1}catch(e){return!0}},s=function(e){try{return e()}catch(e){return!1}},u=i(a),c=function(){return!a(function(){Object.defineProperty({},"x",{get:function(){}})})},l=!!Object.defineProperty&&c(),f="foo"===function(){}.name,p=Function.call.bind(Array.prototype.forEach),d=Function.call.bind(Array.prototype.reduce),h=Function.call.bind(Array.prototype.filter),g=Function.call.bind(Array.prototype.some),y=function(e,t,n,r){!r&&t in e||(l?Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:n}):e[t]=n)},m=function(e,t,n){p(o(t),function(r){var o=t[r];y(e,r,o,!!n)})},v=Function.call.bind(Object.prototype.toString),b="function"==typeof/abc/?function(e){return"function"==typeof e&&"[object Function]"===v(e)}:function(e){return"function"==typeof e},w={getter:function(e,t,n){if(!l)throw new TypeError("getters require true ES5 support");Object.defineProperty(e,t,{configurable:!0,enumerable:!1,get:n})},proxy:function(e,t,n){if(!l)throw new TypeError("getters require true ES5 support");var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,{configurable:r.configurable,enumerable:r.enumerable,get:function(){return e[t]},set:function(n){e[t]=n}})},redefine:function(e,t,n){if(l){var r=Object.getOwnPropertyDescriptor(e,t);r.value=n,Object.defineProperty(e,t,r)}else e[t]=n},defineByDescriptor:function(e,t,n){l?Object.defineProperty(e,t,n):"value"in n&&(e[t]=n.value)},preserveToString:function(e,t){t&&b(t.toString)&&y(e,"toString",t.toString.bind(t),!0)}},x=Object.create||function(e,t){var n=function(){};n.prototype=e;var r=new n;return"undefined"!=typeof t&&o(t).forEach(function(e){w.defineByDescriptor(r,e,t[e])}),r},T=function(e,t){return Object.setPrototypeOf?s(function(){var n=function t(n){var r=new e(n);return Object.setPrototypeOf(r,t.prototype),r};return Object.setPrototypeOf(n,e),n.prototype=x(e.prototype,{constructor:{value:n}}),t(n)}):!1},O=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")},j=O(),S=j.isFinite,k=Function.call.bind(String.prototype.indexOf),C=Function.apply.bind(Array.prototype.indexOf),A=Function.call.bind(Array.prototype.concat),E=Function.call.bind(String.prototype.slice),N=Function.call.bind(Array.prototype.push),P=Function.apply.bind(Array.prototype.push),I=Function.call.bind(Array.prototype.shift),_=Math.max,M=Math.min,F=Math.floor,D=Math.abs,L=Math.exp,q=Math.log,R=Math.sqrt,H=Function.call.bind(Object.prototype.hasOwnProperty),$=function(){},z=j.Symbol||{},W=z.species||"@@species",B=Number.isNaN||function(e){return e!==e},V=Number.isFinite||function(e){return"number"==typeof e&&S(e)},U=b(Math.sign)?Math.sign:function(e){var t=Number(e);return 0===t?t:B(t)?t:0>t?-1:1},G=function(e){return"[object Arguments]"===v(e)},X=function(e){return null!==e&&"object"===("undefined"==typeof e?"undefined":_typeof(e))&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==v(e)&&"[object Function]"===v(e.callee)},J=G(arguments)?G:X,Y={primitive:function(e){return null===e||"function"!=typeof e&&"object"!==("undefined"==typeof e?"undefined":_typeof(e))},string:function(e){return"[object String]"===v(e)},regex:function(e){return"[object RegExp]"===v(e)},symbol:function(e){return"function"==typeof j.Symbol&&"symbol"===("undefined"==typeof e?"undefined":_typeof(e))}},Q=function(e,t,n){var r=e[t];y(e,t,n,!0),w.preserveToString(e[t],r)},Z="function"==typeof z&&"function"==typeof z.for&&Y.symbol(z()),K=Y.symbol(z.iterator)?z.iterator:"_es6-shim iterator_";j.Set&&"function"==typeof(new j.Set)["@@iterator"]&&(K="@@iterator"),j.Reflect||y(j,"Reflect",{},!0);var ee=j.Reflect,te=String,ne={Call:function(e,n){var r=arguments.length>2?arguments[2]:[];if(!ne.IsCallable(e))throw new TypeError(e+" is not a function");return t(e,n,r)},RequireObjectCoercible:function(e,t){if(null==e)throw new TypeError(t||"Cannot call method on "+e);return e},TypeIsObject:function(e){return void 0===e||null===e||e===!0||e===!1?!1:"function"==typeof e||"object"===("undefined"==typeof e?"undefined":_typeof(e))},ToObject:function(e,t){return Object(ne.RequireObjectCoercible(e,t))},IsCallable:b,IsConstructor:function(e){return ne.IsCallable(e)},ToInt32:function(e){return ne.ToNumber(e)>>0},ToUint32:function(e){return ne.ToNumber(e)>>>0},ToNumber:function(e){if("[object Symbol]"===v(e))throw new TypeError("Cannot convert a Symbol value to a number");return+e},ToInteger:function(e){var t=ne.ToNumber(e);return B(t)?0:0!==t&&V(t)?(t>0?1:-1)*F(D(t)):t},ToLength:function(e){var t=ne.ToInteger(e);return 0>=t?0:t>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:t},SameValue:function(e,t){return e===t?0===e?1/e===1/t:!0:B(e)&&B(t)},SameValueZero:function(e,t){return e===t||B(e)&&B(t)},IsIterable:function(e){return ne.TypeIsObject(e)&&("undefined"!=typeof e[K]||J(e))},GetIterator:function(t){if(J(t))return new e(t,"value");var n=ne.GetMethod(t,K);if(!ne.IsCallable(n))throw new TypeError("value is not an iterable");var r=ne.Call(n,t);if(!ne.TypeIsObject(r))throw new TypeError("bad iterator");return r},GetMethod:function(e,t){var n=ne.ToObject(e)[t];if(void 0===n||null===n)return void 0;if(!ne.IsCallable(n))throw new TypeError("Method not callable: "+t);return n},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,t){var n=ne.GetMethod(e,"return");if(void 0!==n){var r,o;try{r=ne.Call(n,e)}catch(e){o=e}if(!t){if(o)throw o;if(!ne.TypeIsObject(r))throw new TypeError("Iterator's return method returned a non-object.")}}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!ne.TypeIsObject(t))throw new TypeError("bad iterator");return t},IteratorStep:function(e){var t=ne.IteratorNext(e),n=ne.IteratorComplete(t);return n?!1:t},Construct:function(e,t,n,r){var o="undefined"==typeof n?e:n;if(!r&&ee.construct)return ee.construct(e,t,o);var i=o.prototype;ne.TypeIsObject(i)||(i=Object.prototype);var a=x(i),s=ne.Call(e,a,t);return ne.TypeIsObject(s)?s:a},SpeciesConstructor:function(e,t){var n=e.constructor;if(void 0===n)return t;if(!ne.TypeIsObject(n))throw new TypeError("Bad constructor");var r=n[W];if(void 0===r||null===r)return t;if(!ne.IsConstructor(r))throw new TypeError("Bad @@species");return r},CreateHTML:function(e,t,n,r){var o=ne.ToString(e),i="<"+t;if(""!==n){var a=ne.ToString(r),s=a.replace(/"/g,"&quot;");i+=" "+n+'="'+s+'"'}var u=i+">",c=u+o;return c+"</"+t+">"},IsRegExp:function(e){if(!ne.TypeIsObject(e))return!1;var t=e[z.match];return"undefined"!=typeof t?!!t:Y.regex(e)},ToString:function(e){return te(e)}};if(l&&Z){var re=function(e){if(Y.symbol(z[e]))return z[e];var t=z.for("Symbol."+e);return Object.defineProperty(z,e,{configurable:!1,enumerable:!1,writable:!1,value:t}),t};if(!Y.symbol(z.search)){var oe=re("search"),ie=String.prototype.search;y(RegExp.prototype,oe,function(e){return ne.Call(ie,e,[this])});var ae=function(e){var t=ne.RequireObjectCoercible(this);if(null!==e&&"undefined"!=typeof e){var n=ne.GetMethod(e,oe);if("undefined"!=typeof n)return ne.Call(n,e,[t])}return ne.Call(ie,t,[ne.ToString(e)])};Q(String.prototype,"search",ae)}if(!Y.symbol(z.replace)){var se=re("replace"),ue=String.prototype.replace;y(RegExp.prototype,se,function(e,t){return ne.Call(ue,e,[this,t])});var ce=function(e,t){var n=ne.RequireObjectCoercible(this);if(null!==e&&"undefined"!=typeof e){var r=ne.GetMethod(e,se);if("undefined"!=typeof r)return ne.Call(r,e,[n,t])}return ne.Call(ue,n,[ne.ToString(e),t])};Q(String.prototype,"replace",ce)}if(!Y.symbol(z.split)){var le=re("split"),fe=String.prototype.split;y(RegExp.prototype,le,function(e,t){return ne.Call(fe,e,[this,t])});var pe=function(e,t){var n=ne.RequireObjectCoercible(this);if(null!==e&&"undefined"!=typeof e){var r=ne.GetMethod(e,le);if("undefined"!=typeof r)return ne.Call(r,e,[n,t])}return ne.Call(fe,n,[ne.ToString(e),t])};Q(String.prototype,"split",pe)}var de=Y.symbol(z.match),he=de&&function(){var e={};return e[z.match]=function(){return 42},42!=="a".match(e)}();if(!de||he){var ge=re("match"),ye=String.prototype.match;y(RegExp.prototype,ge,function(e){return ne.Call(ye,e,[this])});var me=function(e){var t=ne.RequireObjectCoercible(this);if(null!==e&&"undefined"!=typeof e){var n=ne.GetMethod(e,ge);if("undefined"!=typeof n)return ne.Call(n,e,[t])}return ne.Call(ye,t,[ne.ToString(e)])};Q(String.prototype,"match",me)}}var ve=function(e,t,n){w.preserveToString(t,e),Object.setPrototypeOf&&Object.setPrototypeOf(e,t),l?p(Object.getOwnPropertyNames(e),function(r){r in $||n[r]||w.proxy(e,r,t)}):p(Object.keys(e),function(r){r in $||n[r]||(t[r]=e[r])}),t.prototype=e.prototype,w.redefine(e.prototype,"constructor",t)},be=function(){return this},we=function(e){l&&!H(e,W)&&w.getter(e,W,be)},xe=function(e,t){var n=t||function(){return this};y(e,K,n),!e[K]&&Y.symbol(K)&&(e[K]=n)},Te=function(e,t,n){l?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:n}):e[t]=n},Oe=function(e,t,n){if(Te(e,t,n),!ne.SameValue(e[t],n))throw new TypeError("property is nonconfigurable")},je=function(e,t,n,r){if(!ne.TypeIsObject(e))throw new TypeError("Constructor requires `new`: "+t.name);var o=t.prototype;ne.TypeIsObject(o)||(o=n);var i=x(o);for(var a in r)if(H(r,a)){var s=r[a];y(i,a,s,!0)}return i};if(String.fromCodePoint&&1!==String.fromCodePoint.length){var Se=String.fromCodePoint;Q(String,"fromCodePoint",function(){return ne.Call(Se,this,arguments)})}var ke={fromCodePoint:function(){for(var e,t=[],n=0,r=arguments.length;r>n;n++){if(e=Number(arguments[n]),!ne.SameValue(e,ne.ToInteger(e))||0>e||e>1114111)throw new RangeError("Invalid code point "+e);65536>e?N(t,String.fromCharCode(e)):(e-=65536,N(t,String.fromCharCode((e>>10)+55296)),N(t,String.fromCharCode(e%1024+56320)))}return t.join("")},raw:function(e){var t=ne.ToObject(e,"bad callSite"),n=ne.ToObject(t.raw,"bad raw value"),r=n.length,o=ne.ToLength(r);if(0>=o)return"";for(var i,a,s,u,c=[],l=0;o>l&&(i=ne.ToString(l),s=ne.ToString(n[i]),N(c,s),!(l+1>=o));)a=l+1<arguments.length?arguments[l+1]:"",u=ne.ToString(a),N(c,u),l+=1;return c.join("")}};String.raw&&"xy"!==String.raw({raw:{0:"x",1:"y",length:2}})&&Q(String,"raw",ke.raw),m(String,ke);var Ce=function e(t,n){if(1>n)return"";if(n%2)return e(t,n-1)+t;var r=e(t,n/2);return r+r},Ae=1/0,Ee={repeat:function(e){var t=ne.ToString(ne.RequireObjectCoercible(this)),n=ne.ToInteger(e);if(0>n||n>=Ae)throw new RangeError("repeat count must be less than infinity and not overflow maximum string size");return Ce(t,n)},startsWith:function(e){var t=ne.ToString(ne.RequireObjectCoercible(this));if(ne.IsRegExp(e))throw new TypeError('Cannot call method "startsWith" with a regex');var n,r=ne.ToString(e);arguments.length>1&&(n=arguments[1]);var o=_(ne.ToInteger(n),0);return E(t,o,o+r.length)===r},endsWith:function(e){var t=ne.ToString(ne.RequireObjectCoercible(this));if(ne.IsRegExp(e))throw new TypeError('Cannot call method "endsWith" with a regex');var n,r=ne.ToString(e),o=t.length;arguments.length>1&&(n=arguments[1]);var i="undefined"==typeof n?o:ne.ToInteger(n),a=M(_(i,0),o);return E(t,a-r.length,a)===r},includes:function(e){if(ne.IsRegExp(e))throw new TypeError('"includes" does not accept a RegExp');var t,n=ne.ToString(e);return arguments.length>1&&(t=arguments[1]),-1!==k(this,n,t)},codePointAt:function(e){var t=ne.ToString(ne.RequireObjectCoercible(this)),n=ne.ToInteger(e),r=t.length;if(n>=0&&r>n){var o=t.charCodeAt(n),i=n+1===r;if(55296>o||o>56319||i)return o;var a=t.charCodeAt(n+1);return 56320>a||a>57343?o:1024*(o-55296)+(a-56320)+65536}}};if(String.prototype.includes&&"a".includes("a",1/0)!==!1&&Q(String.prototype,"includes",Ee.includes),String.prototype.startsWith&&String.prototype.endsWith){var Ne=a(function(){"/a/".startsWith(/a/)}),Pe=s(function(){return"abc".startsWith("a",1/0)===!1});Ne&&Pe||(Q(String.prototype,"startsWith",Ee.startsWith),Q(String.prototype,"endsWith",Ee.endsWith))}if(Z){var Ie=s(function(){var e=/a/;return e[z.match]=!1,"/a/".startsWith(e)});Ie||Q(String.prototype,"startsWith",Ee.startsWith);var _e=s(function(){var e=/a/;return e[z.match]=!1,"/a/".endsWith(e)});_e||Q(String.prototype,"endsWith",Ee.endsWith);var Me=s(function(){var e=/a/;return e[z.match]=!1,"/a/".includes(e)});Me||Q(String.prototype,"includes",Ee.includes)}m(String.prototype,Ee);var Fe=["	\n\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028","\u2029\ufeff"].join(""),De=new RegExp("(^["+Fe+"]+)|(["+Fe+"]+$)","g"),Le=function(){return ne.ToString(ne.RequireObjectCoercible(this)).replace(De,"")},qe=["\x85","\u200b","\ufffe"].join(""),Re=new RegExp("["+qe+"]","g"),He=/^[\-+]0x[0-9a-f]+$/i,$e=qe.trim().length!==qe.length;y(String.prototype,"trim",Le,$e);var ze=function(e){return{value:e,done:0===arguments.length}},We=function(e){ne.RequireObjectCoercible(e),this._s=ne.ToString(e),this._i=0};We.prototype.next=function(){var e=this._s,t=this._i;if("undefined"==typeof e||t>=e.length)return this._s=void 0,ze();var n,r,o=e.charCodeAt(t);return 55296>o||o>56319||t+1===e.length?r=1:(n=e.charCodeAt(t+1),r=56320>n||n>57343?1:2),this._i=t+r,ze(e.substr(t,r))},xe(We.prototype),xe(String.prototype,function(){return new We(this)});var Be={from:function(e){var t,r=this;arguments.length>1&&(t=arguments[1]);var o,i;if("undefined"==typeof t)o=!1;else{if(!ne.IsCallable(t))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(i=arguments[2]),o=!0}var a,s,u,c="undefined"!=typeof(J(e)||ne.GetMethod(e,K));if(c){s=ne.IsConstructor(r)?Object(new r):[];var l,f,p=ne.GetIterator(e);for(u=0;;){if(l=ne.IteratorStep(p),l===!1)break;f=l.value;try{o&&(f="undefined"==typeof i?t(f,u):n(t,i,f,u)),s[u]=f}catch(e){throw ne.IteratorClose(p,!0),e}u+=1}a=u}else{var d=ne.ToObject(e);a=ne.ToLength(d.length),s=ne.IsConstructor(r)?Object(new r(a)):new Array(a);var h;for(u=0;a>u;++u)h=d[u],o&&(h="undefined"==typeof i?t(h,u):n(t,i,h,u)),Oe(s,u,h)}return s.length=a,s},of:function(){for(var e=arguments.length,t=this,n=r(t)||!ne.IsCallable(t)?new Array(e):ne.Construct(t,[e]),o=0;e>o;++o)Oe(n,o,arguments[o]);return n.length=e,n}};m(Array,Be),we(Array),e=function(e,t){this.i=0,this.array=e,this.kind=t},m(e.prototype,{next:function(){var t=this.i,n=this.array;if(!(this instanceof e))throw new TypeError("Not an ArrayIterator");if("undefined"!=typeof n)for(var r=ne.ToLength(n.length);r>t;t++){var o,i=this.kind;return"key"===i?o=t:"value"===i?o=n[t]:"entry"===i&&(o=[t,n[t]]),this.i=t+1,ze(o)}return this.array=void 0,ze()}}),xe(e.prototype);var Ve=Array.of===Be.of||function(){var e=function(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&2===t.length}();Ve||Q(Array,"of",Be.of);var Ue={copyWithin:function(e,t){var n,r=ne.ToObject(this),o=ne.ToLength(r.length),i=ne.ToInteger(e),a=ne.ToInteger(t),s=0>i?_(o+i,0):M(i,o),u=0>a?_(o+a,0):M(a,o);arguments.length>2&&(n=arguments[2]);var c="undefined"==typeof n?o:ne.ToInteger(n),l=0>c?_(o+c,0):M(c,o),f=M(l-u,o-s),p=1;for(s>u&&u+f>s&&(p=-1,u+=f-1,s+=f-1);f>0;)u in r?r[s]=r[u]:delete r[s],u+=p,s+=p,f-=1;return r},fill:function(e){var t;arguments.length>1&&(t=arguments[1]);var n;arguments.length>2&&(n=arguments[2]);var r=ne.ToObject(this),o=ne.ToLength(r.length);t=ne.ToInteger("undefined"==typeof t?0:t),n=ne.ToInteger("undefined"==typeof n?o:n);for(var i=0>t?_(o+t,0):M(t,o),a=0>n?o+n:n,s=i;o>s&&a>s;++s)r[s]=e;return r},find:function(e){var t=ne.ToObject(this),r=ne.ToLength(t.length);if(!ne.IsCallable(e))throw new TypeError("Array#find: predicate must be a function");for(var o,i=arguments.length>1?arguments[1]:null,a=0;r>a;a++)if(o=t[a],i){if(n(e,i,o,a,t))return o}else if(e(o,a,t))return o},findIndex:function(e){var t=ne.ToObject(this),r=ne.ToLength(t.length);if(!ne.IsCallable(e))throw new TypeError("Array#findIndex: predicate must be a function");for(var o=arguments.length>1?arguments[1]:null,i=0;r>i;i++)if(o){if(n(e,o,t[i],i,t))return i}else if(e(t[i],i,t))return i;return-1},keys:function(){return new e(this,"key")},values:function(){return new e(this,"value")},entries:function(){return new e(this,"entry")}};if(Array.prototype.keys&&!ne.IsCallable([1].keys().next)&&delete Array.prototype.keys,Array.prototype.entries&&!ne.IsCallable([1].entries().next)&&delete Array.prototype.entries,Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[K]&&(m(Array.prototype,{values:Array.prototype[K]}),Y.symbol(z.unscopables)&&(Array.prototype[z.unscopables].values=!0)),f&&Array.prototype.values&&"values"!==Array.prototype.values.name){var Ge=Array.prototype.values;Q(Array.prototype,"values",function(){return ne.Call(Ge,this,arguments)}),y(Array.prototype,K,Array.prototype.values,!0)}m(Array.prototype,Ue),1/[!0].indexOf(!0,-0)<0&&y(Array.prototype,"indexOf",function(){var e=C(this,arguments);return 0===e&&0>1/e?0:e},!0),xe(Array.prototype,function(){return this.values()}),Object.getPrototypeOf&&xe(Object.getPrototypeOf([].values()));var Xe=function(){return s(function(){return 0===Array.from({length:-1}).length})}(),Je=function(){var e=Array.from([0].entries());return 1===e.length&&r(e[0])&&0===e[0][0]&&0===e[0][1]}();Xe&&Je||Q(Array,"from",Be.from);var Ye=function(){return s(function(){return Array.from([0],void 0)})}();if(!Ye){var Qe=Array.from;Q(Array,"from",function(e){return arguments.length>1&&"undefined"!=typeof arguments[1]?ne.Call(Qe,this,arguments):n(Qe,this,e)})}var Ze=-(Math.pow(2,32)-1),Ke=function(e,t){var r={length:Ze};return r[t?(r.length>>>0)-1:0]=!0,s(function(){return n(e,r,function(){throw new RangeError("should not reach here")},[]),!0})};if(!Ke(Array.prototype.forEach)){var et=Array.prototype.forEach;Q(Array.prototype,"forEach",function(){return ne.Call(et,this.length>=0?this:[],arguments)},!0)}if(!Ke(Array.prototype.map)){var tt=Array.prototype.map;Q(Array.prototype,"map",function(){return ne.Call(tt,this.length>=0?this:[],arguments)},!0)}if(!Ke(Array.prototype.filter)){var nt=Array.prototype.filter;Q(Array.prototype,"filter",function(){return ne.Call(nt,this.length>=0?this:[],arguments)},!0)}if(!Ke(Array.prototype.some)){var rt=Array.prototype.some;Q(Array.prototype,"some",function(){return ne.Call(rt,this.length>=0?this:[],arguments)},!0)}if(!Ke(Array.prototype.every)){var ot=Array.prototype.every;Q(Array.prototype,"every",function(){return ne.Call(ot,this.length>=0?this:[],arguments)},!0)}if(!Ke(Array.prototype.reduce)){var it=Array.prototype.reduce;Q(Array.prototype,"reduce",function(){return ne.Call(it,this.length>=0?this:[],arguments)},!0)}if(!Ke(Array.prototype.reduceRight,!0)){var at=Array.prototype.reduceRight;Q(Array.prototype,"reduceRight",function(){return ne.Call(at,this.length>=0?this:[],arguments)},!0)}var st=8!==Number("0o10"),ut=2!==Number("0b10"),ct=g(qe,function(e){return 0===Number(e+0+e)});if(st||ut||ct){var lt=Number,ft=/^0b[01]+$/i,pt=/^0o[0-7]+$/i,dt=ft.test.bind(ft),ht=pt.test.bind(pt),gt=function(e){var t;if("function"==typeof e.valueOf&&(t=e.valueOf(),Y.primitive(t)))return t;if("function"==typeof e.toString&&(t=e.toString(),Y.primitive(t)))return t;throw new TypeError("No default value")},yt=Re.test.bind(Re),mt=He.test.bind(He),vt=function(){var e=function(t){var n;n=arguments.length>0?Y.primitive(t)?t:gt(t,"number"):0,"string"==typeof n&&(n=ne.Call(Le,n),dt(n)?n=parseInt(E(n,2),2):ht(n)?n=parseInt(E(n,2),8):(yt(n)||mt(n))&&(n=0/0));var r=this,o=s(function(){return lt.prototype.valueOf.call(r),!0});return r instanceof e&&!o?new lt(n):lt(n)};return e}();ve(lt,vt,{}),m(vt,{NaN:lt.NaN,MAX_VALUE:lt.MAX_VALUE,MIN_VALUE:lt.MIN_VALUE,NEGATIVE_INFINITY:lt.NEGATIVE_INFINITY,POSITIVE_INFINITY:lt.POSITIVE_INFINITY}),Number=vt,w.redefine(j,"Number",vt)}var bt=Math.pow(2,53)-1;m(Number,{MAX_SAFE_INTEGER:bt,MIN_SAFE_INTEGER:-bt,EPSILON:2.220446049250313e-16,parseInt:j.parseInt,parseFloat:j.parseFloat,isFinite:V,isInteger:function(e){return V(e)&&ne.ToInteger(e)===e},isSafeInteger:function(e){return Number.isInteger(e)&&D(e)<=Number.MAX_SAFE_INTEGER},isNaN:B}),y(Number,"parseInt",j.parseInt,Number.parseInt!==j.parseInt),[,1].find(function(e,t){return 0===t})||Q(Array.prototype,"find",Ue.find),0!==[,1].findIndex(function(e,t){return 0===t})&&Q(Array.prototype,"findIndex",Ue.findIndex);var wt=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable),xt=function(e,t){l&&wt(e,t)&&Object.defineProperty(e,t,{enumerable:!1})},Tt=function(){for(var e=Number(this),t=arguments.length,n=t-e,r=new Array(0>n?0:n),o=e;t>o;++o)r[o-e]=arguments[o];return r},Ot=function(e){return function(t,n){return t[n]=e[n],t}},jt=function(e,t){var n,r=o(Object(t));return ne.IsCallable(Object.getOwnPropertySymbols)&&(n=h(Object.getOwnPropertySymbols(Object(t)),wt(t))),d(A(r,n||[]),Ot(t),e)},St={assign:function(e){var t=ne.ToObject(e,"Cannot convert undefined or null to object");return d(ne.Call(Tt,1,arguments),jt,t)},is:function(e,t){return ne.SameValue(e,t)}},kt=Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return"y"===e[1]}}();if(kt&&Q(Object,"assign",St.assign),m(Object,St),l){var Ct={setPrototypeOf:function(e,t){var r,o=function(e,t){if(!ne.TypeIsObject(e))throw new TypeError("cannot set prototype on a non-object");if(null!==t&&!ne.TypeIsObject(t))throw new TypeError("can only set prototype to an object or null"+t)},i=function(e,t){return o(e,t),n(r,e,t),e};try{r=e.getOwnPropertyDescriptor(e.prototype,t).set,n(r,{},null)}catch(n){if(e.prototype!=={}[t])return;r=function(e){this[t]=e},i.polyfill=i(i({},null),e.prototype)instanceof e}return i}(Object,"__proto__")};m(Object,Ct)}Object.setPrototypeOf&&Object.getPrototypeOf&&null!==Object.getPrototypeOf(Object.setPrototypeOf({},null))&&null===Object.getPrototypeOf(Object.create(null))&&!function(){var e=Object.create(null),t=Object.getPrototypeOf,n=Object.setPrototypeOf;Object.getPrototypeOf=function(n){var r=t(n);return r===e?null:r},Object.setPrototypeOf=function(t,r){var o=null===r?e:r;return n(t,o)},Object.setPrototypeOf.polyfill=!1}();var At=!a(function(){Object.keys("foo")});if(!At){var Et=Object.keys;Q(Object,"keys",function(e){return Et(ne.ToObject(e))}),o=Object.keys}var Nt=a(function(){Object.keys(/a/g)});if(Nt){var Pt=Object.keys;Q(Object,"keys",function(e){if(Y.regex(e)){var t=[];for(var n in e)H(e,n)&&N(t,n);return t}return Pt(e)}),o=Object.keys}if(Object.getOwnPropertyNames){var It=!a(function(){Object.getOwnPropertyNames("foo")});if(!It){var _t="object"===("undefined"==typeof window?"undefined":_typeof(window))?Object.getOwnPropertyNames(window):[],Mt=Object.getOwnPropertyNames;Q(Object,"getOwnPropertyNames",function(e){var t=ne.ToObject(e);if("[object Window]"===v(t))try{return Mt(t)}catch(e){return A([],_t)}return Mt(t)})}}if(Object.getOwnPropertyDescriptor){var Ft=!a(function(){Object.getOwnPropertyDescriptor("foo","bar")});if(!Ft){var Dt=Object.getOwnPropertyDescriptor;Q(Object,"getOwnPropertyDescriptor",function(e,t){return Dt(ne.ToObject(e),t)})}}if(Object.seal){var Lt=!a(function(){Object.seal("foo")});if(!Lt){var qt=Object.seal;Q(Object,"seal",function(e){return ne.TypeIsObject(e)?qt(e):e})}}if(Object.isSealed){var Rt=!a(function(){Object.isSealed("foo")});if(!Rt){var Ht=Object.isSealed;Q(Object,"isSealed",function(e){return ne.TypeIsObject(e)?Ht(e):!0})}}if(Object.freeze){var $t=!a(function(){Object.freeze("foo")});if(!$t){var zt=Object.freeze;Q(Object,"freeze",function(e){return ne.TypeIsObject(e)?zt(e):e})}}if(Object.isFrozen){var Wt=!a(function(){Object.isFrozen("foo")});if(!Wt){var Bt=Object.isFrozen;Q(Object,"isFrozen",function(e){return ne.TypeIsObject(e)?Bt(e):!0})}}if(Object.preventExtensions){var Vt=!a(function(){Object.preventExtensions("foo")});if(!Vt){var Ut=Object.preventExtensions;Q(Object,"preventExtensions",function(e){return ne.TypeIsObject(e)?Ut(e):e})}}if(Object.isExtensible){var Gt=!a(function(){Object.isExtensible("foo")});if(!Gt){var Xt=Object.isExtensible;Q(Object,"isExtensible",function(e){return ne.TypeIsObject(e)?Xt(e):!1})}}if(Object.getPrototypeOf){var Jt=!a(function(){Object.getPrototypeOf("foo")});if(!Jt){var Yt=Object.getPrototypeOf;Q(Object,"getPrototypeOf",function(e){return Yt(ne.ToObject(e))})}}var Qt=l&&function(){var e=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return e&&ne.IsCallable(e.get)}();if(l&&!Qt){var Zt=function(){if(!ne.TypeIsObject(this))throw new TypeError("Method called on incompatible type: must be an object.");var e="";return this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.unicode&&(e+="u"),this.sticky&&(e+="y"),e};w.getter(RegExp.prototype,"flags",Zt)}var Kt=l&&s(function(){return"/a/i"===String(new RegExp(/a/g,"i"))}),en=Z&&l&&function(){var e=/./;return e[z.match]=!1,RegExp(e)===e}(),tn=s(function(){return"/abc/"===RegExp.prototype.toString.call({source:"abc"})}),nn=tn&&s(function(){return"/a/b"===RegExp.prototype.toString.call({source:"a",flags:"b"})});if(!tn||!nn){var rn=RegExp.prototype.toString;y(RegExp.prototype,"toString",function(){var e=ne.RequireObjectCoercible(this);if(Y.regex(e))return n(rn,e);var t=te(e.source),r=te(e.flags);return"/"+t+"/"+r},!0),w.preserveToString(RegExp.prototype.toString,rn)}if(l&&(!Kt||en)){var on=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get,an=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{},sn=function(){return this.source},un=ne.IsCallable(an.get)?an.get:sn,cn=RegExp,ln=function(){return function e(t,n){var r=ne.IsRegExp(t),o=this instanceof e;if(!o&&r&&"undefined"==typeof n&&t.constructor===e)return t;var i=t,a=n;return Y.regex(t)?(i=ne.Call(un,t),a="undefined"==typeof n?ne.Call(on,t):n,new e(i,a)):(r&&(i=t.source,a="undefined"==typeof n?t.flags:n),new cn(t,n))}}();ve(cn,ln,{$input:!0}),RegExp=ln,w.redefine(j,"RegExp",ln)}if(l){var fn={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};p(o(fn),function(e){e in RegExp&&!(fn[e]in RegExp)&&w.getter(RegExp,fn[e],function(){return RegExp[e]})})}we(RegExp);var pn=1/Number.EPSILON,dn=function(e){return e+pn-pn},hn=Math.pow(2,-23),gn=Math.pow(2,127)*(2-hn),yn=Math.pow(2,-126),mn=Math.E,vn=Math.LOG2E,bn=Math.LOG10E,wn=Number.prototype.clz;delete Number.prototype.clz;var xn={acosh:function(e){var t=Number(e);return B(t)||1>e?0/0:1===t?0:t===1/0?t:q(t/mn+R(t+1)*R(t-1)/mn)+1},asinh:function e(t){var n=Number(t);return 0!==n&&S(n)?0>n?-e(-n):q(n+R(n*n+1)):n},atanh:function(e){var t=Number(e);return B(t)||-1>t||t>1?0/0:-1===t?-(1/0):1===t?1/0:0===t?t:.5*q((1+t)/(1-t))},cbrt:function(e){var t=Number(e);if(0===t)return t;var n,r=0>t;return r&&(t=-t),t===1/0?n=1/0:(n=L(q(t)/3),n=(t/(n*n)+2*n)/3),r?-n:n},clz32:function(e){var t=Number(e),n=ne.ToUint32(t);return 0===n?32:wn?ne.Call(wn,n):31-F(q(n+.5)*vn)},cosh:function(e){var t=Number(e);return 0===t?1:B(t)?0/0:S(t)?(0>t&&(t=-t),t>21?L(t)/2:(L(t)+L(-t))/2):1/0},expm1:function(e){var t=Number(e);if(t===-(1/0))return-1;if(!S(t)||0===t)return t;if(D(t)>.5)return L(t)-1;for(var n=t,r=0,o=1;r+n!==r;)r+=n,o+=1,n*=t/o;return r},hypot:function(){for(var e=0,t=0,n=0;n<arguments.length;++n){var r=D(Number(arguments[n]));r>t?(e*=t/r*(t/r),e+=1,t=r):e+=r>0?r/t*(r/t):r}return t===1/0?1/0:t*R(e)},log2:function(e){return q(e)*vn},log10:function(e){return q(e)*bn},log1p:function(e){var t=Number(e);return-1>t||B(t)?0/0:0===t||t===1/0?t:-1===t?-(1/0):1+t-1===0?t:t*(q(1+t)/(1+t-1))},sign:U,sinh:function(e){var t=Number(e);return S(t)&&0!==t?D(t)<1?(Math.expm1(t)-Math.expm1(-t))/2:(L(t-1)-L(-t-1))*mn/2:t},tanh:function(e){var t=Number(e);return B(t)||0===t?t:t>=20?1:-20>=t?-1:(Math.expm1(t)-Math.expm1(-t))/(L(t)+L(-t))},trunc:function(e){var t=Number(e);return 0>t?-F(-t):F(t)},imul:function(e,t){var n=ne.ToUint32(e),r=ne.ToUint32(t),o=n>>>16&65535,i=65535&n,a=r>>>16&65535,s=65535&r;return i*s+(o*s+i*a<<16>>>0)|0},fround:function(e){var t=Number(e);if(0===t||t===1/0||t===-(1/0)||B(t))return t;var n=U(t),r=D(t);if(yn>r)return n*dn(r/yn/hn)*yn*hn;var o=(1+hn/Number.EPSILON)*r,i=o-(o-r);return i>gn||B(i)?n*(1/0):n*i}};m(Math,xn),y(Math,"log1p",xn.log1p,-1e-17!==Math.log1p(-1e-17)),y(Math,"asinh",xn.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7)),y(Math,"tanh",xn.tanh,-2e-17!==Math.tanh(-2e-17)),y(Math,"acosh",xn.acosh,Math.acosh(Number.MAX_VALUE)===1/0),y(Math,"cbrt",xn.cbrt,Math.abs(1-Math.cbrt(1e-300)/1e-100)/Number.EPSILON>8),y(Math,"sinh",xn.sinh,-2e-17!==Math.sinh(-2e-17));var Tn=Math.expm1(10);y(Math,"expm1",xn.expm1,Tn>22025.465794806718||22025.465794806718>Tn);var On=Math.round,jn=0===Math.round(.5-Number.EPSILON/4)&&1===Math.round(-.5+Number.EPSILON/3.99),Sn=pn+1,kn=2*pn-1,Cn=[Sn,kn].every(function(e){return Math.round(e)===e});y(Math,"round",function(e){var t=F(e),n=-1===t?-0:t+1;return.5>e-t?t:n},!jn||!Cn),w.preserveToString(Math.round,On);var An=Math.imul;-5!==Math.imul(4294967295,5)&&(Math.imul=xn.imul,w.preserveToString(Math.imul,An)),2!==Math.imul.length&&Q(Math,"imul",function(){return ne.Call(An,Math,arguments)});var En=function(){var e=j.setTimeout;if("function"==typeof e||"object"===("undefined"==typeof e?"undefined":_typeof(e))){ne.IsPromise=function(e){return ne.TypeIsObject(e)?"undefined"==typeof e._promise?!1:!0:!1};var t,r=function(e){if(!ne.IsConstructor(e))throw new TypeError("Bad promise constructor");var t=this,n=function(e,n){if(void 0!==t.resolve||void 0!==t.reject)throw new TypeError("Bad Promise implementation!");t.resolve=e,t.reject=n};if(t.resolve=void 0,t.reject=void 0,t.promise=new e(n),!ne.IsCallable(t.resolve)||!ne.IsCallable(t.reject))throw new TypeError("Bad promise constructor")};"undefined"!=typeof window&&ne.IsCallable(window.postMessage)&&(t=function(){var e=[],t="zero-timeout-message",n=function(n){N(e,n),window.postMessage(t,"*")},r=function(n){if(n.source===window&&n.data===t){if(n.stopPropagation(),0===e.length)return;var r=I(e);r()}};return window.addEventListener("message",r,!0),n});var o,i,a=function(){var e=j.Promise,t=e&&e.resolve&&e.resolve();return t&&function(e){return t.then(e)}},s=ne.IsCallable(j.setImmediate)?j.setImmediate:"object"===("undefined"==typeof process?"undefined":_typeof(process))&&process.nextTick?process.nextTick:a()||(ne.IsCallable(t)?t():function(t){e(t,0)}),u=function(e){return e},c=function(e){throw e},l=0,f=1,p=2,d=0,h=1,g=2,y={},v=function(e,t,n){s(function(){b(e,t,n)})},b=function(e,t,n){var r,o;if(t===y)return e(n);try{r=e(n),o=t.resolve}catch(e){r=e,o=t.reject}o(r)},w=function(e,t){var n=e._promise,r=n.reactionLength;if(r>0&&(v(n.fulfillReactionHandler0,n.reactionCapability0,t),n.fulfillReactionHandler0=void 0,n.rejectReactions0=void 0,n.reactionCapability0=void 0,r>1))for(var o=1,i=0;r>o;o++,i+=3)v(n[i+d],n[i+g],t),e[i+d]=void 0,e[i+h]=void 0,e[i+g]=void 0;n.result=t,n.state=f,n.reactionLength=0},x=function(e,t){var n=e._promise,r=n.reactionLength;if(r>0&&(v(n.rejectReactionHandler0,n.reactionCapability0,t),n.fulfillReactionHandler0=void 0,n.rejectReactions0=void 0,n.reactionCapability0=void 0,r>1))for(var o=1,i=0;r>o;o++,i+=3)v(n[i+h],n[i+g],t),e[i+d]=void 0,e[i+h]=void 0,e[i+g]=void 0;n.result=t,n.state=p,n.reactionLength=0},T=function(e){var t=!1,n=function(n){var r;if(!t){if(t=!0,n===e)return x(e,new TypeError("Self resolution"));if(!ne.TypeIsObject(n))return w(e,n);try{r=n.then}catch(t){return x(e,t)}return ne.IsCallable(r)?void s(function(){S(e,n,r)}):w(e,n)}},r=function(n){return t?void 0:(t=!0,x(e,n))};return{resolve:n,reject:r}},O=function(e,t,r,o){e===i?n(e,t,r,o,y):n(e,t,r,o)},S=function(e,t,n){var r=T(e),o=r.resolve,i=r.reject;try{O(n,t,o,i)}catch(e){i(e)}},k=function(){var e=function(t){if(!(this instanceof e))throw new TypeError('Constructor Promise requires "new"');

if(this&&this._promise)throw new TypeError("Bad construction");if(!ne.IsCallable(t))throw new TypeError("not a valid resolver");var n=je(this,e,o,{_promise:{result:void 0,state:l,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}}),r=T(n),i=r.reject;try{t(r.resolve,i)}catch(e){i(e)}return n};return e}();o=k.prototype;var C=function(e,t,n,r){var o=!1;return function(i){if(!o&&(o=!0,t[e]=i,0===--r.count)){var a=n.resolve;a(t)}}},A=function(e,t,n){for(var r,o,i=e.iterator,a=[],s={count:1},u=0;;){try{if(r=ne.IteratorStep(i),r===!1){e.done=!0;break}o=r.value}catch(t){throw e.done=!0,t}a[u]=void 0;var c=t.resolve(o),l=C(u,a,n,s);s.count+=1,O(c.then,c,l,n.reject),u+=1}if(0===--s.count){var f=n.resolve;f(a)}return n.promise},E=function(e,t,n){for(var r,o,i,a=e.iterator;;){try{if(r=ne.IteratorStep(a),r===!1){e.done=!0;break}o=r.value}catch(t){throw e.done=!0,t}i=t.resolve(o),O(i.then,i,n.resolve,n.reject)}return n.promise};return m(k,{all:function(e){var t=this;if(!ne.TypeIsObject(t))throw new TypeError("Promise is not object");var n,o,i=new r(t);try{return n=ne.GetIterator(e),o={iterator:n,done:!1},A(o,t,i)}catch(e){var a=e;if(o&&!o.done)try{ne.IteratorClose(n,!0)}catch(e){a=e}var s=i.reject;return s(a),i.promise}},race:function(e){var t=this;if(!ne.TypeIsObject(t))throw new TypeError("Promise is not object");var n,o,i=new r(t);try{return n=ne.GetIterator(e),o={iterator:n,done:!1},E(o,t,i)}catch(e){var a=e;if(o&&!o.done)try{ne.IteratorClose(n,!0)}catch(e){a=e}var s=i.reject;return s(a),i.promise}},reject:function(e){var t=this;if(!ne.TypeIsObject(t))throw new TypeError("Bad promise constructor");var n=new r(t),o=n.reject;return o(e),n.promise},resolve:function(e){var t=this;if(!ne.TypeIsObject(t))throw new TypeError("Bad promise constructor");if(ne.IsPromise(e)){var n=e.constructor;if(n===t)return e}var o=new r(t),i=o.resolve;return i(e),o.promise}}),m(o,{catch:function(e){return this.then(null,e)},then:function(e,t){var n=this;if(!ne.IsPromise(n))throw new TypeError("not a promise");var o,i=ne.SpeciesConstructor(n,k),a=arguments.length>2&&arguments[2]===y;o=a&&i===k?y:new r(i);var s,m=ne.IsCallable(e)?e:u,b=ne.IsCallable(t)?t:c,w=n._promise;if(w.state===l){if(0===w.reactionLength)w.fulfillReactionHandler0=m,w.rejectReactionHandler0=b,w.reactionCapability0=o;else{var x=3*(w.reactionLength-1);w[x+d]=m,w[x+h]=b,w[x+g]=o}w.reactionLength+=1}else if(w.state===f)s=w.result,v(m,o,s);else{if(w.state!==p)throw new TypeError("unexpected Promise state");s=w.result,v(b,o,s)}return o.promise}}),y=new r(k),i=o.then,k}}();if(j.Promise&&(delete j.Promise.accept,delete j.Promise.defer,delete j.Promise.prototype.chain),"function"==typeof En){m(j,{Promise:En});var Nn=T(j.Promise,function(e){return e.resolve(42).then(function(){})instanceof e}),Pn=!a(function(){j.Promise.reject(42).then(null,5).then(null,$)}),In=a(function(){j.Promise.call(3,$)}),_n=function(e){var t=e.resolve(5);t.constructor={};var n=e.resolve(t);try{n.then(null,$).then(null,$)}catch(e){return!0}return t===n}(j.Promise),Mn=l&&function(){var e=0,t=Object.defineProperty({},"then",{get:function(){e+=1}});return Promise.resolve(t),1===e}(),Fn=function e(t){var n=new Promise(t);t(3,function(){}),this.then=n.then,this.constructor=e};Fn.prototype=Promise.prototype,Fn.all=Promise.all;var Dn=s(function(){return!!Fn.all([1,2])});if(Nn&&Pn&&In&&!_n&&Mn&&!Dn||(Promise=En,Q(j,"Promise",En)),1!==Promise.all.length){var Ln=Promise.all;Q(Promise,"all",function(){return ne.Call(Ln,this,arguments)})}if(1!==Promise.race.length){var qn=Promise.race;Q(Promise,"race",function(){return ne.Call(qn,this,arguments)})}if(1!==Promise.resolve.length){var Rn=Promise.resolve;Q(Promise,"resolve",function(){return ne.Call(Rn,this,arguments)})}if(1!==Promise.reject.length){var Hn=Promise.reject;Q(Promise,"reject",function(){return ne.Call(Hn,this,arguments)})}xt(Promise,"all"),xt(Promise,"race"),xt(Promise,"resolve"),xt(Promise,"reject"),we(Promise)}var $n=function(e){var t=o(d(e,function(e,t){return e[t]=!0,e},{}));return e.join(":")===t.join(":")},zn=$n(["z","a","bb"]),Wn=$n(["z",1,"a","3",2]);if(l){var Bn=function(e){return zn?"undefined"==typeof e||null===e?"^"+ne.ToString(e):"string"==typeof e?"$"+e:"number"==typeof e?Wn?e:"n"+e:"boolean"==typeof e?"b"+e:null:null},Vn=function(){return Object.create?Object.create(null):{}},Un=function(e,t,o){if(r(o)||Y.string(o))p(o,function(e){if(!ne.TypeIsObject(e))throw new TypeError("Iterator value "+e+" is not an entry object");t.set(e[0],e[1])});else if(o instanceof e)n(e.prototype.forEach,o,function(e,n){t.set(n,e)});else{var i,a;if(null!==o&&"undefined"!=typeof o){if(a=t.set,!ne.IsCallable(a))throw new TypeError("bad map");i=ne.GetIterator(o)}if("undefined"!=typeof i)for(;;){var s=ne.IteratorStep(i);if(s===!1)break;var u=s.value;try{if(!ne.TypeIsObject(u))throw new TypeError("Iterator value "+u+" is not an entry object");n(a,t,u[0],u[1])}catch(e){throw ne.IteratorClose(i,!0),e}}}},Gn=function(e,t,o){if(r(o)||Y.string(o))p(o,function(e){t.add(e)});else if(o instanceof e)n(e.prototype.forEach,o,function(e){t.add(e)});else{var i,a;if(null!==o&&"undefined"!=typeof o){if(a=t.add,!ne.IsCallable(a))throw new TypeError("bad set");i=ne.GetIterator(o)}if("undefined"!=typeof i)for(;;){var s=ne.IteratorStep(i);if(s===!1)break;var u=s.value;try{n(a,t,u)}catch(e){throw ne.IteratorClose(i,!0),e}}}},Xn={Map:function(){var e={},t=function(e,t){this.key=e,this.value=t,this.next=null,this.prev=null};t.prototype.isRemoved=function(){return this.key===e};var r=function(e){return!!e._es6map},o=function(e,t){if(!ne.TypeIsObject(e)||!r(e))throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+ne.ToString(e))},i=function(e,t){o(e,"[[MapIterator]]"),this.head=e._head,this.i=this.head,this.kind=t};i.prototype={next:function(){var e=this.i,t=this.kind,n=this.head;if("undefined"==typeof this.i)return ze();for(;e.isRemoved()&&e!==n;)e=e.prev;for(var r;e.next!==n;)if(e=e.next,!e.isRemoved())return r="key"===t?e.key:"value"===t?e.value:[e.key,e.value],this.i=e,ze(r);return this.i=void 0,ze()}},xe(i.prototype);var a,s=function e(){if(!(this instanceof e))throw new TypeError('Constructor Map requires "new"');if(this&&this._es6map)throw new TypeError("Bad construction");var n=je(this,e,a,{_es6map:!0,_head:null,_storage:Vn(),_size:0}),r=new t(null,null);return r.next=r.prev=r,n._head=r,arguments.length>0&&Un(e,n,arguments[0]),n};return a=s.prototype,w.getter(a,"size",function(){if("undefined"==typeof this._size)throw new TypeError("size method called on incompatible Map");return this._size}),m(a,{get:function(e){o(this,"get");var t=Bn(e);if(null!==t){var n=this._storage[t];return n?n.value:void 0}for(var r=this._head,i=r;(i=i.next)!==r;)if(ne.SameValueZero(i.key,e))return i.value},has:function(e){o(this,"has");var t=Bn(e);if(null!==t)return"undefined"!=typeof this._storage[t];for(var n=this._head,r=n;(r=r.next)!==n;)if(ne.SameValueZero(r.key,e))return!0;return!1},set:function(e,n){o(this,"set");var r,i=this._head,a=i,s=Bn(e);if(null!==s){if("undefined"!=typeof this._storage[s])return this._storage[s].value=n,this;r=this._storage[s]=new t(e,n),a=i.prev}for(;(a=a.next)!==i;)if(ne.SameValueZero(a.key,e))return a.value=n,this;return r=r||new t(e,n),ne.SameValue(-0,e)&&(r.key=0),r.next=this._head,r.prev=this._head.prev,r.prev.next=r,r.next.prev=r,this._size+=1,this},delete:function(t){o(this,"delete");var n=this._head,r=n,i=Bn(t);if(null!==i){if("undefined"==typeof this._storage[i])return!1;r=this._storage[i].prev,delete this._storage[i]}for(;(r=r.next)!==n;)if(ne.SameValueZero(r.key,t))return r.key=r.value=e,r.prev.next=r.next,r.next.prev=r.prev,this._size-=1,!0;return!1},clear:function(){o(this,"clear"),this._size=0,this._storage=Vn();for(var t=this._head,n=t,r=n.next;(n=r)!==t;)n.key=n.value=e,r=n.next,n.next=n.prev=t;t.next=t.prev=t},keys:function(){return o(this,"keys"),new i(this,"key")},values:function(){return o(this,"values"),new i(this,"value")},entries:function(){return o(this,"entries"),new i(this,"key+value")},forEach:function(e){o(this,"forEach");for(var t=arguments.length>1?arguments[1]:null,r=this.entries(),i=r.next();!i.done;i=r.next())t?n(e,t,i.value[1],i.value[0],this):e(i.value[1],i.value[0],this)}}),xe(a,a.entries),s}(),Set:function(){var e,t=function(e){return e._es6set&&"undefined"!=typeof e._storage},r=function(e,n){if(!ne.TypeIsObject(e)||!t(e))throw new TypeError("Set.prototype."+n+" called on incompatible receiver "+ne.ToString(e))},i=function t(){if(!(this instanceof t))throw new TypeError('Constructor Set requires "new"');if(this&&this._es6set)throw new TypeError("Bad construction");var n=je(this,t,e,{_es6set:!0,"[[SetData]]":null,_storage:Vn()});if(!n._es6set)throw new TypeError("bad set");return arguments.length>0&&Gn(t,n,arguments[0]),n};e=i.prototype;var a=function(e){var t=e;if("^null"===t)return null;if("^undefined"===t)return void 0;var n=t.charAt(0);return"$"===n?E(t,1):"n"===n?+E(t,1):"b"===n?"btrue"===t:+t},s=function(e){if(!e["[[SetData]]"]){var t=e["[[SetData]]"]=new Xn.Map;p(o(e._storage),function(e){var n=a(e);t.set(n,n)}),e["[[SetData]]"]=t}e._storage=null};return w.getter(i.prototype,"size",function(){return r(this,"size"),this._storage?o(this._storage).length:(s(this),this["[[SetData]]"].size)}),m(i.prototype,{has:function(e){r(this,"has");var t;return this._storage&&null!==(t=Bn(e))?!!this._storage[t]:(s(this),this["[[SetData]]"].has(e))},add:function(e){r(this,"add");var t;return this._storage&&null!==(t=Bn(e))?(this._storage[t]=!0,this):(s(this),this["[[SetData]]"].set(e,e),this)},delete:function(e){r(this,"delete");var t;if(this._storage&&null!==(t=Bn(e))){var n=H(this._storage,t);return delete this._storage[t]&&n}return s(this),this["[[SetData]]"].delete(e)},clear:function(){r(this,"clear"),this._storage&&(this._storage=Vn()),this["[[SetData]]"]&&this["[[SetData]]"].clear()},values:function(){return r(this,"values"),s(this),this["[[SetData]]"].values()},entries:function(){return r(this,"entries"),s(this),this["[[SetData]]"].entries()},forEach:function(e){r(this,"forEach");var t=arguments.length>1?arguments[1]:null,o=this;s(o),this["[[SetData]]"].forEach(function(r,i){t?n(e,t,i,i,o):e(i,i,o)})}}),y(i.prototype,"keys",i.prototype.values,!0),xe(i.prototype,i.prototype.values),i}()};if(j.Map||j.Set){var Jn=s(function(){return 2===new Map([[1,2]]).get(1)});if(!Jn){var Yn=j.Map;j.Map=function e(){if(!(this instanceof e))throw new TypeError('Constructor Map requires "new"');var t=new Yn;return arguments.length>0&&Un(e,t,arguments[0]),delete t.constructor,Object.setPrototypeOf(t,j.Map.prototype),t},j.Map.prototype=x(Yn.prototype),y(j.Map.prototype,"constructor",j.Map,!0),w.preserveToString(j.Map,Yn)}var Qn=new Map,Zn=function(){var e=new Map([[1,0],[2,0],[3,0],[4,0]]);return e.set(-0,e),e.get(0)===e&&e.get(-0)===e&&e.has(0)&&e.has(-0)}(),Kn=Qn.set(1,2)===Qn;if(!Zn||!Kn){var er=Map.prototype.set;Q(Map.prototype,"set",function(e,t){return n(er,this,0===e?0:e,t),this})}if(!Zn){var tr=Map.prototype.get,nr=Map.prototype.has;m(Map.prototype,{get:function(e){return n(tr,this,0===e?0:e)},has:function(e){return n(nr,this,0===e?0:e)}},!0),w.preserveToString(Map.prototype.get,tr),w.preserveToString(Map.prototype.has,nr)}var rr=new Set,or=function(e){return e.delete(0),e.add(-0),!e.has(0)}(rr),ir=rr.add(1)===rr;if(!or||!ir){var ar=Set.prototype.add;Set.prototype.add=function(e){return n(ar,this,0===e?0:e),this},w.preserveToString(Set.prototype.add,ar)}if(!or){var sr=Set.prototype.has;Set.prototype.has=function(e){return n(sr,this,0===e?0:e)},w.preserveToString(Set.prototype.has,sr);var ur=Set.prototype.delete;Set.prototype.delete=function(e){return n(ur,this,0===e?0:e)},w.preserveToString(Set.prototype.delete,ur)}var cr=T(j.Map,function(e){var t=new e([]);return t.set(42,42),t instanceof e}),lr=Object.setPrototypeOf&&!cr,fr=function(){try{return!(j.Map()instanceof j.Map)}catch(e){return e instanceof TypeError}}();if(0!==j.Map.length||lr||!fr){var pr=j.Map;j.Map=function e(){if(!(this instanceof e))throw new TypeError('Constructor Map requires "new"');var t=new pr;return arguments.length>0&&Un(e,t,arguments[0]),delete t.constructor,Object.setPrototypeOf(t,e.prototype),t},j.Map.prototype=pr.prototype,y(j.Map.prototype,"constructor",j.Map,!0),w.preserveToString(j.Map,pr)}var dr=T(j.Set,function(e){var t=new e([]);return t.add(42,42),t instanceof e}),hr=Object.setPrototypeOf&&!dr,gr=function(){try{return!(j.Set()instanceof j.Set)}catch(e){return e instanceof TypeError}}();if(0!==j.Set.length||hr||!gr){var yr=j.Set;j.Set=function e(){if(!(this instanceof e))throw new TypeError('Constructor Set requires "new"');var t=new yr;return arguments.length>0&&Gn(e,t,arguments[0]),delete t.constructor,Object.setPrototypeOf(t,e.prototype),t},j.Set.prototype=yr.prototype,y(j.Set.prototype,"constructor",j.Set,!0),w.preserveToString(j.Set,yr)}var mr=new j.Map,vr=!s(function(){return mr.keys().next().done});if(("function"!=typeof j.Map.prototype.clear||0!==(new j.Set).size||0!==mr.size||"function"!=typeof j.Map.prototype.keys||"function"!=typeof j.Set.prototype.keys||"function"!=typeof j.Map.prototype.forEach||"function"!=typeof j.Set.prototype.forEach||u(j.Map)||u(j.Set)||"function"!=typeof mr.keys().next||vr||!cr)&&m(j,{Map:Xn.Map,Set:Xn.Set},!0),j.Set.prototype.keys!==j.Set.prototype.values&&y(j.Set.prototype,"keys",j.Set.prototype.values,!0),xe(Object.getPrototypeOf((new j.Map).keys())),xe(Object.getPrototypeOf((new j.Set).keys())),f&&"has"!==j.Set.prototype.has.name){var br=j.Set.prototype.has;Q(j.Set.prototype,"has",function(e){return n(br,this,e)})}}m(j,Xn),we(j.Map),we(j.Set)}var wr=function(e){if(!ne.TypeIsObject(e))throw new TypeError("target must be an object")},xr={apply:function(){return ne.Call(ne.Call,null,arguments)},construct:function(e,t){if(!ne.IsConstructor(e))throw new TypeError("First argument must be a constructor.");var n=arguments.length>2?arguments[2]:e;if(!ne.IsConstructor(n))throw new TypeError("new.target must be a constructor.");return ne.Construct(e,t,n,"internal")},deleteProperty:function(e,t){if(wr(e),l){var n=Object.getOwnPropertyDescriptor(e,t);if(n&&!n.configurable)return!1}return delete e[t]},has:function(e,t){return wr(e),t in e}};Object.getOwnPropertyNames&&Object.assign(xr,{ownKeys:function(e){wr(e);var t=Object.getOwnPropertyNames(e);return ne.IsCallable(Object.getOwnPropertySymbols)&&P(t,Object.getOwnPropertySymbols(e)),t}});var Tr=function(e){return!a(e)};if(Object.preventExtensions&&Object.assign(xr,{isExtensible:function(e){return wr(e),Object.isExtensible(e)},preventExtensions:function(e){return wr(e),Tr(function(){Object.preventExtensions(e)})}}),l){var Or=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e,t);if(!r){var o=Object.getPrototypeOf(e);return null===o?void 0:Or(o,t,n)}return"value"in r?r.value:r.get?ne.Call(r.get,n):void 0},jr=function(e,t,r,o){var i=Object.getOwnPropertyDescriptor(e,t);if(!i){var a=Object.getPrototypeOf(e);if(null!==a)return jr(a,t,r,o);i={value:void 0,writable:!0,enumerable:!0,configurable:!0}}if("value"in i){if(!i.writable)return!1;if(!ne.TypeIsObject(o))return!1;var s=Object.getOwnPropertyDescriptor(o,t);return s?ee.defineProperty(o,t,{value:r}):ee.defineProperty(o,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}return i.set?(n(i.set,o,r),!0):!1};Object.assign(xr,{defineProperty:function(e,t,n){return wr(e),Tr(function(){Object.defineProperty(e,t,n)})},getOwnPropertyDescriptor:function(e,t){return wr(e),Object.getOwnPropertyDescriptor(e,t)},get:function(e,t){wr(e);var n=arguments.length>2?arguments[2]:e;return Or(e,t,n)},set:function(e,t,n){wr(e);var r=arguments.length>3?arguments[3]:e;return jr(e,t,n,r)}})}if(Object.getPrototypeOf){var Sr=Object.getPrototypeOf;xr.getPrototypeOf=function(e){return wr(e),Sr(e)}}if(Object.setPrototypeOf&&xr.getPrototypeOf){var kr=function(e,t){for(var n=t;n;){if(e===n)return!0;n=xr.getPrototypeOf(n)}return!1};Object.assign(xr,{setPrototypeOf:function(e,t){if(wr(e),null!==t&&!ne.TypeIsObject(t))throw new TypeError("proto must be an object or null");return t===ee.getPrototypeOf(e)?!0:ee.isExtensible&&!ee.isExtensible(e)?!1:kr(e,t)?!1:(Object.setPrototypeOf(e,t),!0)}})}var Cr=function(e,t){if(ne.IsCallable(j.Reflect[e])){var n=s(function(){return j.Reflect[e](1),j.Reflect[e](0/0),j.Reflect[e](!0),!0});n&&Q(j.Reflect,e,t)}else y(j.Reflect,e,t)};Object.keys(xr).forEach(function(e){Cr(e,xr[e])});var Ar=j.Reflect.getPrototypeOf;if(f&&Ar&&"getPrototypeOf"!==Ar.name&&Q(j.Reflect,"getPrototypeOf",function(e){return n(Ar,j.Reflect,e)}),j.Reflect.setPrototypeOf&&s(function(){return j.Reflect.setPrototypeOf(1,{}),!0})&&Q(j.Reflect,"setPrototypeOf",xr.setPrototypeOf),j.Reflect.defineProperty&&(s(function(){var e=!j.Reflect.defineProperty(1,"test",{value:1}),t="function"!=typeof Object.preventExtensions||!j.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})||Q(j.Reflect,"defineProperty",xr.defineProperty)),j.Reflect.construct&&(s(function(){var e=function(){};return j.Reflect.construct(function(){},[],e)instanceof e})||Q(j.Reflect,"construct",xr.construct)),"Invalid Date"!==String(new Date(0/0))){var Er=Date.prototype.toString,Nr=function(){var e=+this;return e!==e?"Invalid Date":ne.Call(Er,this)};Q(Date.prototype,"toString",Nr)}var Pr={anchor:function(e){return ne.CreateHTML(this,"a","name",e)},big:function(){return ne.CreateHTML(this,"big","","")},blink:function(){return ne.CreateHTML(this,"blink","","")},bold:function(){return ne.CreateHTML(this,"b","","")},fixed:function(){return ne.CreateHTML(this,"tt","","")},fontcolor:function(e){return ne.CreateHTML(this,"font","color",e)},fontsize:function(e){return ne.CreateHTML(this,"font","size",e)},italics:function(){return ne.CreateHTML(this,"i","","")},link:function(e){return ne.CreateHTML(this,"a","href",e)},small:function(){return ne.CreateHTML(this,"small","","")},strike:function(){return ne.CreateHTML(this,"strike","","")},sub:function(){return ne.CreateHTML(this,"sub","","")},sup:function(){return ne.CreateHTML(this,"sup","","")}};p(Object.keys(Pr),function(e){var t=String.prototype[e],r=!1;if(ne.IsCallable(t)){var o=n(t,"",' " '),i=A([],o.match(/"/g)).length;r=o!==o.toLowerCase()||i>2}else r=!0;r&&Q(String.prototype,e,Pr[e])});var Ir=function(){if(!Z)return!1;var e="object"===("undefined"==typeof JSON?"undefined":_typeof(JSON))&&"function"==typeof JSON.stringify?JSON.stringify:null;if(!e)return!1;if("undefined"!=typeof e(z()))return!0;if("[null]"!==e([z()]))return!0;var t={a:z()};return t[z()]=!0,"{}"!==e(t)?!0:!1}(),_r=s(function(){return Z?"{}"===JSON.stringify(Object(z()))&&"[{}]"===JSON.stringify([Object(z())]):!0});if(Ir||!_r){var Mr=JSON.stringify;Q(JSON,"stringify",function(e){if("symbol"!==("undefined"==typeof e?"undefined":_typeof(e))){var t;arguments.length>1&&(t=arguments[1]);var o=[e];if(r(t))o.push(t);else{var i=ne.IsCallable(t)?t:null,a=function(e,t){var r=i?n(i,this,e,t):t;return"symbol"!==("undefined"==typeof r?"undefined":_typeof(r))?Y.symbol(r)?Ot({})(r):r:void 0};o.push(a)}return arguments.length>2&&o.push(arguments[2]),Mr.apply(this,o)}})}return j}),define("jqueryplugins",["jquery"],function(e){e.prototype.extend({popAttr:function(e){var t=this.attr(e);return this.removeAttr(e),t},popData:function(e){var t=this.data(e);return this.removeData(e),t},tag:function(){return this[0]&&this[0].tagName&&this[0].tagName.toLowerCase()},textNodes:function(){return 1===this.length&&this[0]instanceof Text?[this[0]]:Array.from(this.add(this.contents().add(this.find("*").contents())).filter(function(){return this instanceof Text})).sort(function(e,t){return 2&e.compareDocumentPosition(t)?1:-1})},prevTextNode:function(){var e=this.first()[0],t=this.parent();if(!t.length)return null;var n=t.textNodes().filter(function(t){var n=t.compareDocumentPosition(e);return 4&n&&!(8&n)});return n=n[n.length-1],n?n:t.prevTextNode()},nextTextNode:function(){var e=this.last()[0],t=this.parent();if(!t.length)return null;var n=t.textNodes().filter(function(t){var n=t.compareDocumentPosition(e);return 2&n&&!(8&n)})[0];return n?n:t.nextTextNode()}})}),function(){function e(){for(var e=0;e<arguments.length;e++)for(var t in arguments[e])this[t]=arguments[e][t]}function t(e,t){e.childAt=e.childAt||{};for(var n=t.start;n<t.end;n+=1)e.childAt[n]=t}function n(e,t,n,r){return!(e.canFollow&&!(e.canFollow.indexOf(n&&n.type)>-1)||e.cannotFollow&&(-1!==e.cannotFollow.indexOf(n&&n.type)||e.cannotFollow.indexOf("text")>-1&&r)||e.peek&&e.peek!==t.slice(0,e.peek.length))}function r(e){for(var t=e.innerText,r=[],i=0,s=i,u=t.length,c=null;u>i;){for(var l=t.slice(i),f=(r.length?r[0]:e).innerMode,p=0,d=f.length;d>p;p+=1){var h=a[f[p]];if(n(h,l,c,i>s)&&h.pattern.test(l)){var g=h.pattern.exec(l),y=h.fn(g),m=!1,v=0;if(y.matches){for(;v<r.length;v+=1){var b=r[v].type;if(b in y.matches){m=!0;break}0===b.indexOf("verbatim")&&(b="verbatimOpener"),y.cannotCross&&y.cannotCross.indexOf(b)>-1&&(v=r.length-1)}if(v>=r.length&&!y.isFront)continue}i>s&&e.addChild({type:"text",text:t.slice(s,i),innerMode:f}),c=e.addChild(y),i+=c.text.length,s=i,m&&(o(e,c,r[v]),r=r.slice(v+1)),c.isFrontToken()&&r.unshift(c);break}}p===d&&(i+=1,null===c&&(c={type:"text"}))}for(i>s&&e.addChild({type:"text",text:t.slice(s,i),innerMode:(r.length?r[0]:e).innerMode});r.length>0;)r.shift().demote();return e}function o(e,n,r){var o=e.children.indexOf(n),i=e.children.indexOf(r);n.children=e.children.splice(i+1,o-(i+1)),n.children.forEach(function(e){t(n,e)}),n.type=n.matches[r.type],n.innerText="";for(var a=0,s=n.children.length;s>a;a++)n.innerText+=n.children[a].text;n.start=r.start,n.text=r.text+n.innerText+n.text,Object.keys(r).forEach(function(e){Object.hasOwnProperty.call(n,e)||(n[e]=r[e])}),n.isFront&&(n.isFront=!1),e.children.splice(i,1),t(e,n)}var i=void 0,a={};e.prototype={constructor:e,addChild:function(n){var o=this.lastChildEnd(),i=new e({start:o,end:n.text&&o+n.text.length,children:[]},n);return i.innerText&&r(i),this.children.push(i),t(this,i),i},lastChild:function(){return this.children?this.children[this.children.length-1]||null:null},lastChildEnd:function(){var e=this.lastChild();return e?e.end:this.start+Math.max(0,this.text.indexOf(this.innerText))},tokenAt:function(e){if(e<this.start||e>=this.end)return null;if(this.childAt)return this.childAt[e]&&this.childAt[e].tokenAt(e)||this;if(this.children.length)for(var t=0;t<this.children.length;t+=1){var n=this.children[t].tokenAt(e);if(n)return n}return this},pathAt:function(e){if(e<this.start||e>=this.end)return[];if(this.childAt)return(this.childAt[e]&&this.childAt[e].pathAt(e)||[]).concat(this);var t=[];if(this.children.length)for(var n=0;n<this.children.length;n+=1){var r=this.children[n].pathAt(e);if(r.length){t.concat(r);break}}return t.concat(this)},nearestTokenAt:function(e){return e<this.start||e>=this.end?null:this.children?this.children.reduce(function(t,n){return t||(e>=n.start&&e<n.end?n:null)},null):this},everyLeaf:function e(t){if(!this.children||0===this.children.length)return!!t(this);var n=void 0;return this.children.everyLeaf(function(){n=n&&!!e(t)})},isWhitespace:function(){return this.everyLeaf(function(e){return"whitespace"===e.type||!e.text.trim()})},isFrontToken:function(){return this.isFront},isBackToken:function(){return"matches"in this},demote:function(){this.type="text"},error:function(e){this.type="error",this.message=e},toString:function(){var e=this.type+"("+this.start+"\u2192"+this.end+")";return this.children&&this.children.length>0&&(e+="["+this.children+"]"),e}},i={lex:function(t,n){return r(new e({type:"root",start:n||0,end:t.length,text:t,innerText:t,children:[],childAt:{},innerMode:i.startMode}))},rules:a},"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=i:"function"==typeof define&&define.amd?define("lexer",[],function(){return i}):this&&this.loaded?(this.modules||(this.modules={}),this.modules.Lexer=i):this.TwineLexer=i}.call(eval("this")||("undefined"!=typeof global?global:window)),function(){function e(t){return t&&"object"===("undefined"==typeof t?"undefined":_typeof(t))?(Object.keys(t).forEach(function(n){t[n]=e(t[n])}),t):(t+"").replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function t(){return"[^"+Array.apply(0,arguments).map(e).join("")+"]*"}function n(e){return function(){return"("+e+Array.apply(0,arguments).join("|")+")"}}var r=void 0,o=n("?:"),i=n("?!"),a=n("?="),s="[ \\f\\t\\v\xa0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000]*",u=s.replace("*","+"),c="\\b",l="\\\\\\n\\\\?|\\n\\\\",f="\\n(?!\\\\)",p="[\\w\\-\xc0-\xde\xdf-\xff\u0150\u0170\u0151\u0171]",d="[\\w\xc0-\xde\xdf-\xff\u0150\u0170\u0151\u0171]",h=o("\\n","$"),g="("+o(l,"[^\\n]")+"+)",y="\\*",m=s+"("+y+"+)"+u+g+h,v="(?:0\\.)",b=s+"("+v+"+)"+u+g+h,w=s+"-{3,}"+s+h,x=s+"(#{1,6})"+s+g+h,T=s+"(==+>|<=+|=+><=+|<==+>)"+s+h,O={opener:"\\[\\[(?!\\[)",text:"("+t("]")+")",rightSeparator:o("\\->","\\|"),leftSeparator:"<\\-",closer:"\\]\\]",legacySeparator:"\\|",legacyText:"("+o("[^\\|\\]]","\\]"+i("\\]"))+"+)"},j=p.replace("\\-","")+"*"+p.replace("\\-","").replace("\\w","a-zA-Z")+p.replace("\\-","")+"*",S="\\$("+j+")",k="'s"+u+"("+j+")",C="("+j+")"+u+"of"+c+i("it"+c),A="'s"+u,E="of"+c,N=o("it","time")+c,P="its"+u+"("+j+")",I="its"+u,_="("+j+")"+u+"of"+u+"it"+c,M="of"+c+u+"it"+c,F={opener:"\\(",name:"("+o(p.replace("]","\\/]")+p+"*",S)+"):",closer:"\\)"},D="<<[^>\\s]+\\s*(?:\\\\.|'(?:[^'\\\\]*\\\\.)*[^'\\\\]*'|\"(?:[^\"\\\\]*\\\\.)*[^\"\\\\]*\"|[^'\"\\\\>]|>(?!>))*>>",L={name:"[a-zA-Z][\\w\\-]*",attrs:"(?:\"[^\"]*\"|'[^']*'|[^'\">])*?"},q="\\|("+p.replace("]","_]")+"*)>",R="<("+p.replace("]","_]")+"*)\\|",H="\\b(\\d+(?:\\.\\d+)?(?:[eE][+\\-]?\\d+)?|NaN)"+i("m?s")+"\\b";O.main=O.opener+o(O.text+O.rightSeparator,O.text.replace("*","*?")+O.leftSeparator)+O.text,r={upperLetter:"[A-Z\xc0-\xde\u0150\u0170]",lowerLetter:"[a-z0-9_\\-\xdf-\xff\u0151\u0171]",anyLetter:p,anyLetterStrict:d,whitespace:u,escapedLine:l,br:f,commentFront:"<!--",commentBack:"-->",tag:"<\\/?"+L.name+L.attrs+">",tagPeek:"<",scriptStyleTag:"<("+o("script","style")+")"+L.attrs+">[^]*?<\\/\\1>",scriptStyleTagOpener:"<",url:"("+o("https?","mailto","javascript","ftp","data")+":\\/\\/[^\\s<]+[^<.,:;\"')\\]\\s])",bullet:y,hr:w,heading:x,align:T,bulleted:m,numbered:b,delOpener:e("~~"),italicOpener:e("//"),boldOpener:e("''"),supOpener:e("^^"),strongFront:e("**"),strongBack:e("**"),emFront:e("*"),emBack:e("*"),verbatimOpener:"`+",collapsedFront:"{",collapsedBack:"}",hookAppendedFront:"\\[",hookPrependedFront:q+"\\[",hookAnonymousFront:"\\[",hookBack:"\\]"+i(R),hookAppendedBack:"\\]"+R,passageLink:O.main+O.closer,passageLinkPeek:"[[",legacyLink:O.opener+O.legacyText+O.legacySeparator+O.legacyText+O.closer,legacyLinkPeek:"[[",simpleLink:O.opener+O.legacyText+O.closer,simpleLinkPeek:"[[",macroFront:F.opener+a(F.name),macroFrontPeek:"(",macroName:F.name,groupingFront:"\\("+i(F.name),groupingFrontPeek:"(",groupingBack:"\\)",twine1Macro:D,twine1MacroPeek:"<<",property:k,propertyPeek:"'s",belongingProperty:C,possessiveOperator:A,belongingOperator:E,belongingOperatorPeek:"of",itsOperator:I,itsOperatorPeek:"its",belongingItOperator:M,belongingItOperatorPeek:"of",variable:S,variablePeek:"$",hookRef:"\\?("+p+"+)\\b",hookRefPeek:"?",cssTime:"(\\d+\\.?\\d*|\\d*\\.?\\d+)(m?s)"+c,colour:o(o("Red","Orange","Yellow","Lime","Green","Cyan","Aqua","Blue","Navy","Purple","Fuchsia","Magenta","White","Gray","Grey","Black"),"#[\\dA-Fa-f]{3}(?:[\\dA-Fa-f]{3})?"),number:H,boolean:o("true","false")+c,identifier:N,itsProperty:P,itsPropertyPeek:"its",belongingItProperty:_,escapedStringChar:"\\\\[^\\n]",singleStringOpener:"'",doubleStringOpener:'"',is:"is"+i(" not"," in")+c,isNot:"is not"+c,and:"and"+c,or:"or"+c,not:"not"+c,inequality:o("<(?!=)","<=",">(?!=)",">="),isIn:"is in"+c,contains:"contains"+c,addition:e("+")+i("="),subtraction:e("-")+i("="),multiplication:e("*")+i("="),division:o("/","%")+i("="),comma:",",spread:"\\.\\.\\."+i("\\."),to:o("to"+c,"="),into:"into"+c,augmentedAssign:o("\\+","\\-","\\*","\\/","%")+"="},"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=r:"function"==typeof define&&define.amd?define("patterns",[],function(){return r}):this&&this.loaded?(this.modules||(this.modules={}),this.modules.Patterns=r):this.Patterns=r}.call(eval("this")||("undefined"!=typeof global?global:window)),function(){function e(e){function t(e){return e=e||"innerText",function(t){var n=t.reduceRight(function(e,t,n){return e||(n?t:"")},""),r={};return r[e]=n,r}}function r(e,t){var n={};return n[e]=t,function(){return{isFront:!0,matches:n,cannotCross:["verbatimOpener"]}}}function o(e,t){return Object.keys(t).forEach(function(n){var r=t[n].fn;t[n].fn=function(t){var o=r(t);return o.text||(o.text=t[0]),o.type||(o.type=n),o.innerMode||(o.innerMode=e),o}}),t}var i=Object.bind(0,null),a=[],s=[],u=o(a,{hr:{fn:i},bulleted:{fn:function(e){return{depth:e[1].length,innerText:e[2]}}},numbered:{fn:function(e){return{depth:e[1].length/2,innerText:e[2]}}},heading:{fn:function(e){return{depth:e[1].length,innerText:e[2]}}},align:{fn:function(e){var t=void 0,n=e[1],r=n.indexOf("><");return~r?(t=Math.round(r/(n.length-2)*50),25===t&&(t="center")):"<"===n[0]&&">"===n.slice(-1)?t="justify":n.indexOf(">")>-1?t="right":n.indexOf("<")>-1&&(t="left"),{align:t}}}});Object.keys(u).forEach(function(e){u[e].canFollow=[null,"br","hr","bulleted","numbered","heading","align"],u[e].cannotFollow=["text"]});var c=o(a,{twine1Macro:{fn:function(){return{type:"error",message:"Harlowe macros use a different syntax to Twine 1 and SugarCube macros."}}},br:{fn:i},emBack:{fn:function(){return{matches:{emFront:"em"},cannotCross:["verbatimOpener"]}}},strongBack:{fn:function(){return{matches:{strongFront:"strong"},cannotCross:["verbatimOpener"]}}},strongFront:{fn:function(){return{isFront:!0}}},emFront:{fn:function(){return{isFront:!0}}},boldOpener:{fn:r("boldOpener","bold")},italicOpener:{fn:r("italicOpener","italic")},delOpener:{fn:r("delOpener","del")},supOpener:{fn:r("supOpener","sup")},commentFront:{fn:function(){return{isFront:!0}}},commentBack:{fn:function(){return{matches:{commentFront:"comment"}}}},scriptStyleTag:{fn:i},tag:{fn:i},url:{fn:i},passageLink:{fn:function(e){var t=e[1],n=e[2],r=e[3];return{type:"twineLink",innerText:n?r:t,passage:t?r:n}}},simpleLink:{fn:function(e){return{type:"twineLink",innerText:e[1],passage:e[1]}}},hookPrependedFront:{fn:function(e){return{name:e[1],isFront:!0,tagPosition:"prepended"}}},hookAnonymousFront:{fn:function(){return{isFront:!0,demote:function(){this.error("This tagged hook doesn't have a matching ].")}}},canFollow:["macro","variable"]},hookAppendedFront:{fn:function(){return{isFront:!0}},cannotFollow:["macro","variable"]},hookBack:{fn:function(){return{type:"hookAppendedBack",matches:{hookPrependedFront:"hook",hookAnonymousFront:"hook"},cannotCross:["verbatimOpener"]}}},hookAppendedBack:{fn:function(e){return{name:e[1],tagPosition:"appended",matches:{hookAppendedFront:"hook"},cannotCross:["verbatimOpener"]}}},verbatimOpener:{fn:function(e){var t=e[0].length,n={};return n["verbatim"+t]="verbatim",{type:"verbatim"+t,isFront:!0,matches:n}}},collapsedFront:{fn:function(){return{isFront:!0}}},collapsedBack:{fn:function(){return{matches:{collapsedFront:"collapsed"},cannotCross:["verbatimOpener"]}}},escapedLine:{fn:i},legacyLink:{fn:function(e){return{type:"twineLink",innerText:e[1],passage:e[2]}}}}),l=o(s,{macroFront:{fn:function(e){return{isFront:!0,name:e[1]}}},groupingBack:{fn:function(){return{matches:{groupingFront:"grouping",macroFront:"macro"},cannotCross:["singleStringOpener","doubleStringOpener"]}}},hookRef:{fn:t("name")},variable:{fn:t("name")},whitespace:{fn:i,cannotFollow:"text"}}),f=o(s,Object.assign({macroName:{canFollow:["macroFront"],fn:function(e){return e[2]?{isMethodCall:!0,innerText:e[2]}:{isMethodCall:!1}}},groupingFront:{fn:function(){return{isFront:!0}}},property:{fn:t("name"),canFollow:["variable","hookRef","property","itsProperty","belongingItProperty","macro","grouping","string","boolean","number"]
},possessiveOperator:{fn:i},itsProperty:{cannotFollow:["text"],fn:t("name")},itsOperator:{cannotFollow:["text"],fn:i},belongingItProperty:{cannotFollow:["text"],fn:t("name")},belongingItOperator:{cannotFollow:["text"],fn:i},belongingProperty:{cannotFollow:["text"],fn:t("name")},belongingOperator:{cannotFollow:["text"],fn:i},escapedStringChar:{fn:function(){return{type:"text"}}},singleStringOpener:{fn:function(){return{isFront:!0,matches:{singleStringOpener:"string"}}}},doubleStringOpener:{fn:function(){return{isFront:!0,matches:{doubleStringOpener:"string"}}}},cssTime:{fn:function(e){return{value:+e[1]*("s"===e[2].toLowerCase()?1e3:1)}}},colour:{cannotFollow:["text"],fn:function(e){var t,n=e[0].toLowerCase(),r={red:"e61919",orange:"e68019",yellow:"e5e619",lime:"80e619",green:"19e619",cyan:"19e5e6",aqua:"19e5e6",blue:"197fe6",navy:"1919e6",purple:"7f19e6",fuchsia:"e619e5",magenta:"e619e5",white:"fff",black:"000",gray:"888",grey:"888"};return t=Object.hasOwnProperty.call(r,n)?"#"+r[n]:n,{colour:t}}},number:{fn:function(e){return{value:parseFloat(e[0])}}},addition:{fn:i},subtraction:{fn:i},multiplication:{fn:i},division:{fn:i},inequality:{fn:function(e){return{operator:e[0]}}},augmentedAssign:{fn:function(e){return{operator:e[0][0]}}},identifier:{fn:t("name"),cannotFollow:["text"]}},["boolean","is","to","into","and","or","not","isNot","contains","isIn"].reduce(function(e,t){return e[t]={fn:i,cannotFollow:["text"]},e},{}),["comma","spread","addition","subtraction","multiplication","division"].reduce(function(e,t){return e[t]={fn:i},e},{})));a.push.apply(a,_toConsumableArray(Object.keys(u)).concat(_toConsumableArray(Object.keys(c)),_toConsumableArray(Object.keys(l)))),s.push.apply(s,_toConsumableArray(Object.keys(l)).concat(_toConsumableArray(Object.keys(f))));var p=Object.assign({},u,c,l,f);return Object.keys(p).forEach(function(e){var t=n[e];p[e].pattern="string"!=typeof t?t:new RegExp("^(?:"+t+")","i"),n[e+"Peek"]&&(p[e].peek=n[e+"Peek"])}),Object.assign(e.rules,p),e.startMode=a,e}function t(t){var r=Object.freeze({lex:e(t).lex,Patterns:n});return r}var n=void 0;Object.assign=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},"object"===("undefined"==typeof module?"undefined":_typeof(module))?(n=require("patterns"),module.exports=t(require("lexer"))):"function"==typeof define&&define.amd?define("markup",["lexer","patterns"],function(e,r){return n=r,t(e)}):this&&this.loaded&&this.modules?(n=this.modules.Patterns,this.modules.Markup=t(this.modules.Lexer)):(n=this.Patterns,this.TwineMarkup=t(this.TwineLexer))}.call(eval("this")||("undefined"!=typeof global?global:window)),define("utils/selectors",[],function(){return Object.freeze({passage:"tw-passage",story:"tw-story",sidebar:"tw-sidebar",internalLink:"tw-link",brokenLink:"tw-broken-link",hook:"tw-hook",pseudoHook:"tw-pseudo-hook",enchantment:"tw-enchantment",expression:"tw-expression",enchanter:"[enchanter]",script:"[role=script]",stylesheet:"[role=stylesheet]",storyData:"tw-storydata",passageData:"tw-passagedata",whitespace:"tw-char[char=space], tw-char[char=tab], br",collapsed:"tw-collapsed"})}),define("utils/customelements",[],function(){if(document.registerElement){var e={};return function t(n){for(var r=Object.create(HTMLElement.prototype),o={},i=arguments.length,a=Array(i>1?i-1:0),s=1;i>s;s++)a[s-1]=arguments[s];a.forEach(function(e){o[e]={value:null}}),Object.defineProperties(r,o);var u=document.registerElement(n,{prototype:r});return e[n]=u,t}("tw-storydata","storyname","startnode","creator","creator-version","options")("tw-passagedata","name","pid","position")("tw-story")("tw-debugger")("tw-passage")("tw-link","passage-name")("tw-broken-link","passage-name")("tw-expression","type","name","js")("tw-sidebar")("tw-icon")("tw-align")("tw-collapsed")("tw-verbatim")("tw-hook","name","source")("tw-pseudo-hook")("tw-transition-container")("tw-error")("tw-error-explanation")("tw-error-explanation-button")("tw-notifier","message"),Object.freeze(e)}}),define("utils",["jquery","markup","utils/selectors","utils/customelements"],function(e,t,n){var r={configurable:0,writable:0},o={"transition-in":Object.create(null),"transition-out":Object.create(null)},i="audio,blockquote,canvas,div,h1,h2,h3,h4,h5,hr,ol,p,pre,table,ul,video,tw-align,tw-story,tw-passage".split(","),a="a,b,i,em,strong,sup,sub,abbr,acronym,s,strike,del,big,small,script,img,button,input,tw-link,tw-broken-link,tw-verbatim,tw-collapsed,tw-error".split(","),s=["audio"],u=void 0,c={lockProperties:function(e){for(var t=Object.keys(e),n={},o=0;o<t.length;o++)n[t[o]]=r;return Object.defineProperties(e,n)},lockProperty:function(e,t,n){var o=Object.create(r);return n&&(o.value=n),Object.defineProperty(e,t,o),e},getInheritedPropertyDescriptor:function(e,t){for(;e&&!e.hasOwnProperty(t);)e=Object.getPrototypeOf(e);return e&&Object.getOwnPropertyDescriptor(e,t)||null},toJSLiteral:JSON.stringify,toTSStringLiteral:function(e){var t=Math.max.apply(Math,_toConsumableArray((e.match(/(`+)/g)||[]).map(function(e){return e.length}).concat(0)))+1;return"`".repeat(t)+e+"`".repeat(t)},cssTimeUnit:function(e){if("string"==typeof e){if(e=e.toLowerCase(),"ms"===e.slice(-2))return+e.slice(0,-2)||0;if("s"===e.slice(-1))return 1e3*+e.slice(0,-1)||0}else if(Array.isArray(e)){var t=function(){var t=[];return e.forEach(function(e){var n=c.cssTimeUnit(e);n>0&&t.push(n)}),{v:t}}();if("object"===("undefined"==typeof t?"undefined":_typeof(t)))return t.v}return 0},nth:function(e){var t=(e+"").slice(-1);return e+("1"===t?"st":"2"===t?"nd":"3"===t?"rd":"th")},plural:function(e,t){return e+" "+t+(e>1?"s":"")},unescape:function(e){return e.replace(/&(?:amp|lt|gt|quot|nbsp|zwnj|#39|#96);/g,function(e){return{"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#39;":"'","&nbsp;":String.fromCharCode(160),"&zwnj;":String.fromCharCode(8204)}[e]})},escape:function(e){return e.replace(/[&><"']/g,function(e){return{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"}[e]})},insensitiveName:function(e){return(e+"").toLowerCase().replace(/-|_/g,"")},wrapHTMLTag:function(e,t){return"<"+t+">"+e+"</"+t+">"},findAndFilter:function(t,n){return t=e(t||c.storyElement),t.filter(n).add(t.find(n))},closestHookSpan:function(e){var t=e.closest(n.hook+","+n.pseudoHook);return t.length?t:e},childrenProbablyInline:function(e){var t=[];return Array.prototype.every.call(e.find("*"),function(e){return e.hidden||/none|inline/.test(e.style.display)?!0:i.indexOf(e.tagName.toLowerCase())>-1||/none|inline/.test(e.style.display)?!1:a.indexOf(e.tagName.toLowerCase())>-1?!0:(t.push(e),!0)})&&t.every(function(e){return/none|inline/.test(e.style.display)})},transitionReplace:function(t,n,r){t=c.closestHookSpan(t);var o=e("<tw-transition-container>").css("position","relative");o.insertBefore(t.first());var i=void 0;n&&(i=e("<tw-transition-container>").appendTo(o),n.appendTo(i));var a=e("<tw-transition-container>").css("position","absolute").prependTo(o);t.detach().appendTo(a),c.transitionOut(a,r),n&&c.transitionIn(i,r,function(){i.unwrap().children().first().unwrap()})},transitionOut:function(e,t){function n(){e.remove()}var r=c.childrenProbablyInline(e),o=e.length>1||!r||-1===["tw-hook","tw-passage"].indexOf(e.tag());o&&(e=e.wrapAll("<tw-transition-container>").parent()),e.attr("data-t8n",t).addClass("transition-out"),c.childrenProbablyInline(e)&&e.css("display","inline-block");var i=c.transitionTime(t,"transition-out");i?window.setTimeout(n,i):n()},transitionIn:function(e,t){function n(){var t=0===c.findAndFilter(e,s.join(",")).length;o&&t?e.contents().unwrap():e.removeClass("transition-in").removeAttr("data-t8n")}var r=c.childrenProbablyInline(e),o=e.length>1||!r||-1===["tw-hook","tw-passage"].indexOf(e.tag());o&&(e=e.wrapAll("<tw-transition-container>").parent()),e.attr("data-t8n",t).addClass("transition-in"),c.childrenProbablyInline(e)&&e.css("display","inline-block");var i=c.transitionTime(t,"transition-in");i?window.setTimeout(n,i):n()},transitionTime:function(t,n){var r=o[n];if(!r[t]){var i=e("<p>").appendTo(document.body).attr("data-t8n",t).addClass(n);r[t]=c.cssTimeUnit(i.css("animation-duration"))+c.cssTimeUnit(i.css("animation-delay")),i.remove()}return r[t]},$:function(t,n){return e(t,n||c.storyElement).not(".transition-out, .transition-out *")},log:function(e){window.console&&console.log(e)},impossible:function(e,t){window.console&&console.error(e+"(): "+t)},assert:function(e){window.console&&(e||console.error("Assertion failed!"))},assertMustHave:function(e,t){if(window.console)for(var n=0;n<t.length;n+=1)t[n]in e||console.error("Assertion failed: "+e+" lacks property "+t[n])},assertOnlyHas:function(e,t){if(window.console)for(var n in e)-1===t.indexOf(n)&&console.error("Assertion failed: "+e+" had unexpected property '"+n+"'!")},get storyElement(){return u}};return e(function(){return u=e(n.story)}),Object.freeze(c)}),define("twinescript/compiler",["utils"],function(e){function t(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];for(var o=0;o<e.length;o+=1)if(n.indexOf(e[o].type)>-1)return o;return 0/0}function n(e){for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;n>o;o++)r[o-1]=arguments[o];return e.length-1-t.apply(void 0,[[].concat(_toConsumableArray(e)).reverse()].concat(r))}function r(e,a){if(!e)return"";e=[].concat(e);var s=e[0];if(1===e.length){if("identifier"===s.type)return a?"TwineError.create('keyword','I can\\'t use \\'"+s.text+"\\' in this position.') ":" Operations.Identifiers."+s.text.toLowerCase()+" ";if("variable"===s.type)return"VarRef.create(State.variables,"+o(s.name)+")"+(a?"":".get()");if("hookRef"===s.type)return a?"VarRef.create(section.selectHook('?"+s.name+"'), 'TwineScript_Assignee')":" section.selectHook('?"+s.name+"') ";if("string"===s.type)return s.text.replace(/\n/g,"\\n");if("colour"===s.type)return"Colour.create("+o(s.colour)+")";if("root"===s.type)return r(s.children)}var u=void 0,c=void 0,l=void 0,f=void 0,p=void 0,d=void 0,h=void 0,g=void 0,y=!0,m=!0,v=!1;return(u=t(e,"comma"))>-1?(p=",",m=!1):(u=t(e,"spread"))>-1?(p="Operations.makeSpreader(",f=r(e.splice(u+1))+")",y=!1):(u=t(e,"to"))>-1?(h="to",l="Operations.setIt("+r(e.slice(0,u),"varRef")+")"):(u=t(e,"into"))>-1?(h="into",f=r(e.slice(0,u),"varRef"),l="Operations.setIt("+r(e.slice(u+1),"varRef")+")"):(u=t(e,"augmentedAssign"))>-1?(h=e[u].operator,l=r(e.slice(0,u),"varRef"),f="Operations['"+h+"']("+(r(e.slice(0,u))+","+r(e.splice(u+1)))+")"):(u=t(e,"and","or"))>-1?d=e[u].type:(u=t(e,"is","isNot"))>-1?(v=!0,d=e[u].type):(u=t(e,"contains","isIn"))>-1?(v=!0,d=e[u].type):(u=t(e,"inequality"))>-1?(v=!0,d=e[u].operator):(u=t(e,"addition","subtraction"))>-1?(d=e[u].text,l=r(e.slice(0,u)),l.trim()||(l="0")):(u=t(e,"multiplication","division"))>-1?d=e[u].text:(u=t(e,"not"))>-1?(p="Operations.not(",f=r(e.splice(u+1))+")",y=!1):(u=t(e,"belongingProperty"))>-1?(f="VarRef.create("+r(e.slice(u+1),"varref")+","+o(e[u].name)+")"+(a?"":".get()"),p=" ",y=m=!1):(u=t(e,"belongingOperator","belongingItOperator"))>-1?(e[u].type.includes("It")&&(f="Operations.Identifiers.it",m=!1),g="belonging"):(u=n(e,"property"))>-1?(l="VarRef.create("+r(e.slice(0,u),"varref")+","+o(e[u].name)+")"+(a?"":".get()"),p=" ",y=m=!1):(u=n(e,"itsProperty"))>-1||(u=t(e,"belongingItProperty"))>-1?(l="VarRef.create(Operations.Identifiers.it,"+o(e[u].name)+").get()",p=" ",y=m=!1):(u=n(e,"possessiveOperator","itsOperator"))>-1?(e[u].type.includes("it")&&(l="Operations.Identifiers.it",y=!1),g="possessive"):(u=t(e,"macro"))>-1?(c=e[u].children[0],i("macroName"===c.type),p="Macros.run("+(c.isMethodCall?r(c.children):'"'+e[u].name+'"')+", [section,"+r(e[u].children.slice(1))+"])",y=m=!1):(u=t(e,"grouping"))>-1&&(p="("+r(e[u].children,a)+")",y=m=!1),u>-1?(d&&(a=!1),l=l||r(e.slice(0,u),a).trim(),f=f||r(e.splice(u+1)).trim(),v&&!l&&(l=" Operations.Identifiers.it "),y&&!l||m&&!f?"TwineError.create('operation','I need some code to be "+(y?"left ":"")+(y&&m?"and ":"")+(m?"right ":"")+'of "'+e[u].text+"\"')":p?l+p+f:h?"Operations.makeAssignmentRequest("+[l,f,o(h)]+")":g?"VarRef.create("+("belonging"===g?f:l)+",{computed:true,value:"+("belonging"===g?l:f)+"})"+(a?"":".get()"):d?" Operations["+o(d)+"]("+l+","+f+") ":""):1===e.length?((s.value||s.text)+"").trim()||" ":e.reduce(function(e,t){return e+r(t,a)},"")}var o=e.toJSLiteral,i=e.assert;return r}),define("internaltypes/twineerror",["jquery","utils"],function(e,t){var n=t.impossible,r=t.assert,o=t.escape,i={syntax:"The markup seems to contain a mistake.",saving:"I tried to save or load the game, but I couldn't do it.",operation:"I tried to use an operation on some data, but the data's type was incorrect.",macrocall:"I tried to use a macro, but its call wasn't written correctly.",datatype:"I tried to use a macro, but was given the wrong type of data to it.",keyword:"I was given a keyword in a way that I didn't understand.",changer:"This is a command to change a hook, but it isn't being used correctly.",infinite:"I almost ended up doing the same thing over and over, forever.",property:"I tried to access a value in a string/array/datamap, but I couldn't find it.",unimplemented:"I currently don't have this particular feature. I'm sorry.",javascript:"This error message was reported by your browser's Javascript engine. I don't understand it either, but it usually means that an expression was badly written."},a={create:function(e,t,o){return t||n("TwineError.create","called with only 1 string."),r(o||e in i),Object.assign(Object.create(this),{type:e,message:t,explanation:o})},fromError:function(e){return a.create("javascript","\u2615 "+e.message)},containsError:function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return t.reduce(function(e,t){return e?e:t instanceof Error?t:a.isPrototypeOf(t)?t:Array.isArray(t)?a.containsError.apply(a,_toConsumableArray(t)):!1},!1)},createWarning:function(e,t){return Object.assign(this.create(e,t),{warning:!0})},render:function(t){t=t||"";var n=e("<tw-error class='"+("javascript"===this.type?"javascript ":"")+(this.warning?"warning":"error")+"' title='"+o(t)+"'>"+o(this.message)+"</tw-error>"),r=e("<tw-error-explanation>").text(this.explanation||i[this.type]).hide(),a=e("<tw-error-explanation-button tabindex=0>").html("<span class='folddown-arrowhead'>&#9658;</span>");return a.on("click",function(){r.toggle(),a.children(".folddown-arrowhead").css("transform","rotate("+(r.is(":visible")?"90deg":"0deg")+")")}),n.append(a).append(r),n}};return a}),define("renderer",["utils","markup","twinescript/compiler","internaltypes/twineerror"],function(e,t,n,r){function o(e,t){var n=c.render(e.children);return n&&i(n,t)}var i=e.wrapHTMLTag,a=e.escape,s=e.impossible,u=e.toJSLiteral,c=void 0,l="text-align: center; max-width:50%; ";return c={options:{},exec:function(){var e=void 0,n=void 0;return function(r){return"string"!=typeof r?(s("Renderer.exec","source was not a string, but "+("undefined"==typeof r?"undefined":_typeof(r))),""):r===e?n:(e=r,n=c.render(t.lex(r).children))}}(),render:function e(s){var f="";if(!s)return f;for(var p=s.length,d=0;p>d;d+=1){var h=s[d];switch(h.type){case"error":f+=r.create("syntax",h.message).render(a(h.text))[0].outerHTML;break;case"numbered":case"bulleted":var g="numbered"===h.type?"ol":"ul";f+="<"+g+">";for(var y=1;p>d&&s[d]&&s[d].type===h.type;)f+=("<"+g+">").repeat(Math.max(0,s[d].depth-y)),f+=("</"+g+">").repeat(Math.max(0,y-s[d].depth)),y=s[d].depth,f+=o(s[d],"li"),d+=1;d-=1,f+=("</"+g+">").repeat(y+1);break;case"align":for(;h&&"align"===h.type;){var m="",v="",b=h.align,w=d+=1;if("left"===b){d-=1;break}for(;p>d&&s[d]&&"align"!==s[d].type;)d+=1;switch(v+=e(s.slice(w,d)),b){case"center":m+=l+"margin-left: auto; margin-right: auto;";break;case"justify":case"right":m+="text-align: "+b+";";break;default:+b&&(m+=l+"margin-left: "+b+"%;")}f+="<tw-align "+(m?'style="'+m+'"':"")+(c.options.debug?' title="'+h.text+'"':"")+">"+v+"</tw-align>\n",h=s[d]}break;case"heading":f+=o(h,"h"+h.depth);break;case"br":case"hr":f+="<"+h.type+">";break;case"escapedLine":case"comment":break;case"inlineUrl":f+='<a class="link" href="'+a(h.text)+'">'+h.text+"</a>";break;case"scriptStyleTag":case"tag":f+=h.text.startsWith("</")?h.text:h.text.replace(/>$/," data-raw>");break;case"sub":case"sup":case"del":case"strong":case"em":f+=o(h,h.type);break;case"bold":f+=o(h,"b");break;case"italic":f+=o(h,"i");break;case"twineLink":var x=t.lex("(link-goto:"+u(h.innerText)+","+u(h.passage)+")");f+=e(x.children);break;case"hook":f+="<tw-hook "+(h.name?'name="'+h.name+'"':"")+(c.options.debug&&h.name?' title="Hook: ?'+h.name+'"':"")+' source="'+a(h.innerText)+'"></tw-hook>';break;case"verbatim":f+=i(a(h.innerText).replace(/\n/g,"<br>"),"tw-verbatim");break;case"collapsed":f+=o(h,"tw-collapsed");break;case"hookRef":case"variable":case"macro":f+='<tw-expression type="'+h.type+'" name="'+a(h.name||h.text)+'"'+(c.options.debug?' title="'+a(h.text)+'"':"")+' js="'+a(n(h))+'"></tw-expression>';break;default:f+=h.children&&h.children.length?e(h.children):h.text}}return f}},Object.freeze(c)}),define("passages",["jquery","utils","utils/selectors"],function(e,t,n){function r(e){return Object.assign(new Map([["source",o(e.html())],["tags",(e.attr("tags")||"").split(/\s/)],["name",e.attr("name")]]),{TwineScript_TypeName:"passage datamap",TwineScript_ObjectName:"a passage datamap"})}var o=t.unescape,i=Object.assign(new Map,{TwineScript_ObjectName:"the Passages datamap",getTagged:function(e){var t=[];return this.forEach(function(n){var r=n instanceof Map&&n.get("tags");Array.isArray(r)&&r.indexOf(e)>-1&&t.push(n)}),t.sort(function(e,t){return e.get("name")>t.get("name")})},create:r});return e(function(){Array.from(e(n.storyData+" > "+n.passageData)).forEach(function(t){t=e(t),i.set(t.attr("name"),new r(t))})}),i}),define("utils/naturalsort",[],function(){return function(e){return function t(n,r){var o,i,a,s,u=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,c=/(^[ ]*|[ ]*$)/g,l=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,f=/^0x[0-9a-f]+$/i,p=/^0/,d=function(e){return t.insensitive&&(""+e).toLowerCase()||""+e},h=d(n).replace(c,"")||"",g=d(r).replace(c,"")||"",y=h.replace(u,"\x00$1\x00").replace(/\0$/,"").replace(/^\0/,"").split("\x00"),m=g.replace(u,"\x00$1\x00").replace(/\0$/,"").replace(/^\0/,"").split("\x00"),v=parseInt(h.match(f))||1!==y.length&&h.match(l)&&Date.parse(h),b=parseInt(g.match(f))||v&&g.match(l)&&Date.parse(g)||null;if(e&&window.Intl&&window.Intl.Collator&&(a=window.Intl.Collator(e)),b){if(b>v)return-1;if(v>b)return 1}for(var w=0,x=Math.max(y.length,m.length);x>w;w++){if(o=!(y[w]||"").match(p)&&parseFloat(y[w])||y[w]||0,i=!(m[w]||"").match(p)&&parseFloat(m[w])||m[w]||0,isNaN(o)!==isNaN(i))return isNaN(o)?1:-1;if(("undefined"==typeof o?"undefined":_typeof(o))!==("undefined"==typeof i?"undefined":_typeof(i)))o+="",i+="";else if("string"==typeof o&&a&&(s=a.compare(o,i),0!==s))return s;if(i>o)return-1;if(o>i)return 1}return 0}}}),define("utils/operationutils",["utils","internaltypes/twineerror"],function(e,t){function n(e){return!!e&&("object"===("undefined"==typeof e?"undefined":_typeof(e))||"function"==typeof e)}function r(e){return Array.isArray(e)?"array":e instanceof Map?"datamap":e instanceof Set?"dataset":e&&"object"===("undefined"==typeof e?"undefined":_typeof(e))?"object":""}function o(e,n){if(d(e instanceof Map),"string"!=typeof n&&"number"!=typeof n)return t.create("property","Only strings and numbers can be used as data names for "+u(e)+", not "+u(n)+".");var r="string"==typeof n?+n:""+n;return!Number.isNaN(r)&&e.has(r)?t.create("property","You mustn't use both "+u(n)+" and "+u(r)+" as data names in the same datamap."):!0}function i(e){return"string"==typeof e||Array.isArray(e)}function a(e){if(!n(e))return e;if("function"==typeof e.TwineScript_Clone)return e.TwineScript_Clone();if(Array.isArray(e))return[].concat(_toConsumableArray(e));if(e instanceof Map)return Object.assign(new Map(e),e);if(e instanceof Set)return Object.assign(new Set(e),e);if("function"==typeof e)return Object.assign(e.bind(),e);switch(Object.getPrototypeOf(e)){case Object.prototype:return Object.assign({},e);case null:return Object.assign(Object.create(null),e)}return h("OperationUtils.clone","The value "+(e.toSource?e.toSource():e)+" cannot be cloned!"),e}function s(e,t,r){return"string"==typeof t&&n(r)&&"TwineScript_ToString"in r?e(t,r.TwineScript_ToString()):"string"==typeof r&&n(t)&&"TwineScript_ToString"in t?e(t.TwineScript_ToString(),r):!1}function u(e){return n(e)&&"TwineScript_ObjectName"in e?e.TwineScript_ObjectName:Array.isArray(e)?"an array":e instanceof Map?"a datamap":e instanceof Set?"a dataset":"boolean"==typeof e?"the logic value '"+e+"'":"string"==typeof e||"number"==typeof e?"the "+("undefined"==typeof e?"undefined":_typeof(e))+" "+g(e):void 0===e?"an empty variable":"...whatever this is"}function c(e){return e.innerType?"either"===e.pattern?(d(Array.isArray(e.innerType)),e.innerType.map(c).join(" or ")):"optional"===e.pattern?"(an optional) "+c(e.innerType):c(e.innerType):e===String||e===Number||e===Boolean?"a "+_typeof(e()):e===Map?"a datamap":e===Set?"a dataset":e===Array?"an array":n(e)&&"TwineScript_TypeName"in e?e.TwineScript_TypeName:u(e)}function l(e,t){return"object"!==("undefined"==typeof e?"undefined":_typeof(e))&&"object"!==("undefined"==typeof t?"undefined":_typeof(t))?e===t:Array.isArray(e)&&Array.isArray(t)?e.length!==t.length?!1:e.every(function(e,n){return l(t[n],e)}):e instanceof Map&&t instanceof Map?l(Array.from(e.entries()).sort(),Array.from(t.entries()).sort()):e instanceof Set&&t instanceof Set?l(Array.from(e.values()),Array.from(t.values())):e&&"function"==typeof e.TwineScript_is?e.TwineScript_is(t):e&&"object"===("undefined"==typeof e?"undefined":_typeof(e))&&t&&"object"===("undefined"==typeof t?"undefined":_typeof(t))&&Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(t)===Object.prototype?l(Object.getOwnPropertyNames(e).map(function(t){return[t,e[t]]}),Object.getOwnPropertyNames(t).map(function(e){return[e,t[e]]})):Object.is(e,t)}function f(e,t){if(e){if("string"==typeof e)return e.indexOf(t)>-1;if(Array.isArray(e))return e.some(function(e){return l(e,t)});if(e instanceof Set||e instanceof Map)return Array.from(e.keys()).some(function(e){return l(e,t)})}return l(e,t)}function p(e,n,o){if(!n||!o)return t.create("macrocall","The sub"+r(e)+" index values must not be 0 or NaN.");if(0>n&&(n=e.length+n+1),0>o&&(o=e.length+o+1),n>o)return p(e,o,n);var i="string"==typeof e;i&&(e=Array.from(e));var a=e.slice(n>0?n-1:n,o);return i?a.join(""):a}var d=e.assert,h=e.impossible,g=e.toJSLiteral,y=Object.freeze({isObject:n,isValidDatamapName:o,collectionType:r,isSequential:i,clone:a,coerceToString:s,objectName:u,typeName:c,is:l,contains:f,subset:p,numericIndex:/^(?:[1-9]\d*|0)$/});return y}),define("macros",["jquery","utils/naturalsort","utils","utils/operationutils","internaltypes/twineerror"],function(e,t,n,r,o){function i(e){return function(n){n=n.reduce(function(e,n){if(n&&n.spreader===!0)if(Array.isArray(n.value)||"string"==typeof n.value)for(var r=0;r<n.value.length;r++)e.push(n.value[r]);else e.push(n.value instanceof Set?Array.from(n.value).sort(t("en")):o.create("operation","I can't spread out "+h(n.value)+", which is not a string, dataset or array."));else e.push(n);return e},[]);var r=o.containsError(n);return r?r:e.apply(void 0,_toConsumableArray(n))}}function a(e,t){if(null===t)return void 0===e;if(t.innerType){if("optional"===t.pattern||"zero or more"===t.pattern)return void 0===e?!0:a(e,t.innerType);if("either"===t.pattern)return t.innerType.some(function(t){return a(e,t)});if("wrapped"===t.pattern)return a(e,t.innerType)}return void 0!==t&&void 0===e?!1:t!==y.TypeSignature.Any||void 0===e||e.TwineScript_Unobservable?t===String?"string"==typeof e:t===Boolean?"boolean"==typeof e:t===Number?"number"==typeof e:t===Array?Array.isArray(e):t===Map||t===Set?e instanceof t:Object.isPrototypeOf.call(t,e):!0}function s(e,t,n){if(!n)return t;n=[].concat(n),e="("+(Array.isArray(e)&&e.length>1?e[0]:e)+":)";var r=void 0;return r=n.length>0?"The "+e+" macro must only be given "+n.map(g).reduce(function(e,t,n,r){return e+(0===n?"":n<r.length-1?", ":", and ")+t},"")+(n.length>1?", in that order":"."):"The macro must not be given any data - just write "+e+".",function(i){for(var s=arguments.length,u=Array(s>1?s-1:0),c=1;s>c;c++)u[c-1]=arguments[c];for(var p=void 0,d=0,m=Math.max(u.length,n.length);m>d;d+=1){var v=n[d],b=u[d];if(d>=n.length&&!p)return o.create("typesignature",u.length-n.length+" too many values were given to this "+e+" macro.",r);if(v||(v=p),!v.innerType||"rest"!==v.pattern&&"zero or more"!==v.pattern||(p=v.innerType,"rest"===v.pattern&&(v=v.innerType)),!a(b,v))return void 0===b?o.create("typesignature","The "+e+" macro needs "+f(n.length-d,"more value")+".",r):b&&b.TwineScript_Unobservable&&v===y.TypeSignature.Any?o.create("typesignature",e+"'s "+l(d+1)+" value is not valid data for this macro.",r):o.create("typesignature",e+"'s "+l(d+1)+" value is "+h(b)+", but should be "+g(v)+".",v.message||r)}return t.apply(void 0,[i].concat(u))}}function u(e,t,n){Array.isArray(e)?e.forEach(function(e){return d(m,c(e),n)}):d(m,c(e),n)}var c=n.insensitiveName,l=n.nth,f=n.plural,p=n.assert,d=n.lockProperty,h=r.objectName,g=r.typeName,y=void 0,m={},v={};return y={has:function(e){return e=c(e),m.hasOwnProperty(e)},get:function(e){return e=c(e),m.hasOwnProperty(e)&&m[e]},add:function e(t,n,r){return u(t,"value",i(s(t,n,r))),e},addChanger:function e(t,n,r,o){return p(r),u(t,"changer",i(s(t,n,o))),v[Array.isArray(t)?t[0]:t]=r,e},getChangerFn:function(e){return v[e]},TypeSignature:{optional:function(e){return{pattern:"optional",innerType:e}},zeroOrMore:function(e){return{pattern:"zero or more",innerType:e}},either:function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return{pattern:"either",innerType:t}},rest:function(e){return{pattern:"rest",innerType:e}},wrapped:function(e,t){return{pattern:"wrapped",innerType:e,message:t}},Any:{TwineScript_TypeName:"anything"}},run:function(e,t){return o.containsError(e)?e:y.has(e)?y.get(e)(t):o.create("macrocall","I can't run the macro '"+e+"' because it doesn't exist.")}},Object.freeze(y)}),define("datatypes/changercommand",["utils","macros","utils/operationutils"],function(e,t,n){var r=e.assert,o=n.is,i={changer:!0,TwineScript_TypeName:"a changer command",TwineScript_Print:function(){return"[A '"+this.macroName+"' command]"},create:function(e,t,n){return r(void 0===t||Array.isArray(t)),Object.assign(Object.create(this),{macroName:e,params:t,next:n||null,TwineScript_ObjectName:"a ("+e+":) command"})},"TwineScript_+":function(e){for(var t=this.TwineScript_Clone(),n=t;n.next;)n=n.next;return n.next=e,t},TwineScript_is:function(e){return i.isPrototypeOf(e)?this.macroName===e.macroName&&o(this.params,e.params)&&o(this.next,e.next):void 0},TwineScript_Clone:function(){return this.create(this.macroName,this.params,this.next)},run:function(e){t.getChangerFn(this.macroName).apply(void 0,[e].concat(_toConsumableArray(this.params))),this.next&&this.next.run(e)}};return Object.freeze(i)}),define("state",["utils","passages","datatypes/changercommand","internaltypes/twineerror","utils/operationutils"],function(e,t,n,r,o){var i=e.impossible,a=o.objectName,s={TwineScript_ObjectName:"this story's variables",TwineScript_Writeproof:[]},u={passage:"",variables:s,create:function(e,t){var n=Object.create(u);return n.passage=e||"",n.variables=Object.assign(Object.create(this.variables),t),n}},c=[],l=-1,f=u.create(),p=void 0,d=Object.assign({get passage(){return f.passage},get variables(){return f.variables},get pastLength(){return l},get futureLength(){return c.length-1-l},passageNameVisited:function(e){var n=0;if(!t.get(e))return 0;for(var r=0;l>=r;r++)n+=+(e===c[r].passage);return n},passageNameLastVisited:function(e){if(!t.get(e))return 1/0;if(e===f.passage)return 0;for(var n=l;n>0;n--)if(c[n].passage===e)return l-n+1;return 1/0},pastPassageNames:function(){for(var e=[],t=l-1;t>=0;t--)e.unshift(c[t].passage);return e},newPresent:function(e){f=(c[l]||u).create(e)},play:function(e){f||i("State.play","present is undefined!"),f.passage=e,c=c.slice(0,l+1).concat(f),l+=1,this.newPresent(e)},rewind:function(e){var t=1,n=!1;if(e)if("string"==typeof e){if(t=this.passageNameLastVisited(e),t===1/0)return}else"number"==typeof e&&(t=e);for(;t>0&&l>0;t--)n=!0,l-=1;return n&&this.newPresent(c[l].passage),n},fastForward:function(e){var t=1,n=!1;for("number"==typeof e&&(t=e);t>0&&c.length>0;t--)n=!0,l+=1;return n&&this.newPresent(c[l].passage),n},reset:function(){window.jasmine&&(c=[],l=-1,f=u.create(),p=void 0)}},function(){function e(t){return"number"==typeof t||"boolean"==typeof t||"string"==typeof t||null===t||Array.isArray(t)&&t.every(e)||t instanceof Set&&Array.from(t).every(e)||t instanceof Map&&Array.from(t.values()).every(e)||n.isPrototypeOf(t)}function t(e,t){return t instanceof Set?{"(dataset:)":Array.from(t)}:t instanceof Map?{"(datamap:)":Array.from(t)}:n.isPrototypeOf(t)?{changer:{name:t.macroName,params:t.params,next:t.next}}:t}function o(e,t){if(t&&"object"===("undefined"==typeof t?"undefined":_typeof(t))){if(Array.isArray(t["(dataset:)"]))return new Set(t["(dataset:)"]);if(Array.isArray(t["(datamap:)"]))return new Map(t["(datamap:)"]);if(t.changer&&"object"===_typeof(t.changer)){var r=t.changer,o=r.name,i=r.params,a=r.next;return n.create(o,i,a)}}return t}function i(){var n=c.slice(0,l+1),o=n.map(function(t){return Object.keys(t.variables).filter(function(n){return t.variables[n]&&!e(t.variables[n])}).map(function(e){return[e,t.variables[e]]})});if(p||(p=o.reduce(function(e,t,n){var r=_slicedToArray(t,2),o=r[0],i=r[1];return e||o&&[o,i,n+1]},void 0)),p){var i=p,s=_slicedToArray(i,3),u=s[0],f=s[1],d=s[2];return r.create("saving","The variable $"+u+" holds "+a(f)+" (which is, or contains, a complex data value) on turn "+d+"; the game can no longer be saved.")}try{return JSON.stringify(n,t)}catch(e){return!1}}function f(e){var t=void 0,n=s;try{t=JSON.parse(e,o)}catch(e){return!1}return Array.isArray(t)?(t=t.map(function(e){return"object"===("undefined"==typeof e?"undefined":_typeof(e))&&e.hasOwnProperty("passage")&&e.hasOwnProperty("variables")?(e.variables=Object.assign(Object.create(n),e.variables),n=e.variables,Object.assign(Object.create(u),e)):!1})).indexOf(!1)>-1?!1:(c=t,l=c.length-1,void this.newPresent(c[l].passage)):!1}return{serialise:i,deserialise:f}}());return Object.seal(u),Object.freeze(d)}),define("datatypes/colour",["utils","jquery"],function(e,t){function n(e){if(e in u)return u[e];var n=t("<p>").css("background-color",e).css("background-color");return n=n.startsWith("rgb")?n.match(/\d+/g).reduce(function(e,t,n){return e["rgb"[n]]=+t,e},{}):{r:192,g:192,b:192},u[e]=n,n}function r(e){return"string"!=typeof e?e:(e=e.replace("#",""),e=e.replace(a,"$1$1$2$2$3$3"),{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16)})}var o=e.assert,i=/^([\da-fA-F])$/,a=/^([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,s=/^([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,u=Object.create(null),c=Object.freeze({colour:!0,TwineScript_TypeName:"a colour",TwineScript_ObjectName:"a colour","TwineScript_+":function(e){var t=this,n=e;return c.create({r:Math.min(Math.round(.6*(t.r+n.r)),255),g:Math.min(Math.round(.6*(t.g+n.g)),255),b:Math.min(Math.round(.6*(t.b+n.b)),255)})},TwineScript_Print:function(){return"<tw-colour style='background-color:rgb("+[this.r,this.g,this.b].join(",")+");'></span>"},TwineScript_is:function(e){return c.isPrototypeOf(e)&&e.r===this.r&&e.g===this.g&&e.b===this.b},TwineScript_Clone:function(){return c.create(this)},toHexString:function(){return o(this!==c),"#"+this.r.toString(16).replace(i,"0$1")+this.g.toString(16).replace(i,"0$1")+this.b.toString(16).replace(i,"0$1")},create:function(e){return"string"==typeof e?this.create(c.isHexString(e)?r(e):n(e)):Object.assign(Object.create(this),e);

},isHexString:function(e){return"string"==typeof e&&"#"===e[0]&&(e.slice(1).match(a)||e.slice(1).match(s))}});return c}),define("utils/hookutils",["jquery","utils/selectors"],function(e,t){function n(e,t,n){var r=e.textContent.length;if(!(t>=r)){var o=void 0,i=[o=0===t?e:e.splitText(t)];return n&&(0>=n&&(n=r-n),r>n&&i.push(o.splitText(n-t))),i}}function r(e,t){var o=[],i="",a=[];if(!e.length||!t)return a;for(;e.length>0;){o.push(e[0]),i+=e[0].textContent,e.shift();var s=i.indexOf(t);if(s>-1){for(var u,c=i.length-(s+t.length);s>=o[0].textContent.length;)s-=o[0].textContent.length,o.shift();if(1===o.length){var l=n(o[0],s,s+t.length);a.push(l[0]),l[1]&&e.unshift(l[1]);break}a.push(n(o[0],s,o[0].length)[0]),(u=a).push.apply(u,_toConsumableArray(o.slice(1,-1)));var f=n(o[o.length-1],0,o[o.length-1].textContent.length-c);a.push(f[0]),f[1]&&e.unshift(f[1]),a=a.filter(Boolean);break}}return[a].concat(_toConsumableArray(r(e,t)))}var o={wrapTextNodes:function(t,n,o){var i=r(n.textNodes(),t),a=e();return i.forEach(function(t){a=a.add(e(t).wrapAll(o))}),a},selectorType:function(e){if(e&&"string"==typeof e){var t=/\?(\w*)/.exec(e);return t&&t.length?"hookRef":"<"===e[0]&&">"===e[e.length-1]?"html":"string"}return"undefined"},hookToSelector:function(e){return e=e.replace(/"/g,"&quot;"),t.hook+'[name="'+e+'"]'}};return Object.freeze(o)}),define("datatypes/hookset",["jquery","utils/hookutils"],function(e,t){function n(){return this.section.$(o(this.selector.slice(1)))}function r(e){for(var t=n.call(this),r=arguments.length,o=Array(r>1?r-1:0),i=1;r>i;i++)o[i-1]=arguments[i];return e in t&&t[e].apply(t,o)}var o=t.hookToSelector,i=Object.freeze({forEach:function(t){return r.call(this,"each",function(n){t(e(this),n)})},text:function(){return r.call(this,"text")},TwineScript_ToString:function(){return this.text()},TwineScript_Print:function(){return this.text()},get TwineScript_ObjectName(){return this.selector+" (a hook reference)"},TwineScript_TypeName:"a hook reference (like ?this)",set TwineScript_Assignee(e){this.section.renderInto(e,n.call(this),{append:"replace"})},get TwineScript_Assignee(){return this},TwineScript_AssignValue:function(){return r.call(this,"text")},TwineScript_DeleteValue:function(e){"TwineScript_Assignee"===e&&r.call(this,"text","")},create:function(e,t){var n=Object.create(this);return n.section=e,n.selector=t,Object.freeze(n)}});return i}),define("internaltypes/varref",["state","internaltypes/twineerror","utils/operationutils","datatypes/hookset"],function(e,t,n,r){function o(e,n){var r=void 0;if(e instanceof Map&&(r=t.containsError(b(e,n))))return r;if(g(e)){var o=void 0;if("number"==typeof n)n-=1;else if("string"==typeof n&&(o=/(\d+)(?:st|[nr]d|th)last/i.exec(n)))n=-o[1]+"";else if("string"==typeof n&&(o=/(\d+)(?:st|[nr]d|th)/i.exec(n)))n=o[1]-1+"";else if("last"===n)n=-1;else if("length"!==n)return t.create("property","You can only access position strings/numbers ('4th', 'last', '2ndlast', (2), etc.) and 'length' of "+y(e)+", not "+y(n)+".")}else if(e instanceof Set){if("length"!==n)return t.create("property","You can only get the 'length' of a "+y(e)+".","To check contained values, use the 'contains' operator.");n="size"}else if("number"==typeof e||"boolean"==typeof e)return t.create("property","You can't get data values from "+y(e)+".");return n}function i(e,n){var r=n.reduce(function(r,i,a){i.computed&&(i=i.value),i=Array.isArray(i)?i.map(function(t){return o(e,t)}):o(e,i);var s=void 0;return(s=t.containsError(r,i))?s:(a<n.length-1&&(e=p(e,i)),r.push(i),r)},[]);return{compiledPropertyChain:r,deepestObject:e}}function a(e,t){return void 0===e?e:e instanceof Map?e.get(t):(g(e)&&0>t-0&&(t=e.length+(t-0)),e[t])}function s(e){return e.computed?"("+y(e.value)+")":"'"+e+"'"}function u(e,n){if(Array.isArray(n))return n.map(function(t){return u(e,t)});var r="I won't add "+s(n)+" to "+y(e)+" because it's one of my special system collections.",o="I can't modify '"+s(n)+"' because it holds one of my special system collections.";if(e instanceof Map)return e.TwineScript_Sealed&&!e.has(n)?t.create("operation",r):e.TwineScript_Writeproof&&e.TwineScript_Writeproof.indexOf(n)>-1?t.create("operation",o):!0;if(g(e)){if("length"===n)return t.create("operation","I can't forcibly alter the length of "+y(e)+".");if(+n!==(0|n))return t.create("property",y(e)+" can only have position keys ('3rd', '1st', (5), etc.), not "+s(n)+".")}return!e.TwineScript_Sealed||n in e?e.TwineScript_Writeproof&&e.TwineScript_Writeproof.indexOf(n)>-1?t.create("operation",o):"number"==typeof e||"boolean"==typeof e?t.create("operation","You can't alter the data values of "+y(e)+"."):!0:t.create("operation",r)}function c(e,t,n){e instanceof Map?e.set(t,n):(g(e)&&0>t-0&&(t=e.length+(t-0)),e[t]=n)}function l(e,t){g(e)&&0>t-0&&(t=e.length+(t-0)),Array.isArray(e)&&v.exec(t)?e.splice(t,1):e instanceof Map||e instanceof Set?e.delete(t):e.TwineScript_DeleteValue?e.TwineScript_DeleteValue(t):delete e[t]}function f(e){function t(){return e}return{get:t,set:t,delete:t}}function p(n,r,o){if(Array.isArray(r))return r.map(function(e){return p(n,e,e)})["string"==typeof n?"join":"valueOf"]("");"string"==typeof n&&(n=[].concat(_toConsumableArray(n)));var i=a(n,r);return void 0===i?n===e.variables?w:t.create("property","I can't find a "+s(o)+" data name in "+y(n)):i}function d(e,n){var r=this,o=this.compiledPropertyChain.reduce(function(e,t){var n=void 0;return n=0===e.length?r.object:p.apply(void 0,_toConsumableArray(e[e.length-1])),e.push([n,t])&&e},[]).reduceRight(e,n);return t.containsError(o)?o:void 0}var h=n.isObject,g=n.isSequential,y=n.objectName,m=n.clone,v=n.numericIndex,b=n.isValidDatamapName,w=0,x=Object.freeze({varref:!0,get:function(){return p(this.deepestObject,this.compiledPropertyChain.slice(-1)[0],this.propertyChain.slice(-1)[0])},set:function(e){return e&&e.TwineScript_AssignValue&&(e=e.TwineScript_AssignValue()),d.call(this,function(e,n,o){var i=_slicedToArray(n,2),a=i[0],s=i[1],l=void 0;if(l=t.containsError(e,a,s)||t.containsError(h(a)&&u(a,s)))return l;if(r.isPrototypeOf(a)&&"string"!=typeof e)return t.create("datatype","You can only set hook references to strings, not "+y(e)+".");if("string"==typeof a){var f=function(){if("string"!=typeof e||e.length!==(Array.isArray(s)?s.length:1))return{v:t.create("datatype","I can't put this non-string value, "+y(e)+", in a string.")};a=[].concat(_toConsumableArray(a));var n=[].concat(_toConsumableArray(e));[].concat(s).forEach(function(e){0>0+e&&(e=a.length+(0+e)),a=[].concat(_toConsumableArray(a.slice(0,e)),[n.shift()],_toConsumableArray(a.slice(e+1)))}),a=a.join("")}();if("object"===("undefined"==typeof f?"undefined":_typeof(f)))return f.v}else h(a)&&(Array.isArray(s)&&g(e)?("string"==typeof e&&(e=[].concat(_toConsumableArray(e))),s.map(function(t,n){return[t,e[n]]}).forEach(function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];return c(a,n,r)})):c(a,s,e));return o>0&&(a=m(a)),a},e)},delete:function(){return d.call(this,function(e,n,r){var o=_slicedToArray(n,2),i=o[0],a=o[1],s=void 0;return(s=t.containsError(e,i,a)||t.containsError(h(i)&&u(i,a)))?s:(r>0&&(i=m(i)),null===e?h(i)&&(Array.isArray(a)?a.forEach(function(e){return l(i,e)}):l(i,a)):c(i,a,e),i)},null)},create:function(e,n){var r=void 0;if(r=t.containsError(e))return f(r);n=[].concat(n),x.isPrototypeOf(e)&&(n=e.propertyChain.concat(n),e=e.object);var o=i(e,n),a=o.compiledPropertyChain,s=o.deepestObject;return(r=t.containsError(a,s))?f(r):Object.assign(Object.create(x),{object:e,propertyChain:n,compiledPropertyChain:a,deepestObject:s})},get TwineScript_ObjectName(){return(this.object===e.variables?"$":y(this.object)+"'s ")+this.propertyChain.reduce(function(e,t){return e+"'s "+s(t)})}});return x}),define("internaltypes/assignmentrequest",["utils"],function(e){var t=e.assert,n=Object.freeze({assignmentRequest:!0,TwineScript_TypeName:"an assignment operation",TwineScript_ObjectName:"an assignment operation",TwineScript_Unobservable:!0,create:function(e,n,r){return t("propertyChain"in e&&"object"in e),Object.assign(Object.create(this),{dest:e,src:n,operator:r})}});return n}),define("twinescript/operations",["state","datatypes/colour","internaltypes/assignmentrequest","utils/operationutils","internaltypes/twineerror"],function(e,t,n,r,o){function i(e,t,n,r){return n=n||"do this to",function(i,a){1===t.length&&(a=i);var s=void 0;return(s=o.containsError(i,a))?s:("undefined"==typeof i?"undefined":_typeof(i))!==e||("undefined"==typeof a?"undefined":_typeof(a))!==e?o.create("operation","I can only "+n+" "+e+"s, not "+d(("undefined"==typeof i?"undefined":_typeof(i))!==e?i:a)+".",r):t(i,a)}}function a(e){return function(t,n){var r=void 0;return(r=o.containsError(t,n))?r:t&&t.varref?o.create("operation","I can't give an expression a new value."):("undefined"==typeof t?"undefined":_typeof(t))!==("undefined"==typeof n?"undefined":_typeof(n))||c(t)!==c(n)?l(e,t,n)||o.create("operation",d(t)+" isn't the same type of data as "+d(n)):e(t,n)}}function s(e){return function(t,n){var r=void 0;return(r=o.containsError(t,n))?r:(g=t,e(t,n))}}var u=r.isObject,c=r.collectionType,l=r.coerceToString,f=r.is,p=r.contains,d=r.objectName,h=void 0,g=0,y="If one of these values is a number, you may want to write a check that it 'is not 0'. Also, if one is a string, you may want to write a check that it 'is not \"\" '.";return h={create:function(e){var t=Object.create(this);return t.Identifiers={get it(){return g},get time(){return Date.now()-e.timestamp}},t},and:i("boolean",a(function(e,t){return e&&t}),"use 'and' to join",y),or:i("boolean",a(function(e,t){return e||t}),"use 'or' to join",y),not:i("boolean",function(e){return!e},"use 'not' to invert",y),"+":a(function(e,t){if(Array.isArray(e))return[].concat(_toConsumableArray(e),_toConsumableArray(t));var n=void 0;return e instanceof Map?(n=new Map(e),t.forEach(function(e,t){return n.set(t,e)}),n):e instanceof Set?(n=new Set(e),t.forEach(function(e){return n.add(e)}),n):"function"==typeof e["TwineScript_+"]?e["TwineScript_+"](t):"string|number|boolean".includes("undefined"==typeof e?"undefined":_typeof(e))?e+t:o.create("operation","I can't use + on "+d(e)+".")}),"-":a(function(e,t){if(Array.isArray(e))return e.filter(function(e){return-1===t.indexOf(e)});var n=void 0;return e instanceof Set?(n=new Set(e),t.forEach(function(e){return n.delete(e)}),n):"string"==typeof e?e.split(t).join(""):"number"==typeof e?e-t:o.create("operation","I can't use - on "+d(e)+".")}),"*":i("number",a(function(e,t){return e*t}),"multiply"),"/":i("number",a(function(e,t){return 0===t?o.create("operation","I can't divide "+d(e)+" by zero."):e/t}),"divide"),"%":i("number",a(function(e,t){return 0===t?o.create("operation","I can't modulo "+d(e)+" by zero."):e%t}),"modulus"),"<":s(i("number",a(function(e,t){return t>e}),"do < to")),">":s(i("number",a(function(e,t){return e>t}),"do > to")),"<=":s(i("number",a(function(e,t){return t>=e}),"do <= to")),">=":s(i("number",a(function(e,t){return e>=t}),"do >= to")),is:s(f),isNot:s(function(e,t){return!h.is(e,t)}),contains:s(p),isIn:s(function(e,t){return p(t,e)}),makeSpreader:function(e){return{value:e,spreader:!0}},makeAssignmentRequest:function(e,t,r){var i=o.containsError(e,t);return i?i:t&&t.TwineScript_Unobservable?o.create("operation","That type of value can't be stored."):u(e)&&"propertyChain"in e?n.create(e,t,r):o.create("operation","I can't store a new value inside "+d(e)+".")},setIt:function(e){return o.containsError(e)?e:e.varref?(g=e.get(),e):o.create("operation","I can't put a new value into "+d(e)+".")}},Object.freeze(h)}),define("twinescript/environ",["macros","state","utils","datatypes/colour","internaltypes/varref","internaltypes/twineerror","twinescript/operations"],function(Macros,State,Utils,Colour,VarRef,TwineError,OperationsProto){return function(section){"object"===("undefined"==typeof section?"undefined":_typeof(section))&&section||Utils.impossible("TwineScript.environ","no Section argument was given!");var Operations=OperationsProto.create(section);return section.eval=function(){try{return eval(Array.from(arguments).join(""))}catch(e){return Utils.log(e),Utils.log(Array.from(arguments).join("")),e}},section}}),define("internaltypes/pseudohookset",["jquery","utils/hookutils"],function(e,t){var n=t.wrapTextNodes,r=Object.freeze({forEach:function(t){var r=n(this.selector,this.section.dom,"<tw-pseudo-hook>").parent();r.each(function(n){t(e(this),n)}),r.contents().unwrap().parent().each(function(){this.normalize()})},create:function(e,t){var n=Object.create(this);return n.section=e,n.selector=t,n}});return r}),define("internaltypes/changedescriptor",["jquery","utils","renderer"],function(e,t,n){var r=t.assertOnlyHas,o=t.impossible,i=t.transitionIn,a=n.exec,s=void 0,u={source:"",enabled:!0,target:null,append:"append",transition:"instant",transitionTime:0,styles:null,attr:null,data:null,section:null,create:function(e,t){var n=Object.assign(Object.create(this),{attr:[].concat(this.attr||[]),styles:[].concat(this.styles||[])},e);return t&&t.run(n),n},update:function(){var e=this,t=this.target;Array.isArray(this.styles)&&setTimeout(function(){return t.css(Object.assign.apply(Object,_toConsumableArray([{}].concat(e.styles))))}),this.attr&&this.attr.forEach(function(e){return t.attr(e)}),this.data&&t.data(this.data)},render:function(){var t=this.target,n=this.source,u=this.transition,c=this.enabled,l=this.append;if(r(this,s),!t||!c)return e();if(!(l in t)){if("replace"!==l)return void o("Section.render","The target jQuery doesn't have a '"+l+"' method.");t.empty(),l="append"}var f=e(n&&e.parseHTML(a(n),document,!0));return t[l](f.length?f:void 0),this.update(),u&&i("replace"===l?t:f,u),f}};return s=Object.keys(u),Object.seal(u)}),define("internaltypes/twinenotifier",["jquery","utils"],function(e,t){var n=t.impossible,r={create:function(e){return e||n("TwineNotifier.create","called with only 1 string."),Object.assign(Object.create(r),{message:e})},render:function(){return e("<tw-notifier>").attr("message",this.message)}};return r}),define("section",["jquery","utils","utils/selectors","renderer","twinescript/environ","state","utils/hookutils","datatypes/hookset","internaltypes/pseudohookset","internaltypes/changedescriptor","internaltypes/twineerror","internaltypes/twinenotifier"],function(e,t,n,r,o,i,a,s,u,c,l,f){function p(e,r){var o=e.next(n.hook);if(r&&r.changer)if(o.length){var i=this.renderInto(o.popAttr("source"),o,r);if(!i)return e.addClass("false"),void("elseif"!==t.insensitiveName(e.attr("name"))&&(this.stack[0].lastHookShown=!1))}else e.replaceWith(l.create("changer","The ("+r.macroName+":) command should be assigned to a variable or attached to a hook.","Macros like this should usually be touching the left side of a hook: "+e.attr("title")+"[Some text]").render(e.attr("title")));else if(r&&r.live)g.call(this,o,r.delay,r.event);else if((r===!1||null===r||void 0===r)&&(o.removeAttr("source"),e.addClass("false"),o.length))return void(this.stack[0].lastHookShown=!1);o.length&&(this.stack[0].lastHookShown=!0)}function d(t){var n=this.eval(t.popAttr("js")||"");if(l.containsError(n))n instanceof Error&&(n=l.fromError(n)),t.replaceWith(n.render(t.attr("title"),t));else if(f.isPrototypeOf(n))t.append(n.render());else if(n&&n.TwineScript_Print&&!n.changer){if(n=n.TwineScript_Print(),n.earlyExit)return!1;n instanceof e?t.append(n):l.containsError(n)?(n instanceof Error&&(n=l.fromError(n)),t.replaceWith(n.render(t.attr("title"),t))):this.renderInto(n,t)}else"string"==typeof n||"number"==typeof n||"object"===("undefined"==typeof n?"undefined":_typeof(n))&&n&&n.toString!==Object.prototype.toString?this.renderInto(n+"",t):p.call(this,t,n)}function h(n){function r(t){return 0===e(this||t).parentsUntil("tw-collapsed").filter("tw-verbatim, tw-expression, [collapsing=false]").length}var o=n.prevTextNode();e(o).parents("tw-collapsed").length||(o=null);var i=n.nextTextNode();e(i).parents("tw-collapsed").length||(i=null),t.findAndFilter(n,"br:not([data-raw])").filter(r).replaceWith(document.createTextNode(" "));var a=n.textNodes(),s=0;a.reduce(function(e,t){return r(t)?(t.textContent=t.textContent.replace(/\s+/g," ")," "!==t.textContent[0]||e&&e.textContent&&!(e.textContent.search(/\s$/)>-1)||(t.textContent=t.textContent.slice(1)),t):document.createTextNode("A")},o),[].concat(_toConsumableArray(a)).reverse().every(function(e){return r(e)?e.textContent.match(/^\s*$/)?(s+=e.textContent.length,e.textContent="",!0):(e.textContent=e.textContent.replace(/\s+$/,function(e){return s+=e.length,""}),!1):!1}),s>0&&i&&(a[a.length-1].textContent+=" "),n[0]&&m()&&n[0].normalize()}function g(e,t){var r=this,o=e.popAttr("source")||"";t=void 0===t?20:t;var i=function i(){r.inDOM()&&(r.renderInto(o,e,{append:"replace"}),e.find(n.expression+"[name='stop']").length||r.inDOM()&&setTimeout(i,t))};setTimeout(i,t)}var y=void 0,m=function(){var t=void 0;return function(){if(void 0!==t)return t;var n=e("<p>");return n[0].normalize?(n.append(document.createTextNode("0-"),document.createTextNode("2"),document.createTextNode(""))[0].normalize(),t=1===n.contents().length):t=!1}}();return y={create:function(n){t.assert(n instanceof e&&1===n.length);var r=Object.assign(Object.create(this),{timestamp:Date.now(),dom:n||t.storyElement,stack:[],enchantments:[]});return r=o(r)},inDOM:function(){return e(t.storyElement).find(this.dom).length>0},$:function(e){return t.$(e,this.dom)},evaluateTwineMarkup:function(t){var n=e("<p>");this.renderInto(t,n);var r=void 0;return(r=n.find("tw-error")).length>0?r:n.text()},selectHook:function(e){if(s.isPrototypeOf(e)||u.isPrototypeOf(e))return e;switch(a.selectorType(e)){case"hookRef":return s.create(this,e);case"html":return t.findAndFilter(this.dom.add(t.storyElement),e.slice(1,-1));case"string":return u.create(this,e)}return null},renderInto:function(r,o,i){var a=c.create({target:o,source:r});if(a.section=this,i&&[].concat(i).forEach(function(e){e&&e.changer?e.run(a):Object.assign(a,e)}),"string"==typeof a.target&&(a.target=this.selectHook(a.target)),!a.target)return t.impossible("Section.renderInto","ChangeDescriptor has source but not a target!"),!1;var s=e();this.stack.length>=50?s=l.create("infinite","Printing this expression may have trapped me in an infinite loop.").render(o.attr("title")).replaceAll(o):a.target instanceof e?s=a.render():a.target.forEach(function(e){s=s.add(a.create({target:e}).render())}),this.stack.unshift(Object.create(null));var u=this;return t.findAndFilter(s,n.hook+","+n.expression).each(function(){var t=e(this);switch(t.tag()){case n.hook:t.attr("source")&&(u.renderInto(t.attr("source"),t),t.removeAttr("source"));break;case n.expression:return d.call(u,t)}}),s.length&&o instanceof e&&o.is(n.hook)&&o.parents("tw-collapsed").length>0&&h(s),t.findAndFilter(s,n.collapsed).each(function(){h(e(this))}),this.stack.shift(),0===this.stack.length&&this.updateEnchantments(),a.enabled},updateEnchantments:function(){this.enchantments.forEach(function(e){e.disenchant(),e.enchantScope()})}},Object.preventExtensions(y)}),define("engine",["jquery","utils","utils/selectors","state","section","passages"],function(e,t,n,r,o,i){function a(){var t=e("<tw-passage><tw-sidebar>"),o=t.children(n.sidebar);g.permalink&&r.save&&o.append('<tw-icon tabindex=0 class="permalink" title="Permanent link to this passage"><a href="#'+r.save()+'">&sect;');var i=e('<tw-icon tabindex=0 class="undo" title="Undo">&#8630;</tw-icon>').click(h.goBack),a=e('<tw-icon tabindex=0 class="redo" title="Redo">&#8631;</tw-icon>').click(h.goForward);return r.pastLength<=0&&i.css("visibility","hidden"),r.futureLength<=0&&a.css("visibility","hidden"),o.append(i).append(a),t}function s(e,t){return"<tw-include type="+e+" title='"+c(t.get("name"))+"'>"+t.get("source")+"</tw-include>"}function u(u,c){var h="instant",y=i.get(u),m=t.storyElement,v=m.parent();v.is(n.enchantment)&&(v=m.unwrap().parent()),y&&y instanceof Map&&y.has("source")||l("Engine.showPassage","There's no passage with the name \""+u+'"!'),m.detach();var b=t.$(m.children(f));!c&&h&&p(b,h);var w=a().appendTo(m);d(w.length>0);var x=o.create(w),T=y.get("source");T=(g.debug?i.getTagged("debug-header").map(s.bind(0,"debug-header")).join(""):"")+i.getTagged("header").map(s.bind(0,"header")).join("")+T+i.getTagged("footer").map(s.bind(0,"footer")).join("")+(g.debug?i.getTagged("debug-footer").map(s.bind(0,"debug-footer")).join(""):""),r.pastLength<=0&&(g.debug&&(T=i.getTagged("debug-startup").map(s.bind(0,"debug-startup")).join("")+T),T=i.getTagged("startup").map(s.bind(0,"startup")).join("")+T),x.renderInto(T,w,[{transition:"dissolve"}]),e("html").append(m.parent().length?m.parent():m),scroll(0,c?w.offset().top-.05*e(window).height():v.offset().top)}var c=t.escape,l=t.impossible,f=t.passageSelector,p=t.transitionOut,d=t.assert,h=void 0,g=Object.create(null);return h={goBack:function(){r.rewind()&&u(r.passage)},goForward:function(){r.fastForward()&&u(r.passage)},goToPassage:function(e,t){r.play(e),u(e,t)},showPassage:u,options:g},Object.freeze(h)}),define("macrolib/values",["macros","utils/operationutils","internaltypes/twineerror"],function(e,t,n){function r(e){return function(t){var r=e.apply(void 0,_toConsumableArray(t));return"number"!=typeof r||isNaN(r)?n.create("macrocall","This mathematical expression doesn't compute!"):r}}function o(){var e;return e=~~(Math.random()*arguments.length),arguments.length<=e?void 0:arguments[e]}var i=t.subset,a=t.objectName,s=e.TypeSignature,u=s.rest,c=s.zeroOrMore,l=s.Any;e.add(["text","string"],function(){for(var e=arguments.length,t=Array(e>1?e-1:0),n=1;e>n;n++)t[n-1]=arguments[n];return t.join("")},[c(e.TypeSignature.either(String,Number,Boolean,Array))])("substring",function(e,t,n,r){return i(t,n,r)},[String,Number,Number])(["num","number"],function(e,t){return Number.isNaN(+t)?n.create("macrocall","I couldn't convert "+a(t)+" to a number."):+t},[String]),{weekday:[function(){return["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur"][(new Date).getDay()]+"day"},null],monthday:[function(){return(new Date).getDate()},null],currenttime:[function(){var e=new Date,t=e.getHours()<12,n=e.getHours()%12||12,r=(e.getMinutes()<10?"0":"")+e.getMinutes();return n+":"+r+" "+(t?"A":"P")+"M"},null],currentdate:[function(){return(new Date).toDateString()},null],min:[Math.min,u(Number)],max:[Math.max,u(Number)],abs:[Math.abs,Number],sign:[Math.sign,Number],sin:[Math.sin,Number],cos:[Math.cos,Number],tan:[Math.tan,Number],floor:[Math.floor,Number],round:[Math.round,Number],ceil:[Math.ceil,Number],pow:[r(Math.pow),Number,Number],exp:[Math.exp,Number],sqrt:[r(Math.sqrt),Number],log:[r(Math.log),Number],log10:[r(Math.log10),Number],log2:[r(Math.log2),Number],random:[function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e!==(0|e)||t!==(0|t))return n.create("macrocall","(random:) only accepts whole numbers, not "+a(e!==(0|e)?e:t));var r=void 0,o=void 0;return t?(r=Math.min(e,t),o=Math.max(e,t)):(r=0,o=e),o+=1,~~(Math.random()*(o-r))+r},[Number,e.TypeSignature.optional(Number)]],either:[o,u(l)],alert:[function(e){return window.alert(e||"")||""},String],prompt:[function(e,t){return window.prompt(e||"",t||"")||""},String,String],confirm:[function(e){return window.confirm(e||"")},String],openURL:[function(e){return window.open(e)&&""},String],reload:[function(){return window.location.reload()||""},null],gotoURL:[function(){return window.location.assign()||""},String],pageURL:[function(){return window.location.href},null],"":function(){var t=this;Object.keys(this).forEach(function(n){n&&!function(){var r=t[n][0],o=t[n][1];e.add(n,function(){for(var e=arguments.length,t=Array(e>1?e-1:0),n=1;e>n;n++)t[n-1]=arguments[n];return r.apply(void 0,t)},o)}()})}}[""]()}),function(e){!function(){if(!e.requestAnimationFrame){if(e.webkitRequestAnimationFrame)return e.requestAnimationFrame=e.webkitRequestAnimationFrame,void(e.cancelAnimationFrame=e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame);var t=0;e.requestAnimationFrame=function(n){var r=(new Date).getTime(),o=Math.max(0,16-(r-t)),i=e.setTimeout(function(){n(r+o)},o);return t=r+o,i},e.cancelAnimationFrame=function(e){clearTimeout(e)}}}(),"function"==typeof define&&define("requestAnimationFrame",[],function(){return e.requestAnimationFrame})}(window),define("macrolib/commands",["requestAnimationFrame","macros","utils","state","passages","engine","internaltypes/twineerror","utils/operationutils"],function(e,t,n,r,o,i,a,s){function u(e){return"("+e+" "+i.options.ifid+") "}var c=n.toJSLiteral,l=n.unescape,f=s.isObject,p=t.TypeSignature,d=p.Any,h=p.optional,g=!!localStorage&&function(){try{return localStorage.setItem("test","1"),localStorage.removeItem("test"),!0}catch(e){return!1}}();t.add("display",function(e,t){return{TwineScript_ObjectName:"a (display: "+c(t)+") command",TwineScript_TypeName:"a (display:) command",TwineScript_Print:function(){return o.has(t)?l(o.get(t).get("source")):a.create("macrocall","I can't (display:) the passage '"+t+"' because it doesn't exist.")}}},[String])("print",function e(t,n){if(a.containsError(n))return n;if(n&&"function"==typeof n.TwineScript_Print)n=n.TwineScript_Print();else if(n instanceof Map){if(n=Array.from(n.entries()),a.containsError(n))return n;n=n.reduce(function(n,r){return n+"<tr><td>"+e(t,r[0]).TwineScript_Print()+"</td><td>"+e(t,r[1]).TwineScript_Print()+"</td></tr>"},"<table class=datamap>")+"</table>"}else if(n instanceof Set)n=Array.from(n.values());else if(Array.isArray(n))n+="";else{if(f(n))throw new TypeError("I don't know how to print this value yet.");n+=""}return{TwineScript_ObjectName:"a (print: "+c(n)+") command",TwineScript_TypeName:"a (print:) command",TwineScript_Print:function(){return n}}},[d])("goto",function(t,n){return{TwineScript_ObjectName:"a (go-to: "+c(n)+") command",TwineScript_TypeName:"a (go-to:) command",TwineScript_Print:function(){return o.has(n)?(e(i.goToPassage.bind(i,n,!1)),{earlyExit:1}):a.create("macrocall","I can't (go-to:) the passage '"+n+"' because it doesn't exist.")}}},[String])("live",function(e,t){return{TwineScript_ObjectName:"a (live: "+t+") command",TwineScript_TypeName:"a (live:) command",live:!0,delay:t}},[h(Number)])("stop",function(){return{TwineScript_ObjectName:"a (stop:) command",TwineScript_TypeName:"a (stop:) command",TwineScript_Print:function(){return""}}},[])("savegame",function(e,t,n){if(n=n||"",!g)return!1;var o=r.serialise();if(a.containsError(o))return o;try{return localStorage.setItem(u("Saved Game")+t,o),localStorage.setItem(u("Saved Game Filename")+t,n),!0}catch(e){return!1}},[String,h(String)])("loadgame",function(t,n){return{TwineScript_ObjectName:"a (load-game:) command",TwineScript_TypeName:"a (load-game:) command",TwineScript_Print:function(){var t=localStorage.getItem(u("Saved Game")+n);return t?(r.deserialise(t),e(i.showPassage.bind(i,r.passage,!1)),{earlyExit:1}):a.create("saving","I can't find a save slot named '"+n+"'!")}}},[String])}),define("macrolib/datastructures",["jquery","utils/naturalsort","macros","utils/operationutils","state","engine","passages","internaltypes/assignmentrequest","internaltypes/twineerror","internaltypes/twinenotifier"],function(e,t,n,r,o,i,a,s,u,c){var l=r.objectName,f=r.subset,p=r.collectionType,d=r.isValidDatamapName,h=n.TypeSignature,g=h.optional,y=h.rest,m=h.zeroOrMore,v=h.Any;n.add("set",function(){for(var e="",t=0;t<(arguments.length<=1?0:arguments.length-1);t+=1){var n=arguments.length<=t+1?void 0:arguments[t+1];if("into"===n.operator)return u.create("macrocall","Please say 'to' when using the (set:) macro.");var r=n.dest.set(n.src);if(u.isPrototypeOf(r))return r;i.options.debug&&(e+=(e?"; ":"")+l(n.dest)+" is now "+l(n.src))}return{TwineScript_TypeName:"a (set:) operation",TwineScript_ObjectName:"a (set:) operation",TwineScript_Unobservable:!0,TwineScript_Print:function(){return e&&c.create(e).render()}}},[y(s)])("put",function(){for(var e="",t=0;t<(arguments.length<=1?0:arguments.length-1);t+=1){var n=arguments.length<=t+1?void 0:arguments[t+1];if("into"!==n.operator)return u.create("macrocall","Please say 'into' when using the (put:) macro.");var r=n.dest.set(n.src);if(u.isPrototypeOf(r))return r;i.options.debug&&(e+=(e?"; ":"")+l(n.dest)+" is now "+l(n.src))}return{TwineScript_TypeName:"a (put:) operation",TwineScript_ObjectName:"a (put:) operation",TwineScript_Unobservable:!0,TwineScript_Print:function(){return e&&c.create(e).render()}}},[y(s)])("move",function(e,t){if("into"!==t.operator)return u.create("macrocall","Please say 'into' when using the (move:) macro.");if(t.src&&t.src.varref){var n=t.src.get(),r=void 0;if(r=u.containsError(n))return r;t.dest.set(n),t.src.delete()}else t.dest.set(t.src),t.src.TwineScript_DeleteValue&&t.src.TwineScript_DeleteValue();return{TwineScript_TypeName:"a (move:) operation",TwineScript_ObjectName:"a (move:) operation",TwineScript_Unobservable:!0,TwineScript_Print:""}},[y(s)])(["a","array"],function(){for(var e=arguments.length,t=Array(e>1?e-1:0),n=1;e>n;n++)t[n-1]=arguments[n];return t},m(v))("range",function e(t,n,r){if(n>r)return e(t,r,n);var o=[n];for(r-=n;r-->0;)o.push(++n);return o},[Number,Number])("subarray",function(e,t,n,r){return f(t,n,r)},[Array,Number,Number])("shuffled",function(){for(var e=arguments.length,t=Array(e>1?e-1:0),n=1;e>n;n++)t[n-1]=arguments[n];return t.reduce(function(e,t,n){var r=Math.random()*(n+1)|0;return r===n?e.push(t):(e.push(e[r]),e[r]=t),e},[])},[v,y(v)])("sorted",function(){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];return n.sort(t("en"))},[String,y(String)])("rotated",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;n>o;o++)r[o-2]=arguments[o];return t*=-1,0===t?u.create("macrocall","I can't rotate these values by 0 positions."):Math.abs(t)>=r.length?u.create("macrocall","I can't rotate these "+r.length+" values by "+t+" positions."):r.slice(t).concat(r.slice(0,t))},[v,v,y(v)])("datanames",function(e,n){return Array.from(n.keys()).sort(t("en"))},[Map])("datavalues",function(e,n){return Array.from(n.entries()).sort(function(e,n){return[e[0],n[0]].sort(t("en"))[0]===e[0]?-1:1}).map(function(e){return e[1]})},[Map])("history",function(){return o.pastPassageNames()},[])("passage",function(e,t){return a.get(t||o.passage)||u.create("macrocall","There's no passage named '"+t+"' in this story.")},[g(String)])("savedgames",function(){function e(e){return"("+e+" "+i.options.ifid+") "}var t=0,n=void 0,r=new Map;do{n=localStorage.key(t),t+=1;var o=e("Saved Game");n&&n.startsWith(o)&&(n=n.slice(o.length),r.set(n,localStorage.getItem(e("Saved Game Filename")+n)))}while(n);return r},[])("datamap",function(){for(var e=arguments.length,t=Array(e>1?e-1:0),n=1;e>n;n++)t[n-1]=arguments[n];var r=void 0,o=new Map,i=t.reduce(function(e,t){var n=void 0;if(u.containsError(e))return e;if(void 0===r)r=t;else{if(n=u.containsError(d(o,r)))return n;if(o.has(r))return u.create("macrocall","You used the same data name ("+l(r)+") twice in the same (datamap:) call.");o.set(r,t),r=void 0}return e},!0);return u.containsError(i)?i:void 0!==r?u.create("macrocall","This datamap has a data name without a value."):o},m(v))("dataset",function(){for(var e=arguments.length,t=Array(e>1?e-1:0),n=1;e>n;n++)t[n-1]=arguments[n];return new Set(t)},m(v))("count",function(e,t,n){switch(p(t)){case"dataset":case"datamap":return+t.has(name);case"string":return"string"!=typeof n?new TypeError(l(t)+" can't contain  "+l(n)+" because it isn't a string."):t.split(n).length-1;case"array":return t.reduce(function(e,t){return e+(t===n)},0)}},[v,v])}),define("macrolib/stylechangers",["jquery","macros","utils","utils/selectors","datatypes/colour","datatypes/changercommand","internaltypes/twineerror"],function(e,t,n,r,o,i,a){var s=n.insensitiveName,u=n.assert,c=n.childrenProbablyInline,l=t.TypeSignature,f=l.either,p=l.wrapped,d=[p(Boolean,'If you gave a number, you may instead want to check that the number is not 0. If you gave a string, you may instead want to check that the string is not "".')];t.addChanger("if",function(e,t){return i.create("if",[t]);

},function(e,t){return e.enabled=e.enabled&&t},d)("unless",function(e,t){return i.create("unless",[!t])},function(e,t){return e.enabled=e.enabled&&t},d)("elseif",function(e,t){return"lastHookShown"in e.stack[0]?i.create("elseif",[e.stack[0].lastHookShown===!1&&!!t]):a.create("macrocall","There's no (if:) or something else before this to do (else-if:) with.")},function(e,t){return e.enabled=e.enabled&&t},d)("else",function(e){return"lastHookShown"in e.stack[0]?i.create("else",[e.stack[0].lastHookShown===!1]):a.create("macrocall","There's nothing before this to do (else:) with.")},function(e,t){return e.enabled=e.enabled&&t},null)(["hook"],function(e,t){return i.create("hook",[t])},function(e,t){return e.attr.push({name:t})},[String])(["transition","t8n"],function(e,t){var n=["dissolve","shudder","pulse"];return t=s(t),-1===n.indexOf(t)?a.create("macrocall","'"+t+'" is not a valid (transition:)',"Only the following names are recognised (capitalisation and hyphens ignored): "+n.join(", ")):i.create("transition",[t])},function(e,t){return e.transition=t,e},[String])("font",function(e,t){return i.create("font",[t])},function(e,t){return e.styles.push({"font-family":t}),e},[String])("align",function(e,t){var n=void 0,r=t.indexOf("><");if(!/^(==+>|<=+|=+><=+|<==+>)$/.test(t))return a.create("macrocall",'The (align:) macro requires an alignment arrow ("==>", "<==", "==><=" etc.) be provided, not "'+t+'"');if(~r){var o=Math.round(r/(t.length-2)*50);n=Object.assign({"text-align":"center","max-width":"50%"},25===o?{"margin-left":"auto","margin-right":"auto"}:{"margin-left":o+"%"})}else n="<"===t[0]&&">"===t.slice(-1)?{"text-align":"justify","max-width":"50%"}:t.includes(">")?{"text-align":"right"}:{"text-align":"left"};return n.display="block",i.create("align",[n])},function(e,t){e.styles.push(t)},[String])(["text-colour","text-color","color","colour"],function(e,t){return t&&t.colour&&(t=t.toHexString(t)),i.create("text-colour",[t])},function(e,t){return e.styles.push({color:t}),e},[f(String,o)])("text-rotate",function(e,t){return i.create("text-rotate",[t])},function(t,n){return t.styles.push({display:"inline-block",transform:function(){var t=e(this).css("transform")||"";return"none"===t&&(t=""),t+" rotate("+n+"deg)"}}),t},[Number])("background",function(e,t){return t&&t.colour&&(t=t.toHexString(t)),i.create("background",[t])},function(t,n){var r=void 0;return r=o.isHexString(n)?{"background-color":n}:{"background-size":"cover","background-image":"url("+n+")"},t.styles.push(r,{display:function(){return c(e(this))?"initial":"block"}}),t},[f(String,o)]).apply(void 0,_toConsumableArray(function(){var t={color:"transparent"},n=Object.assign(Object.create(null),{bold:{"font-weight":"bold"},italic:{"font-style":"italic"},underline:{"text-decoration":"underline"},strike:{"text-decoration":"line-through"},superscript:{"vertical-align":"super","font-size":".83em"},subscript:{"vertical-align":"sub","font-size":".83em"},blink:{animation:"fade-in-out 1s steps(1,end) infinite alternate"},shudder:{animation:"shudder linear 0.1s 0s infinite",display:"inline-block"},mark:{"background-color":"hsla(60, 100%, 50%, 0.6)"},condense:{"letter-spacing":"-0.08em"},expand:{"letter-spacing":"0.1em"},outline:[{"text-shadow":function(){var t=e(this).css("color");return"-1px -1px 0 "+t+", 1px -1px 0 "+t+",-1px  1px 0 "+t+", 1px  1px 0 "+t}},{color:function(){for(var t=e(this);t.length&&t[0]!==document;t=t.parent()){var n=t.css("background-color");if("transparent"!==n&&!n.match(/^\w+a\(.+?,\s*0\s*\)$/))return n}return"#fff"}}],shadow:{"text-shadow":function(){return"0.08em 0.08em 0.08em "+e(this).css("color")}},emboss:{"text-shadow":function(){return"0.08em 0.08em 0em "+e(this).css("color")}},smear:[{"text-shadow":function(){var t=e(this).css("color");return"0em   0em 0.02em "+t+",-0.2em 0em  0.5em "+t+", 0.2em 0em  0.5em "+t}},t],blur:[{"text-shadow":function(){return"0em 0em 0.08em "+e(this).css("color")}},t],blurrier:[{"text-shadow":function(){return"0em 0em 0.2em "+e(this).css("color")},"user-select":"none"},t],mirror:{display:"inline-block",transform:"scaleX(-1)"},upsidedown:{display:"inline-block",transform:"scaleY(-1)"},fadeinout:{animation:"fade-in-out 2s ease-in-out infinite alternate"},rumble:{animation:"rumble linear 0.1s 0s infinite",display:"inline-block"}});return["text-style",function(e,t){return t=s(t),t in n?i.create("text-style",[t]):a.create("macrocall","'"+t+'" is not a valid (textstyle:)',"Only the following names are recognised (capitalisation and hyphens ignored): "+Object.keys(n).join(", "))},function(e,t){return u(t in n),e.styles=e.styles.concat(n[t]),e}]}()).concat([[String]]))("css",function(e,t){return t.trim().endsWith(";")||(t+=";"),i.create("css",[t])},function(t,n){return t.attr.push({style:function(){return(e(this).attr("style")||"")+n}}),t},[String])}),define("internaltypes/enchantment",["jquery","utils","internaltypes/changedescriptor"],function(e,t,n){var r={create:function(n){return t.assertOnlyHas(n,["scope","attr","data","changer"]),Object.assign(Object.create(this),{enchantments:e()},n)},enchantScope:function(){var t=this,r=this.attr,o=this.data,i=this.changer,a=this.scope;a instanceof e&&(a=Array.prototype.map.call(a,function(t){return e(t)})),this.enchantments=e(),a.forEach(function(e){var a=e.wrapAll("<tw-enchantment>").parent();if(r&&a.attr(r),o&&a.data(o),i){var s=n.create({target:a});i.run(s),s.update()}e.is("tw-story")&&a.css({width:"100%",height:"100%"}),t.enchantments=t.enchantments.add(a)})},disenchant:function(){this.enchantments.each(function(){e(this).contents().unwrap()})}};return Object.freeze(r)}),define("macrolib/enchantments",["jquery","utils","macros","datatypes/hookset","datatypes/changercommand","internaltypes/enchantment","internaltypes/twineerror"],function(e,t,n,r,o,i,a){function s(n,s){return t.assert(n),e(function(){t.storyElement.on(n.event+".enchantment","."+n.classList.replace(/ /g,"."),function(){var t=e(this),n=t.data("enchantmentEvent");n&&n(t)})}),[function(e,t){return t.selector&&(t=t.selector),t?o.create(s,[t]):a.create("datatype","The string given to this ("+s+":) macro was empty.")},function(e,t){e.enabled=!1,n.rerender&&(e.target=t,e.append=n.rerender);var r=i.create({attr:Object.assign({class:n.classList},n.classList.includes("link")?{tabIndex:"0"}:{}),data:{enchantmentEvent:function(){if(n.once){var t=e.section.enchantments.indexOf(r);e.section.enchantments.splice(t,1),r.disenchant()}e.section.renderInto(e.source,null,Object.assign({},e,{enabled:!0}))}},scope:e.section.selectHook(t)});return e.section.enchantments.push(r),r.enchantScope(),e},u(r,String)]}var u=n.TypeSignature.either,c=["replace","append","prepend"];c.forEach(function(t){n.addChanger(t,function(e,n){return n?o.create(t,[n]):a.create("datatype","The string given to this ("+t+":) macro was empty.")},function(n,r){var o=e(n.target.context).parents().filter("tw-collapsed").length>0;return o||(n.attr=[].concat(_toConsumableArray(n.attr),[{collapsing:!1}])),n.target=r,n.append=t,n},u(r,String))});var l=[{name:"click",enchantDesc:{event:"click",once:!0,rerender:"",classList:"link enchantment-link"}},{name:"mouseover",enchantDesc:{event:"mouseenter",once:!0,rerender:"",classList:"enchantment-mouseover"}},{name:"mouseout",enchantDesc:{event:"mouseleave",once:!0,rerender:"",classList:"enchantment-mouseout"}}];l.forEach(function(e){return n.addChanger.apply(n,[e.name].concat(_toConsumableArray(s(e.enchantDesc,e.name))))}),c.forEach(function(e){l.forEach(function(t){var r=Object.assign({},t.enchantDesc,{rerender:e}),o=t.name+"-"+e;n.addChanger.apply(n,[o].concat(_toConsumableArray(s(r,o))))})})}),define("macrolib/links",["jquery","macros","utils","utils/selectors","state","passages","engine","datatypes/changercommand"],function(e,t,n,r,o,i,a,s){var u=t.TypeSignature.optional;e(function(){return e(n.storyElement).on("click.passage-link",r.internalLink,function(){var t=e(this),n=t.parent().data("clickEvent");if(n)return void n(t);var r=t.attr("passage-name");r&&a.goToPassage(r,!1)})}),[["link","link-replace"],["link-reveal"],["link-repeat"]].forEach(function(e){return t.addChanger(e,function(t,n){return s.create(e[0],[n])},function(t,n){var r=t.source;t.source="<tw-link tabindex=0>"+n+"</tw-link>",t.append="link"===e[0]?"replace":"append",t.data={clickEvent:function(n){t.source=r,t.section.renderInto(r+"",null,t),"link-reveal"===e[0]&&n.contents().unwrap()}}},[String])}),t.add(["link-goto"],function(t,r,a){return{TwineScript_TypeName:"a (link-goto: "+n.toJSLiteral(r)+", "+n.toJSLiteral(a)+") command",TwineScript_ObjectName:"a (link-goto:) command",TwineScript_Print:function(){var s=t.evaluateTwineMarkup(n.unescape(a||r));if(s instanceof e)return s;if(!i.has(s))return'<tw-broken-link passage-name="'+n.escape(s)+'">'+(r||a)+"</tw-broken-link>";var u=o.passageNameVisited(s);return"<tw-link tabindex=0 "+(u>0?'class="visited" ':"")+'passage-name="'+n.escape(s)+'">'+(r||a)+"</tw-link>"}}},[String,u(String)])}),define("macrolib",["utils","macrolib/values","macrolib/commands","macrolib/datastructures","macrolib/stylechangers","macrolib/enchantments","macrolib/links"],function(e){var t=e.log;t("Loaded the built-in macros.")}),define("repl",["utils","markup","twinescript/compiler","twinescript/environ"],function(e,t,n,r){window.REPL=function(e){var o=n(t.lex("(print:"+e+")"));return console.log(o),r({}).eval(o)},window.LEX=function(e){var n=t.lex(e);return 1===n.length?n[0]:n}}),require.config({paths:{jquery:"../node_modules/jquery/dist/jquery",almond:"../node_modules/almond/almond","es6-shim":"../node_modules/es6-shim/es6-shim",requestAnimationFrame:"../node_modules/requestanimationframe/app/requestAnimationFrame",jqueryplugins:"utils/jqueryplugins",markup:"./markup/markup",lexer:"./markup/lexer",patterns:"./markup/patterns"},deps:["jquery","es6-shim","jqueryplugins"]}),require(["jquery","renderer","state","engine","passages","utils/selectors","macrolib","repl"],function($,Renderer,State,Engine,Passages,Selectors){function _eval(text){return eval(text+"")}function testPlayCleanup(){["_","Backbone","Store","Mn","Marionette","saveAs","FastClick","JSZip","SVG","requestAnimFrame","UUID","XDate","CodeMirror","ui","nwui","AppPref","Passage","StoryFormat","Story","AppPrefCollection","PassageCollection","StoryCollection","StoryFormatCollection","WelcomeView","StoryItemView","StoryListView","PassageItemView","StoryEditView","TwineRouter","TransRegion","TwineApp","app","storyFormat"].forEach(function(e){try{delete window[e]}catch(t){window[e]=void 0}})}var _installHandlers=function(){var e=$(document.documentElement),t="<tw-debugger><button class='show-invisibles'>&#9903; Debug View</button></tw-debugger>";e.on("keydown",function(e){13===e.which&&"0"===e.target.getAttribute("tabindex")&&$(e.target).trigger("click")}),Engine.options.debug&&($(document.body).append(t),$(".show-invisibles").click(function(){e.toggleClass("debug-mode").is(".debug-mode")})),_installHandlers=null};!function(e){window.onerror=function(t,n,r,o,i){var a=i&&i.stack&&"\n"+i.stack.replace(/\([^\)]+\)/g,"")+"\n"||"("+t+")\n";alert("Sorry to interrupt, but this page's code has got itself in a mess. "+a+"(This is probably due to a bug in the Twine game engine.)"),window.onerror=e,"function"==typeof e&&e.apply(void 0,arguments)}}(window.onerror),$(function(){var e=$(Selectors.storyData);if(0!==e.length){"TwineApp"in window&&testPlayCleanup();var t=e.attr("options");t&&t.split(/\s/).forEach(function(e){Renderer.options[e]=Engine.options[e]=!0});var n=e.attr("startnode");return Renderer.options.ifid=Engine.options.ifid=e.attr("ifid"),n||(n=[].reduce.call($(Selectors.passageData),function(e,t){var n=t.getAttribute("pid");return e>n?n:e},1/0)),n=$(Selectors.passageData+"[pid="+n+"]").attr("name"),_installHandlers(),$(Selectors.script).each(function(e){try{_eval($(this).html())}catch(t){alert("There is a problem with this story's script (#"+(e+1)+"):\n\n"+t.message)}}),$(Selectors.stylesheet).each(function(e){$(document.head).append('<style data-title="Story stylesheet '+(e+1)+'">'+$(this).html())}),window.location.hash&&!window.location.hash.includes("stories")&&State.load(window.location.hash)?void Engine.showPassage(State.passage):void Engine.goToPassage(n)}})}),define("harlowe",function(){}),require(["harlowe"])}();</script>


</body>
</html>
